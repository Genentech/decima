<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html"><link rel="search" title="Search" href="../search.html"><link rel="next" title="Detecting and Clustering Seqlets with Modisco" href="4-modisco.html"><link rel="prev" title="Variant Effect Prediction with Decima" href="2-variant-effect-prediction.html">

    <!-- Generated with Sphinx 8.2.3 and Furo 2025.09.25 -->
        <title>Fine-tuning Borzoi to create a Decima model - decima unknown documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=580074bf" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=8dab3a3b" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle site navigation sidebar">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc" aria-label="Toggle table of contents sidebar">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <span class="icon"><svg><use href="#svg-menu"></use></svg></span>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">decima unknown documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <span class="sidebar-brand-text">decima unknown documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../readme.html">Overview</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api/modules.html">Module Reference</a><input aria-label="Toggle navigation of Module Reference" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/decima.html">decima package</a><input aria-label="Toggle navigation of decima package" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/decima.cli.html">decima.cli package</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/decima.core.html">decima.core package</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/decima.data.html">decima.data package</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/decima.hub.html">decima.hub package</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/decima.interpret.html">decima.interpret package</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/decima.model.html">decima.model package</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/decima.plot.html">decima.plot package</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/decima.tools.html">decima.tools package</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/decima.train.html">decima.train package</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/decima.utils.html">decima.utils package</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/decima.vep.html">decima.vep package</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="1-attribution-motif-discovery.html">Tutorial: Attribution Motif Discovery</a></li>
<li class="toctree-l1"><a class="reference internal" href="2-variant-effect-prediction.html">Tutorial: Variant Effect Prediction</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Tutorial: Finetuning</a></li>
<li class="toctree-l1"><a class="reference internal" href="4-modisco.html">Tutorial: Modisco</a></li>
<li class="toctree-l1"><a class="reference internal" href="5-gene-expression-prediction.html">Tutorial: Gene Expression Prediction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributions &amp; Help</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../authors.html">Authors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/tutorials/3-finetune.ipynb.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section class="tex2jax_ignore mathjax_ignore" id="fine-tuning-borzoi-to-create-a-decima-model">
<h1>Fine-tuning Borzoi to create a Decima model<a class="headerlink" href="#fine-tuning-borzoi-to-create-a-decima-model" title="Link to this heading">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">glob</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">anndata</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scanpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sc</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">bioframe</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">bf</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">line</span> <span class="mi">2</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="kn">import</span><span class="w"> </span><span class="nn">glob</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="kn">import</span><span class="w"> </span><span class="nn">anndata</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="kn">import</span><span class="w"> </span><span class="nn">scanpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sc</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;anndata&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">inputdir</span> <span class="o">=</span> <span class="s2">&quot;./data&quot;</span>
<span class="n">outdir</span> <span class="o">=</span> <span class="s2">&quot;./example&quot;</span>
<span class="n">ad_file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">inputdir</span><span class="p">,</span> <span class="s2">&quot;data.h5ad&quot;</span><span class="p">)</span>
<span class="n">h5_file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">outdir</span><span class="p">,</span> <span class="s2">&quot;data.h5&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="load-input-anndata-file">
<h2>1. Load input anndata file<a class="headerlink" href="#load-input-anndata-file" title="Link to this heading">¶</a></h2>
<p>The input anndata file needs to be in the format (pseudobulks x genes).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ad</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">ad_file_path</span><span class="p">)</span>
<span class="n">ad</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>AnnData object with n_obs × n_vars = 50 × 931
    obs: &#39;cell_type&#39;, &#39;tissue&#39;, &#39;disease&#39;, &#39;study&#39;
    var: &#39;chrom&#39;, &#39;start&#39;, &#39;end&#39;, &#39;strand&#39;, &#39;gene_start&#39;, &#39;gene_end&#39;, &#39;gene_length&#39;, &#39;gene_mask_start&#39;, &#39;gene_mask_end&#39;, &#39;dataset&#39;
    uns: &#39;log1p&#39;
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">.obs</span></code> should be a dataframe with a unique index per pseudobulk. You can also include other columns with metadata about the pseudobulks, e.g. cell type, tissue, disease, study, number of cells, total counts.</p>
<p>Note that the original Decima model does NOT separate pseudobulks by sample, i.e. different samples from the same cell type, tissue, disease and study were merged. We also recommend filtering out pseudobulks with few cells or low read count.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ad</span><span class="o">.</span><span class="n">obs</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cell_type</th>
      <th>tissue</th>
      <th>disease</th>
      <th>study</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>pseudobulk_0</th>
      <td>ct_0</td>
      <td>t_0</td>
      <td>d_0</td>
      <td>st_0</td>
    </tr>
    <tr>
      <th>pseudobulk_1</th>
      <td>ct_0</td>
      <td>t_0</td>
      <td>d_1</td>
      <td>st_0</td>
    </tr>
    <tr>
      <th>pseudobulk_2</th>
      <td>ct_0</td>
      <td>t_0</td>
      <td>d_2</td>
      <td>st_1</td>
    </tr>
    <tr>
      <th>pseudobulk_3</th>
      <td>ct_0</td>
      <td>t_0</td>
      <td>d_0</td>
      <td>st_1</td>
    </tr>
    <tr>
      <th>pseudobulk_4</th>
      <td>ct_0</td>
      <td>t_0</td>
      <td>d_1</td>
      <td>st_2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">.var</span></code> should be a dataframe with a unique index per gene. The index can be the gene name or Ensembl ID, as long as it is unique. Other essential columns are: chrom, start, end and strand (the gene coordinates).</p>
<p>You can also include other columns with metadata about the genes, e.g. Ensembl ID, type of gene.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ad</span><span class="o">.</span><span class="n">var</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>chrom</th>
      <th>start</th>
      <th>end</th>
      <th>strand</th>
      <th>gene_start</th>
      <th>gene_end</th>
      <th>gene_length</th>
      <th>gene_mask_start</th>
      <th>gene_mask_end</th>
      <th>dataset</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>gene_0</th>
      <td>chr1</td>
      <td>26846360</td>
      <td>27370648</td>
      <td>+</td>
      <td>27010200</td>
      <td>27534488</td>
      <td>524288</td>
      <td>163840</td>
      <td>524288</td>
      <td>train</td>
    </tr>
    <tr>
      <th>gene_1</th>
      <td>chr19</td>
      <td>40619897</td>
      <td>41144185</td>
      <td>-</td>
      <td>40456057</td>
      <td>40980345</td>
      <td>524288</td>
      <td>163840</td>
      <td>524288</td>
      <td>train</td>
    </tr>
    <tr>
      <th>gene_2</th>
      <td>chr1</td>
      <td>79282506</td>
      <td>79806794</td>
      <td>-</td>
      <td>79118666</td>
      <td>79642954</td>
      <td>524288</td>
      <td>163840</td>
      <td>524288</td>
      <td>train</td>
    </tr>
    <tr>
      <th>gene_3</th>
      <td>chr8</td>
      <td>144568573</td>
      <td>145092861</td>
      <td>-</td>
      <td>144404733</td>
      <td>144929021</td>
      <td>524288</td>
      <td>163840</td>
      <td>524288</td>
      <td>val</td>
    </tr>
    <tr>
      <th>gene_4</th>
      <td>chr16</td>
      <td>3249848</td>
      <td>3774136</td>
      <td>-</td>
      <td>3086008</td>
      <td>3610296</td>
      <td>524288</td>
      <td>163840</td>
      <td>524288</td>
      <td>train</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">.X</span></code> should contain the total counts per gene and pseudobulk. These should be non-negative integers.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ad</span><span class="o">.</span><span class="n">X</span><span class="p">[:</span><span class="mi">5</span><span class="p">,</span> <span class="p">:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0.       , 7.2824097, 7.2824097, 0.       , 7.2824097],
       [7.3014727, 7.3014727, 0.       , 7.3014727, 7.3014727],
       [7.2867765, 7.2867765, 7.2867765, 7.2867765, 7.2867765],
       [7.283863 , 0.       , 7.283863 , 7.283863 , 7.283863 ],
       [7.3239307, 7.3239307, 0.       , 0.       , 7.3239307]],
      dtype=float32)
</pre></div>
</div>
</div>
</div>
</section>
<section id="normalize-and-log-transform-data">
<h2>2. Normalize and log transform data<a class="headerlink" href="#normalize-and-log-transform-data" title="Link to this heading">¶</a></h2>
<p>We first transform the counts to log(CPM+1) values. CPM = Counts Per Million.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sc</span><span class="o">.</span><span class="n">pp</span><span class="o">.</span><span class="n">normalize_total</span><span class="p">(</span><span class="n">ad</span><span class="p">,</span> <span class="n">target_sum</span><span class="o">=</span><span class="mf">1e6</span><span class="p">)</span>
<span class="n">sc</span><span class="o">.</span><span class="n">pp</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="n">ad</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>WARNING: adata.X seems to be already log-transformed.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ad</span><span class="o">.</span><span class="n">X</span><span class="p">[:</span><span class="mi">5</span><span class="p">,</span> <span class="p">:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0.       , 7.2867765, 7.2867765, 0.       , 7.2867765],
       [7.305924 , 7.305924 , 0.       , 7.305924 , 7.305924 ],
       [7.2911625, 7.2911625, 7.2911625, 7.2911625, 7.2911625],
       [7.2896986, 0.       , 7.2896986, 7.2896986, 7.2896986],
       [7.3284836, 7.3284836, 0.       , 0.       , 7.3284836]],
      dtype=float32)
</pre></div>
</div>
</div>
</div>
</section>
<section id="create-intervals-surrounding-genes">
<h2>3. Create intervals surrounding genes<a class="headerlink" href="#create-intervals-surrounding-genes" title="Link to this heading">¶</a></h2>
<p>Decima is trained on 524,288 bp sequence surrounding the genes. Therefore, we have to take the given gene coordinates and extend them to create intervals of this length.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">decima.data.preprocess</span><span class="w"> </span><span class="kn">import</span> <span class="n">var_to_intervals</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/celikm5/miniforge3/envs/decima2/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The &#39;repr&#39; attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. &#39;repr&#39; is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
  warnings.warn(
/home/celikm5/miniforge3/envs/decima2/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The &#39;frozen&#39; attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. &#39;frozen&#39; is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
  warnings.warn(
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ad</span><span class="o">.</span><span class="n">var</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>chrom</th>
      <th>start</th>
      <th>end</th>
      <th>strand</th>
      <th>gene_start</th>
      <th>gene_end</th>
      <th>gene_length</th>
      <th>gene_mask_start</th>
      <th>gene_mask_end</th>
      <th>dataset</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>gene_0</th>
      <td>chr1</td>
      <td>26846360</td>
      <td>27370648</td>
      <td>+</td>
      <td>27010200</td>
      <td>27534488</td>
      <td>524288</td>
      <td>163840</td>
      <td>524288</td>
      <td>train</td>
    </tr>
    <tr>
      <th>gene_1</th>
      <td>chr19</td>
      <td>40619897</td>
      <td>41144185</td>
      <td>-</td>
      <td>40456057</td>
      <td>40980345</td>
      <td>524288</td>
      <td>163840</td>
      <td>524288</td>
      <td>train</td>
    </tr>
    <tr>
      <th>gene_2</th>
      <td>chr1</td>
      <td>79282506</td>
      <td>79806794</td>
      <td>-</td>
      <td>79118666</td>
      <td>79642954</td>
      <td>524288</td>
      <td>163840</td>
      <td>524288</td>
      <td>train</td>
    </tr>
    <tr>
      <th>gene_3</th>
      <td>chr8</td>
      <td>144568573</td>
      <td>145092861</td>
      <td>-</td>
      <td>144404733</td>
      <td>144929021</td>
      <td>524288</td>
      <td>163840</td>
      <td>524288</td>
      <td>val</td>
    </tr>
    <tr>
      <th>gene_4</th>
      <td>chr16</td>
      <td>3249848</td>
      <td>3774136</td>
      <td>-</td>
      <td>3086008</td>
      <td>3610296</td>
      <td>524288</td>
      <td>163840</td>
      <td>524288</td>
      <td>train</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>First, we copy the start and end columns to <code class="docutils literal notranslate"><span class="pre">gene_start</span></code> and <code class="docutils literal notranslate"><span class="pre">gene_end</span></code>. We also create a new column <code class="docutils literal notranslate"><span class="pre">gene_length</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ad</span><span class="o">.</span><span class="n">var</span><span class="p">[</span><span class="s2">&quot;gene_start&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ad</span><span class="o">.</span><span class="n">var</span><span class="o">.</span><span class="n">start</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">ad</span><span class="o">.</span><span class="n">var</span><span class="p">[</span><span class="s2">&quot;gene_end&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ad</span><span class="o">.</span><span class="n">var</span><span class="o">.</span><span class="n">end</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">ad</span><span class="o">.</span><span class="n">var</span><span class="p">[</span><span class="s2">&quot;gene_length&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ad</span><span class="o">.</span><span class="n">var</span><span class="p">[</span><span class="s2">&quot;gene_end&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">ad</span><span class="o">.</span><span class="n">var</span><span class="p">[</span><span class="s2">&quot;gene_start&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ad</span><span class="o">.</span><span class="n">var</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>chrom</th>
      <th>start</th>
      <th>end</th>
      <th>strand</th>
      <th>gene_start</th>
      <th>gene_end</th>
      <th>gene_length</th>
      <th>gene_mask_start</th>
      <th>gene_mask_end</th>
      <th>dataset</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>gene_0</th>
      <td>chr1</td>
      <td>26846360</td>
      <td>27370648</td>
      <td>+</td>
      <td>26846360</td>
      <td>27370648</td>
      <td>524288</td>
      <td>163840</td>
      <td>524288</td>
      <td>train</td>
    </tr>
    <tr>
      <th>gene_1</th>
      <td>chr19</td>
      <td>40619897</td>
      <td>41144185</td>
      <td>-</td>
      <td>40619897</td>
      <td>41144185</td>
      <td>524288</td>
      <td>163840</td>
      <td>524288</td>
      <td>train</td>
    </tr>
    <tr>
      <th>gene_2</th>
      <td>chr1</td>
      <td>79282506</td>
      <td>79806794</td>
      <td>-</td>
      <td>79282506</td>
      <td>79806794</td>
      <td>524288</td>
      <td>163840</td>
      <td>524288</td>
      <td>train</td>
    </tr>
    <tr>
      <th>gene_3</th>
      <td>chr8</td>
      <td>144568573</td>
      <td>145092861</td>
      <td>-</td>
      <td>144568573</td>
      <td>145092861</td>
      <td>524288</td>
      <td>163840</td>
      <td>524288</td>
      <td>val</td>
    </tr>
    <tr>
      <th>gene_4</th>
      <td>chr16</td>
      <td>3249848</td>
      <td>3774136</td>
      <td>-</td>
      <td>3249848</td>
      <td>3774136</td>
      <td>524288</td>
      <td>163840</td>
      <td>524288</td>
      <td>train</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Now, we extend the gene coordinates to create enclosing intervals:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ad</span> <span class="o">=</span> <span class="n">var_to_intervals</span><span class="p">(</span><span class="n">ad</span><span class="p">,</span> <span class="n">chr_end_pad</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">genome</span><span class="o">=</span><span class="s2">&quot;hg38&quot;</span><span class="p">)</span>
<span class="c1"># Replace genome name if necessary</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The interval size is 524288 bases. Of these, 163840 will be upstream of the gene start and 360448 will be downstream of the gene start.
3 intervals extended beyond the chromosome start and have been shifted
2 intervals extended beyond the chromosome end and have been shifted
5 intervals did not extend far enough upstream of the TSS and have been dropped
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ad</span><span class="o">.</span><span class="n">var</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>chrom</th>
      <th>start</th>
      <th>end</th>
      <th>strand</th>
      <th>gene_start</th>
      <th>gene_end</th>
      <th>gene_length</th>
      <th>gene_mask_start</th>
      <th>gene_mask_end</th>
      <th>dataset</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>gene_0</th>
      <td>chr1</td>
      <td>26682520</td>
      <td>27206808</td>
      <td>+</td>
      <td>26846360</td>
      <td>27370648</td>
      <td>524288</td>
      <td>163840</td>
      <td>524288</td>
      <td>train</td>
    </tr>
    <tr>
      <th>gene_1</th>
      <td>chr19</td>
      <td>40783737</td>
      <td>41308025</td>
      <td>-</td>
      <td>40619897</td>
      <td>41144185</td>
      <td>524288</td>
      <td>163840</td>
      <td>524288</td>
      <td>train</td>
    </tr>
    <tr>
      <th>gene_2</th>
      <td>chr1</td>
      <td>79446346</td>
      <td>79970634</td>
      <td>-</td>
      <td>79282506</td>
      <td>79806794</td>
      <td>524288</td>
      <td>163840</td>
      <td>524288</td>
      <td>train</td>
    </tr>
    <tr>
      <th>gene_4</th>
      <td>chr16</td>
      <td>3413688</td>
      <td>3937976</td>
      <td>-</td>
      <td>3249848</td>
      <td>3774136</td>
      <td>524288</td>
      <td>163840</td>
      <td>524288</td>
      <td>train</td>
    </tr>
    <tr>
      <th>gene_5</th>
      <td>chr10</td>
      <td>22987161</td>
      <td>23511449</td>
      <td>+</td>
      <td>23151001</td>
      <td>23675289</td>
      <td>524288</td>
      <td>163840</td>
      <td>524288</td>
      <td>train</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>You see that the columns <code class="docutils literal notranslate"><span class="pre">start</span></code> and <code class="docutils literal notranslate"><span class="pre">end</span></code> now contain the start and end coordinates for the 524,288 bp intervals.</p>
</section>
<section id="split-genes-into-training-validation-and-test-sets">
<h2>3. Split genes into training, validation and test sets<a class="headerlink" href="#split-genes-into-training-validation-and-test-sets" title="Link to this heading">¶</a></h2>
<p>We load the coordinates of the genomic regions used to train Borzoi:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">splits_file</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/calico/borzoi/main/data/sequences_human.bed.gz&quot;</span>
<span class="c1"># replace human with mouse for mm10 splits</span>
<span class="n">splits</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_table</span><span class="p">(</span><span class="n">splits_file</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;chrom&quot;</span><span class="p">,</span> <span class="s2">&quot;start&quot;</span><span class="p">,</span> <span class="s2">&quot;end&quot;</span><span class="p">,</span> <span class="s2">&quot;fold&quot;</span><span class="p">])</span>
<span class="n">splits</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>chrom</th>
      <th>start</th>
      <th>end</th>
      <th>fold</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>chr4</td>
      <td>82524421</td>
      <td>82721029</td>
      <td>fold0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>chr13</td>
      <td>18604798</td>
      <td>18801406</td>
      <td>fold0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>chr2</td>
      <td>189923408</td>
      <td>190120016</td>
      <td>fold0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>chr10</td>
      <td>59875743</td>
      <td>60072351</td>
      <td>fold0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>chr1</td>
      <td>117109467</td>
      <td>117306075</td>
      <td>fold0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Now, we overlap our gene intervals with these regions:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">overlaps</span> <span class="o">=</span> <span class="n">bf</span><span class="o">.</span><span class="n">overlap</span><span class="p">(</span><span class="n">ad</span><span class="o">.</span><span class="n">var</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">names</span><span class="o">=</span><span class="s2">&quot;gene&quot;</span><span class="p">),</span> <span class="n">splits</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
<span class="n">overlaps</span> <span class="o">=</span> <span class="n">overlaps</span><span class="p">[[</span><span class="s2">&quot;gene&quot;</span><span class="p">,</span> <span class="s2">&quot;fold_&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
<span class="n">overlaps</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gene</th>
      <th>fold_</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>gene_0</td>
      <td>fold5</td>
    </tr>
    <tr>
      <th>15</th>
      <td>gene_1</td>
      <td>fold0</td>
    </tr>
    <tr>
      <th>30</th>
      <td>gene_2</td>
      <td>fold0</td>
    </tr>
    <tr>
      <th>44</th>
      <td>gene_4</td>
      <td>fold0</td>
    </tr>
    <tr>
      <th>45</th>
      <td>gene_4</td>
      <td>fold2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Based on the overlap, we divide our gene intervals into training, validation and test sets.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_genes</span> <span class="o">=</span> <span class="n">overlaps</span><span class="o">.</span><span class="n">gene</span><span class="p">[</span><span class="n">overlaps</span><span class="o">.</span><span class="n">fold_</span> <span class="o">==</span> <span class="s2">&quot;fold3&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">val_genes</span> <span class="o">=</span> <span class="n">overlaps</span><span class="o">.</span><span class="n">gene</span><span class="p">[</span><span class="n">overlaps</span><span class="o">.</span><span class="n">fold_</span> <span class="o">==</span> <span class="s2">&quot;fold4&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">train_genes</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">overlaps</span><span class="o">.</span><span class="n">gene</span><span class="p">)</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">test_genes</span><span class="p">)</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">val_genes</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>And add this information back to <code class="docutils literal notranslate"><span class="pre">ad.var</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ad</span><span class="o">.</span><span class="n">var</span><span class="p">[</span><span class="s2">&quot;dataset&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;test&quot;</span>
<span class="n">ad</span><span class="o">.</span><span class="n">var</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ad</span><span class="o">.</span><span class="n">var</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">val_genes</span><span class="p">),</span> <span class="s2">&quot;dataset&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;val&quot;</span>
<span class="n">ad</span><span class="o">.</span><span class="n">var</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ad</span><span class="o">.</span><span class="n">var</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">train_genes</span><span class="p">),</span> <span class="s2">&quot;dataset&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;train&quot;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_4100753/3109841685.py:1: ImplicitModificationWarning: Trying to modify attribute `.var` of view, initializing view as actual.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ad</span><span class="o">.</span><span class="n">var</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>chrom</th>
      <th>start</th>
      <th>end</th>
      <th>strand</th>
      <th>gene_start</th>
      <th>gene_end</th>
      <th>gene_length</th>
      <th>gene_mask_start</th>
      <th>gene_mask_end</th>
      <th>dataset</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>gene_0</th>
      <td>chr1</td>
      <td>26682520</td>
      <td>27206808</td>
      <td>+</td>
      <td>26846360</td>
      <td>27370648</td>
      <td>524288</td>
      <td>163840</td>
      <td>524288</td>
      <td>train</td>
    </tr>
    <tr>
      <th>gene_1</th>
      <td>chr19</td>
      <td>40783737</td>
      <td>41308025</td>
      <td>-</td>
      <td>40619897</td>
      <td>41144185</td>
      <td>524288</td>
      <td>163840</td>
      <td>524288</td>
      <td>train</td>
    </tr>
    <tr>
      <th>gene_2</th>
      <td>chr1</td>
      <td>79446346</td>
      <td>79970634</td>
      <td>-</td>
      <td>79282506</td>
      <td>79806794</td>
      <td>524288</td>
      <td>163840</td>
      <td>524288</td>
      <td>train</td>
    </tr>
    <tr>
      <th>gene_4</th>
      <td>chr16</td>
      <td>3413688</td>
      <td>3937976</td>
      <td>-</td>
      <td>3249848</td>
      <td>3774136</td>
      <td>524288</td>
      <td>163840</td>
      <td>524288</td>
      <td>train</td>
    </tr>
    <tr>
      <th>gene_5</th>
      <td>chr10</td>
      <td>22987161</td>
      <td>23511449</td>
      <td>+</td>
      <td>23151001</td>
      <td>23675289</td>
      <td>524288</td>
      <td>163840</td>
      <td>524288</td>
      <td>train</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ad</span><span class="o">.</span><span class="n">var</span><span class="o">.</span><span class="n">dataset</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dataset
train    769
test      86
val       71
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>We have now divided the 1000 genes in our dataset into separate sets to be used for training, validation and testing.</p>
</section>
<section id="save-processed-anndata">
<h2>4. Save processed anndata<a class="headerlink" href="#save-processed-anndata" title="Link to this heading">¶</a></h2>
<p>We will save the processed anndata file containing these intervals and data splits.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ad</span><span class="o">.</span><span class="n">write_h5ad</span><span class="p">(</span><span class="n">ad_file_path</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="create-an-hdf5-file">
<h2>5. Create an hdf5 file<a class="headerlink" href="#create-an-hdf5-file" title="Link to this heading">¶</a></h2>
<p>To train Decima, we need to extract the genomic sequences for all the intervals and convert them to one-hot encoded format. We save these one-hot encoded inputs to an hdf5 file.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">decima.data.write_hdf5</span><span class="w"> </span><span class="kn">import</span> <span class="n">write_hdf5</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">write_hdf5</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">h5_file_path</span><span class="p">,</span> <span class="n">ad</span><span class="o">=</span><span class="n">ad</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span> <span class="n">genome</span><span class="o">=</span><span class="s2">&quot;hg38&quot;</span><span class="p">)</span>
<span class="c1"># Change genome name if necessary</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Writing metadata
Writing task indices
Writing genes array of shape: (926, 2)
Writing labels array of shape: (926, 50, 1)
Making gene masks
Writing mask array of shape: (926, 534288)
Encoding sequences
Writing sequence array of shape: (926, 534288)
Done!
</pre></div>
</div>
</div>
</div>
</section>
<section id="set-training-parameters">
<h2>6. Set training parameters<a class="headerlink" href="#set-training-parameters" title="Link to this heading">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Learning rate default=0.001</span>
<span class="n">lr</span> <span class="o">=</span> <span class="mf">5e-5</span>
<span class="c1"># Total weight parameter for the loss function</span>
<span class="n">total_weight</span> <span class="o">=</span> <span class="mf">1e-4</span>
<span class="c1"># Gradient accumulation steps</span>
<span class="n">grad</span> <span class="o">=</span> <span class="mi">5</span>
<span class="c1"># batch-size. default=4</span>
<span class="n">bs</span> <span class="o">=</span> <span class="mi">4</span>
<span class="c1"># max-seq-shift. default=5000</span>
<span class="n">shift</span> <span class="o">=</span> <span class="mi">5000</span>
<span class="c1"># Number of epochs. Default 1</span>
<span class="n">epochs</span> <span class="o">=</span> <span class="mi">15</span>

<span class="c1"># logger</span>
<span class="n">logger</span> <span class="o">=</span> <span class="s2">&quot;wandb&quot;</span>  <span class="c1"># Change to csv to save logs locally</span>

<span class="c1"># Number of workers default=16</span>
<span class="n">workers</span> <span class="o">=</span> <span class="mi">16</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="generate-training-commands">
<h2>7. Generate training commands<a class="headerlink" href="#generate-training-commands" title="Link to this heading">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cmds</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;finetune_test_</span><span class="si">{</span><span class="n">model</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">device</span> <span class="o">=</span> <span class="n">model</span>

    <span class="n">cmd</span> <span class="o">=</span> <span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;decima finetune --name </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> &quot;</span>
        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;--model </span><span class="si">{</span><span class="n">model</span><span class="si">}</span><span class="s2"> --device </span><span class="si">{</span><span class="n">device</span><span class="si">}</span><span class="s2"> &quot;</span>
        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;--matrix-file </span><span class="si">{</span><span class="n">ad_file_path</span><span class="si">}</span><span class="s2"> --h5-file </span><span class="si">{</span><span class="n">h5_file_path</span><span class="si">}</span><span class="s2"> &quot;</span>
        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;--outdir </span><span class="si">{</span><span class="n">outdir</span><span class="si">}</span><span class="s2"> --learning-rate </span><span class="si">{</span><span class="n">lr</span><span class="si">}</span><span class="s2"> &quot;</span>
        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;--loss-total-weight </span><span class="si">{</span><span class="n">total_weight</span><span class="si">}</span><span class="s2"> --gradient-accumulation </span><span class="si">{</span><span class="n">grad</span><span class="si">}</span><span class="s2"> &quot;</span>
        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;--batch-size </span><span class="si">{</span><span class="n">bs</span><span class="si">}</span><span class="s2"> --max-seq-shift </span><span class="si">{</span><span class="n">shift</span><span class="si">}</span><span class="s2"> &quot;</span>
        <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;--epochs </span><span class="si">{</span><span class="n">epochs</span><span class="si">}</span><span class="s2"> --logger </span><span class="si">{</span><span class="n">logger</span><span class="si">}</span><span class="s2"> --num-workers </span><span class="si">{</span><span class="n">workers</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>
    <span class="n">cmds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">cmd</span> <span class="ow">in</span> <span class="n">cmds</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>decima finetune --name finetune_test_0 --model 0 --device 0 --matrix-file ./data/data.h5ad --h5-file ./example/data.h5 --outdir ./example --learning-rate 5e-05 --loss-total-weight 0.0001 --gradient-accumulation 5 --batch-size 4 --max-seq-shift 5000 --epochs 15 --logger wandb --num-workers 16
decima finetune --name finetune_test_1 --model 1 --device 1 --matrix-file ./data/data.h5ad --h5-file ./example/data.h5 --outdir ./example --learning-rate 5e-05 --loss-total-weight 0.0001 --gradient-accumulation 5 --batch-size 4 --max-seq-shift 5000 --epochs 15 --logger wandb --num-workers 16
decima finetune --name finetune_test_2 --model 2 --device 2 --matrix-file ./data/data.h5ad --h5-file ./example/data.h5 --outdir ./example --learning-rate 5e-05 --loss-total-weight 0.0001 --gradient-accumulation 5 --batch-size 4 --max-seq-shift 5000 --epochs 15 --logger wandb --num-workers 16
decima finetune --name finetune_test_3 --model 3 --device 3 --matrix-file ./data/data.h5ad --h5-file ./example/data.h5 --outdir ./example --learning-rate 5e-05 --loss-total-weight 0.0001 --gradient-accumulation 5 --batch-size 4 --max-seq-shift 5000 --epochs 15 --logger wandb --num-workers 16
</pre></div>
</div>
</div>
</div>
<p>Here, we train the model for 1 epoch for quick progressing in tutorial. Run the training for more epochs in your training.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span><span class="w"> </span><span class="nv">CUDA_VISIBLE_DEVICES</span><span class="o">=</span><span class="m">0</span><span class="w"> </span>decima<span class="w"> </span>finetune<span class="w"> </span><span class="err">\</span>
<span class="o">--</span><span class="n">name</span> <span class="n">finetune_test_0</span> \
<span class="o">--</span><span class="n">model</span> <span class="n">v1_rep0</span> \
<span class="o">--</span><span class="n">device</span> <span class="mi">0</span> \
<span class="o">--</span><span class="n">matrix</span><span class="o">-</span><span class="n">file</span> <span class="p">{</span><span class="n">ad_file_path</span><span class="p">}</span> \
<span class="o">--</span><span class="n">h5</span><span class="o">-</span><span class="n">file</span> <span class="p">{</span><span class="n">h5_file_path</span><span class="p">}</span> \
<span class="o">--</span><span class="n">outdir</span> <span class="p">{</span><span class="n">outdir</span><span class="p">}</span> \
<span class="o">--</span><span class="n">learning</span><span class="o">-</span><span class="n">rate</span> <span class="p">{</span><span class="n">lr</span><span class="p">}</span> \
<span class="o">--</span><span class="n">loss</span><span class="o">-</span><span class="n">total</span><span class="o">-</span><span class="n">weight</span> <span class="p">{</span><span class="n">total_weight</span><span class="p">}</span> \
<span class="o">--</span><span class="n">gradient</span><span class="o">-</span><span class="n">accumulation</span> <span class="p">{</span><span class="n">grad</span><span class="p">}</span> \
<span class="o">--</span><span class="n">batch</span><span class="o">-</span><span class="n">size</span> <span class="mi">1</span> \
<span class="o">--</span><span class="nb">max</span><span class="o">-</span><span class="n">seq</span><span class="o">-</span><span class="n">shift</span> <span class="p">{</span><span class="n">shift</span><span class="p">}</span> \
<span class="o">--</span><span class="n">epochs</span> <span class="mi">1</span> \
<span class="o">--</span><span class="n">logger</span> <span class="p">{</span><span class="n">logger</span><span class="p">}</span> \
<span class="o">--</span><span class="n">num</span><span class="o">-</span><span class="n">workers</span> <span class="p">{</span><span class="n">workers</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/celikm5/miniforge3/envs/decima2/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The &#39;repr&#39; attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. &#39;repr&#39; is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
  warnings.warn(
/home/celikm5/miniforge3/envs/decima2/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The &#39;frozen&#39; attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. &#39;frozen&#39; is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
  warnings.warn(
decima - INFO - Data paths: matrix_file=./data/data.h5ad, h5_file=./example/data.h5
decima - INFO - Reading anndata
decima - INFO - Making dataset objects
decima - INFO - train_params: {&#39;batch_size&#39;: 1, &#39;num_workers&#39;: 16, &#39;devices&#39;: 0, &#39;logger&#39;: &#39;wandb&#39;, &#39;save_dir&#39;: &#39;./example&#39;, &#39;max_epochs&#39;: 1, &#39;lr&#39;: 5e-05, &#39;total_weight&#39;: 0.0001, &#39;accumulate_grad_batches&#39;: 5, &#39;loss&#39;: &#39;poisson_multinomial&#39;, &#39;clip&#39;: 0.0, &#39;save_top_k&#39;: 1, &#39;pin_memory&#39;: True}
decima - INFO - model_params: {&#39;n_tasks&#39;: 50, &#39;init_borzoi&#39;: True, &#39;replicate&#39;: &#39;0&#39;}
decima - INFO - Initializing model
decima - INFO - Initializing weights from Borzoi model using wandb for replicate: 0
<span class=" -Color -Color-Bold -Color-Bold-Blue">wandb</span>: Currently logged in as: <span class=" -Color -Color-Yellow">anony-mouse-591272909468377997</span> to <span class=" -Color -Color-Green">https://api.wandb.ai</span>. Use <span class=" -Color -Color-Bold">`wandb login --relogin`</span> to force relogin
<span class=" -Color -Color-Bold -Color-Bold-Blue">wandb</span>: Downloading large artifact &#39;human_state_dict_fold0:latest&#39;, 709.30MB. 1 files...
<span class=" -Color -Color-Bold -Color-Bold-Blue">wandb</span>:   1 of 1 files downloaded.  
Done. 00:00:01.6 (439.0MB/s)
decima - INFO - Connecting to wandb.
<span class=" -Color -Color-Bold -Color-Bold-Blue">wandb</span>: Currently logged in as: <span class=" -Color -Color-Yellow">anony-mouse-591272909468377997</span> to <span class=" -Color -Color-Green">https://genentech.wandb.io</span>. Use <span class=" -Color -Color-Bold">`wandb login --relogin`</span> to force relogin
<span class=" -Color -Color-Bold -Color-Bold-Blue">wandb</span>: <span class=" -Color -Color-C178">⢿</span> Waiting for wandb.init()...
<span class=" -Color -Color-Bold -Color-Bold-Blue">wandb</span>: <span class=" -Color -Color-C178">⣻</span> Waiting for wandb.init()...
<span class=" -Color -Color-Bold -Color-Bold-Blue">wandb</span>: <span class=" -Color -Color-C178">⣽</span> setting up run bj42z19b (0.2s)
<span class=" -Color -Color-Bold -Color-Bold-Blue">wandb</span>: Tracking run with wandb version 0.22.2
<span class=" -Color -Color-Bold -Color-Bold-Blue">wandb</span>: Run data is saved locally in <span class=" -Color -Color-Bold -Color-Bold-Magenta">finetune_test_0/wandb/run-20251028_141723-bj42z19b</span>
<span class=" -Color -Color-Bold -Color-Bold-Blue">wandb</span>: Run <span class=" -Color -Color-Bold">`wandb offline`</span> to turn off syncing.
<span class=" -Color -Color-Bold -Color-Bold-Blue">wandb</span>: Syncing run <span class=" -Color -Color-Yellow">finetune_test_0</span>
<span class=" -Color -Color-Bold -Color-Bold-Blue">wandb</span>: ⭐️ View project at <span class=" -Color -Color-Blue">https://genentech.wandb.io/celik-muhammed_hasan/decima</span>
<span class=" -Color -Color-Bold -Color-Bold-Blue">wandb</span>: 🚀 View run at <span class=" -Color -Color-Blue">https://genentech.wandb.io/celik-muhammed_hasan/decima/runs/bj42z19b</span>
decima - INFO - Training
/home/celikm5/miniforge3/envs/decima2/lib/python3.11/site-packages/torch/__init__.py:1617: UserWarning: Please use the new API settings to control TF32 behavior, such as torch.backends.cudnn.conv.fp32_precision = &#39;tf32&#39; or torch.backends.cuda.matmul.fp32_precision = &#39;ieee&#39;. Old settings, e.g, torch.backends.cuda.matmul.allow_tf32 = True, torch.backends.cudnn.allow_tf32 = True, allowTF32CuDNN() and allowTF32CuBLAS() will be deprecated after Pytorch 2.9. Please see https://pytorch.org/docs/main/notes/cuda.html#tensorfloat-32-tf32-on-ampere-and-later-devices (Triggered internally at /pytorch/aten/src/ATen/Context.cpp:80.)
/home/celikm5/miniforge3/envs/decima2/lib/python3.11/site-packages/lightning_fabric/plugins/environments/slurm.py:204: PossibleUserWarning: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python3.11 /home/celikm5/miniforge3/envs/decima2/bin/decima ...
Using 16bit Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/celikm5/miniforge3/envs/decima2/lib/python3.11/site-packages/torch/utils/data/dataloader.py:627: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 4, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
/home/celikm5/miniforge3/envs/decima2/lib/python3.11/site-packages/pytorch_lightning/loggers/wandb.py:397: UserWarning: There is a wandb run already in progress and newly created instances of `WandbLogger` will reuse this run. If this is not desired, call `wandb.finish()` before instantiating `WandbLogger`.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Validation DataLoader 0:   0%|                           | 0/71 [00:00&lt;?, ?it/s]Multinomial: 17.819683074951172, Poisson: -0.08381132036447525
Validation DataLoader 0:   1%|▎                  | 1/71 [00:05&lt;06:26,  0.18it/s]Multinomial: 17.218976974487305, Poisson: -0.08079911023378372
Validation DataLoader 0:   3%|▌                  | 2/71 [00:05&lt;03:14,  0.35it/s]Multinomial: 23.46407127380371, Poisson: -0.11256104707717896
Validation DataLoader 0:   4%|▊                  | 3/71 [00:05&lt;02:10,  0.52it/s]Multinomial: 18.54928207397461, Poisson: -0.08707661181688309
Validation DataLoader 0:   6%|█                  | 4/71 [00:05&lt;01:38,  0.68it/s]Multinomial: 21.981822967529297, Poisson: -0.10404083877801895
Validation DataLoader 0:   7%|█▎                 | 5/71 [00:05&lt;01:19,  0.83it/s]Multinomial: 17.9744873046875, Poisson: -0.08392785489559174
Validation DataLoader 0:   8%|█▌                 | 6/71 [00:06&lt;01:06,  0.98it/s]Multinomial: 17.713722229003906, Poisson: -0.08389832824468613
Validation DataLoader 0:  10%|█▊                 | 7/71 [00:06&lt;00:56,  1.12it/s]Multinomial: 22.397993087768555, Poisson: -0.10686887055635452
Validation DataLoader 0:  11%|██▏                | 8/71 [00:06&lt;00:49,  1.26it/s]Multinomial: 22.986812591552734, Poisson: -0.10990624874830246
Validation DataLoader 0:  13%|██▍                | 9/71 [00:06&lt;00:44,  1.39it/s]Multinomial: 20.55581283569336, Poisson: -0.09850717335939407
Validation DataLoader 0:  14%|██▌               | 10/71 [00:06&lt;00:40,  1.52it/s]Multinomial: 17.223976135253906, Poisson: -0.08083799481391907
Validation DataLoader 0:  15%|██▊               | 11/71 [00:06&lt;00:36,  1.64it/s]Multinomial: 20.073915481567383, Poisson: -0.09529563039541245
Validation DataLoader 0:  17%|███               | 12/71 [00:06&lt;00:33,  1.76it/s]Multinomial: 21.84113311767578, Poisson: -0.10366760939359665
Validation DataLoader 0:  18%|███▎              | 13/71 [00:06&lt;00:30,  1.88it/s]Multinomial: 24.12664031982422, Poisson: -0.11561668664216995
Validation DataLoader 0:  20%|███▌              | 14/71 [00:07&lt;00:28,  1.99it/s]Multinomial: 20.70318603515625, Poisson: -0.09852513670921326
Validation DataLoader 0:  21%|███▊              | 15/71 [00:07&lt;00:26,  2.10it/s]Multinomial: 21.322338104248047, Poisson: -0.10133405029773712
Validation DataLoader 0:  23%|████              | 16/71 [00:07&lt;00:24,  2.20it/s]Multinomial: 16.580944061279297, Poisson: -0.07838235050439835
Validation DataLoader 0:  24%|████▎             | 17/71 [00:07&lt;00:23,  2.30it/s]Multinomial: 23.06201171875, Poisson: -0.11002476513385773
Validation DataLoader 0:  25%|████▌             | 18/71 [00:07&lt;00:22,  2.40it/s]Multinomial: 19.996549606323242, Poisson: -0.09544631838798523
Validation DataLoader 0:  27%|████▊             | 19/71 [00:07&lt;00:20,  2.49it/s]Multinomial: 24.737245559692383, Poisson: -0.11865541338920593
Validation DataLoader 0:  28%|█████             | 20/71 [00:07&lt;00:19,  2.59it/s]Multinomial: 20.6527042388916, Poisson: -0.09846200793981552
Validation DataLoader 0:  30%|█████▎            | 21/71 [00:07&lt;00:18,  2.67it/s]Multinomial: 24.250282287597656, Poisson: -0.11513131856918335
Validation DataLoader 0:  31%|█████▌            | 22/71 [00:07&lt;00:17,  2.76it/s]Multinomial: 19.451091766357422, Poisson: -0.09270521253347397
Validation DataLoader 0:  32%|█████▊            | 23/71 [00:08&lt;00:16,  2.85it/s]Multinomial: 18.94978141784668, Poisson: -0.0894022136926651
Validation DataLoader 0:  34%|██████            | 24/71 [00:08&lt;00:16,  2.93it/s]Multinomial: 20.109825134277344, Poisson: -0.09544882923364639
Validation DataLoader 0:  35%|██████▎           | 25/71 [00:08&lt;00:15,  3.01it/s]Multinomial: 18.861675262451172, Poisson: -0.08962804079055786
Validation DataLoader 0:  37%|██████▌           | 26/71 [00:08&lt;00:14,  3.08it/s]Multinomial: 19.666078567504883, Poisson: -0.09272812306880951
Validation DataLoader 0:  38%|██████▊           | 27/71 [00:08&lt;00:13,  3.16it/s]Multinomial: 21.218786239624023, Poisson: -0.1013488844037056
Validation DataLoader 0:  39%|███████           | 28/71 [00:08&lt;00:13,  3.23it/s]Multinomial: 17.04737091064453, Poisson: -0.0808173343539238
Validation DataLoader 0:  41%|███████▎          | 29/71 [00:08&lt;00:12,  3.30it/s]Multinomial: 20.68085479736328, Poisson: -0.09840410202741623
Validation DataLoader 0:  42%|███████▌          | 30/71 [00:08&lt;00:12,  3.37it/s]Multinomial: 23.553321838378906, Poisson: -0.11226518452167511
Validation DataLoader 0:  44%|███████▊          | 31/71 [00:09&lt;00:11,  3.44it/s]Multinomial: 21.84552764892578, Poisson: -0.1039852425456047
Validation DataLoader 0:  45%|████████          | 32/71 [00:09&lt;00:11,  3.50it/s]Multinomial: 19.440387725830078, Poisson: -0.09284423291683197
Validation DataLoader 0:  46%|████████▎         | 33/71 [00:09&lt;00:10,  3.56it/s]Multinomial: 21.64706039428711, Poisson: -0.10421235114336014
Validation DataLoader 0:  48%|████████▌         | 34/71 [00:09&lt;00:10,  3.62it/s]Multinomial: 19.466501235961914, Poisson: -0.09256163984537125
Validation DataLoader 0:  49%|████████▊         | 35/71 [00:09&lt;00:09,  3.68it/s]Multinomial: 19.426748275756836, Poisson: -0.09243661165237427
Validation DataLoader 0:  51%|█████████▏        | 36/71 [00:09&lt;00:09,  3.74it/s]Multinomial: 24.161123275756836, Poisson: -0.1155739575624466
Validation DataLoader 0:  52%|█████████▍        | 37/71 [00:09&lt;00:08,  3.79it/s]Multinomial: 16.2274112701416, Poisson: -0.07550095021724701
Validation DataLoader 0:  54%|█████████▋        | 38/71 [00:09&lt;00:08,  3.85it/s]Multinomial: 22.83794403076172, Poisson: -0.10971289128065109
Validation DataLoader 0:  55%|█████████▉        | 39/71 [00:09&lt;00:08,  3.90it/s]Multinomial: 19.948009490966797, Poisson: -0.09537017345428467
Validation DataLoader 0:  56%|██████████▏       | 40/71 [00:10&lt;00:07,  3.96it/s]Multinomial: 24.1552734375, Poisson: -0.11571847647428513
Validation DataLoader 0:  58%|██████████▍       | 41/71 [00:10&lt;00:07,  4.01it/s]Multinomial: 18.511322021484375, Poisson: -0.08700627833604813
Validation DataLoader 0:  59%|██████████▋       | 42/71 [00:10&lt;00:07,  4.06it/s]Multinomial: 15.515254020690918, Poisson: -0.07257874310016632
Validation DataLoader 0:  61%|██████████▉       | 43/71 [00:10&lt;00:06,  4.11it/s]Multinomial: 22.334829330444336, Poisson: -0.10659985989332199
Validation DataLoader 0:  62%|███████████▏      | 44/71 [00:10&lt;00:06,  4.16it/s]Multinomial: 24.07685661315918, Poisson: -0.1155986562371254
Validation DataLoader 0:  63%|███████████▍      | 45/71 [00:10&lt;00:06,  4.21it/s]Multinomial: 22.955446243286133, Poisson: -0.1100364699959755
Validation DataLoader 0:  65%|███████████▋      | 46/71 [00:10&lt;00:05,  4.26it/s]Multinomial: 21.843008041381836, Poisson: -0.1042463630437851
Validation DataLoader 0:  66%|███████████▉      | 47/71 [00:10&lt;00:05,  4.30it/s]Multinomial: 21.23880386352539, Poisson: -0.10132242739200592
Validation DataLoader 0:  68%|████████████▏     | 48/71 [00:11&lt;00:05,  4.35it/s]Multinomial: 24.01917839050293, Poisson: -0.11582714319229126
Validation DataLoader 0:  69%|████████████▍     | 49/71 [00:11&lt;00:05,  4.39it/s]Multinomial: 19.12872314453125, Poisson: -0.08988486975431442
Validation DataLoader 0:  70%|████████████▋     | 50/71 [00:11&lt;00:04,  4.44it/s]Multinomial: 18.915800094604492, Poisson: -0.08947309851646423
Validation DataLoader 0:  72%|████████████▉     | 51/71 [00:11&lt;00:04,  4.48it/s]Multinomial: 19.98969841003418, Poisson: -0.09558624029159546
Validation DataLoader 0:  73%|█████████████▏    | 52/71 [00:11&lt;00:04,  4.52it/s]Multinomial: 21.69757080078125, Poisson: -0.10410184413194656
Validation DataLoader 0:  75%|█████████████▍    | 53/71 [00:11&lt;00:03,  4.56it/s]Multinomial: 23.725969314575195, Poisson: -0.11290544271469116
Validation DataLoader 0:  76%|█████████████▋    | 54/71 [00:11&lt;00:03,  4.60it/s]Multinomial: 23.580698013305664, Poisson: -0.11311308294534683
Validation DataLoader 0:  77%|█████████████▉    | 55/71 [00:11&lt;00:03,  4.64it/s]Multinomial: 21.585058212280273, Poisson: -0.10382141917943954
Validation DataLoader 0:  79%|██████████████▏   | 56/71 [00:11&lt;00:03,  4.68it/s]Multinomial: 21.17513656616211, Poisson: -0.10134223103523254
Validation DataLoader 0:  80%|██████████████▍   | 57/71 [00:12&lt;00:02,  4.72it/s]Multinomial: 18.344024658203125, Poisson: -0.08682217448949814
Validation DataLoader 0:  82%|██████████████▋   | 58/71 [00:12&lt;00:02,  4.76it/s]Multinomial: 20.66619873046875, Poisson: -0.0984412357211113
Validation DataLoader 0:  83%|██████████████▉   | 59/71 [00:12&lt;00:02,  4.79it/s]Multinomial: 20.594228744506836, Poisson: -0.09838820993900299
Validation DataLoader 0:  85%|███████████████▏  | 60/71 [00:12&lt;00:02,  4.83it/s]Multinomial: 23.49152374267578, Poisson: -0.11265675723552704
Validation DataLoader 0:  86%|███████████████▍  | 61/71 [00:12&lt;00:02,  4.86it/s]Multinomial: 21.221303939819336, Poisson: -0.10111219435930252
Validation DataLoader 0:  87%|███████████████▋  | 62/71 [00:12&lt;00:01,  4.90it/s]Multinomial: 16.08350944519043, Poisson: -0.0753072202205658
Validation DataLoader 0:  89%|███████████████▉  | 63/71 [00:12&lt;00:01,  4.93it/s]Multinomial: 20.7032413482666, Poisson: -0.09827789664268494
Validation DataLoader 0:  90%|████████████████▏ | 64/71 [00:12&lt;00:01,  4.97it/s]Multinomial: 20.60161018371582, Poisson: -0.09760463237762451
Validation DataLoader 0:  92%|████████████████▍ | 65/71 [00:13&lt;00:01,  5.00it/s]Multinomial: 21.132230758666992, Poisson: -0.10111389309167862
Validation DataLoader 0:  93%|████████████████▋ | 66/71 [00:13&lt;00:00,  5.03it/s]Multinomial: 22.298412322998047, Poisson: -0.10688994824886322
Validation DataLoader 0:  94%|████████████████▉ | 67/71 [00:13&lt;00:00,  5.06it/s]Multinomial: 20.12604331970215, Poisson: -0.09556743502616882
Validation DataLoader 0:  96%|█████████████████▏| 68/71 [00:13&lt;00:00,  5.09it/s]Multinomial: 17.561452865600586, Poisson: -0.08392468839883804
Validation DataLoader 0:  97%|█████████████████▍| 69/71 [00:13&lt;00:00,  5.12it/s]Multinomial: 20.696557998657227, Poisson: -0.09832420945167542
Validation DataLoader 0:  99%|█████████████████▋| 70/71 [00:13&lt;00:00,  5.15it/s]Multinomial: 23.9903564453125, Poisson: -0.11563663184642792
Validation DataLoader 0: 100%|██████████████████| 71/71 [00:14&lt;00:00,  4.96it/s]
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃<span class=" -Color -Color-Bold">      Validate metric      </span>┃<span class=" -Color -Color-Bold">       DataLoader 0        </span>┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│<span class=" -Color -Color-Cyan">     val_gene_pearson      </span>│<span class=" -Color -Color-Magenta">     0.04302978515625      </span>│
│<span class=" -Color -Color-Cyan">         val_loss          </span>│<span class=" -Color -Color-Magenta">     20.62993621826172     </span>│
│<span class=" -Color -Color-Cyan">          val_mse          </span>│<span class=" -Color -Color-Magenta">    28.771121978759766     </span>│
│<span class=" -Color -Color-Cyan">     val_task_pearson      </span>│<span class=" -Color -Color-Magenta">    0.03143211454153061    </span>│
└───────────────────────────┴───────────────────────────┘
/home/celikm5/miniforge3/envs/decima2/lib/python3.11/site-packages/lightning_fabric/plugins/environments/slurm.py:204: PossibleUserWarning: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python3.11 /home/celikm5/miniforge3/envs/decima2/bin/decima ...
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
/home/celikm5/miniforge3/envs/decima2/lib/python3.11/site-packages/pytorch_lightning/utilities/model_summary/model_summary.py:231: UserWarning: Precision 16-mixed is not supported by the model summary.  Estimated model size in MB will not be accurate. Using 32 bits instead.

  | Name            | Type                           | Params | Mode 
---------------------------------------------------------------------------
0 | model           | DecimaModel                    | 171 M  | train
1 | loss            | TaskWisePoissonMultinomialLoss | 0      | train
2 | val_metrics     | MetricCollection               | 0      | train
3 | test_metrics    | MetricCollection               | 0      | train
4 | warning_counter | WarningCounter                 | 0      | train
5 | transform       | Identity                       | 0      | train
---------------------------------------------------------------------------
171 M     Trainable params
0         Non-trainable params
171 M     Total params
685.503   Total estimated model params size (MB)
401       Modules in train mode
0         Modules in eval mode
Sanity Checking: |                                        | 0/? [00:00&lt;?, ?it/s]/home/celikm5/miniforge3/envs/decima2/lib/python3.11/site-packages/torch/utils/data/dataloader.py:627: UserWarning: This DataLoader will create 16 worker processes in total. Our suggested max number of worker in current system is 4, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
Sanity Checking DataLoader 0:   0%|                       | 0/2 [00:00&lt;?, ?it/s]Multinomial: 17.819683074951172, Poisson: -0.08381132036447525
Sanity Checking DataLoader 0:  50%|███████▌       | 1/2 [00:00&lt;00:00,  4.99it/s]Multinomial: 17.218976974487305, Poisson: -0.08079911023378372
Epoch 0:   0%|                                          | 0/769 [00:00&lt;?, ?it/s]Multinomial: 18.956485748291016, Poisson: -0.08963526040315628
Epoch 0:   0%| | 1/769 [00:03&lt;41:23,  0.31it/s, v_num=z19b, train_loss_step=18.9Multinomial: 18.307830810546875, Poisson: -0.0864010900259018
Epoch 0:   0%| | 2/769 [00:03&lt;22:40,  0.56it/s, v_num=z19b, train_loss_step=18.2Multinomial: 19.300460815429688, Poisson: -0.09252157807350159
Epoch 0:   0%| | 3/769 [00:03&lt;16:25,  0.78it/s, v_num=z19b, train_loss_step=19.2Multinomial: 18.552936553955078, Poisson: -0.08643324673175812
Epoch 0:   1%| | 4/769 [00:04&lt;13:18,  0.96it/s, v_num=z19b, train_loss_step=18.5Multinomial: 17.738399505615234, Poisson: -0.08363226056098938
Epoch 0:   1%| | 5/769 [00:04&lt;12:01,  1.06it/s, v_num=z19b, train_loss_step=17.7Multinomial: 20.6273193359375, Poisson: -0.09774256497621536
Epoch 0:   1%| | 6/769 [00:05&lt;10:40,  1.19it/s, v_num=z19b, train_loss_step=20.5Multinomial: 23.46624183654785, Poisson: -0.11207188665866852
Epoch 0:   1%| | 7/769 [00:05&lt;09:42,  1.31it/s, v_num=z19b, train_loss_step=23.4Multinomial: 18.90964698791504, Poisson: -0.0891963541507721
Epoch 0:   1%| | 8/769 [00:05&lt;08:58,  1.41it/s, v_num=z19b, train_loss_step=18.8Multinomial: 18.990468978881836, Poisson: -0.08938340097665787
Epoch 0:   1%| | 9/769 [00:05&lt;08:24,  1.51it/s, v_num=z19b, train_loss_step=18.9Multinomial: 21.718978881835938, Poisson: -0.10384061932563782
Epoch 0:   1%| | 10/769 [00:06&lt;08:02,  1.57it/s, v_num=z19b, train_loss_step=21.Multinomial: 17.220592498779297, Poisson: -0.08090207725763321
Epoch 0:   1%| | 11/769 [00:06&lt;07:40,  1.65it/s, v_num=z19b, train_loss_step=17.Multinomial: 22.365785598754883, Poisson: -0.1065056100487709
Epoch 0:   2%| | 12/769 [00:07&lt;07:23,  1.71it/s, v_num=z19b, train_loss_step=22.Multinomial: 20.142162322998047, Poisson: -0.09501631557941437
Epoch 0:   2%| | 13/769 [00:07&lt;07:06,  1.77it/s, v_num=z19b, train_loss_step=20.Multinomial: 21.18971061706543, Poisson: -0.10113725066184998
Epoch 0:   2%| | 14/769 [00:07&lt;06:52,  1.83it/s, v_num=z19b, train_loss_step=21.Multinomial: 19.530071258544922, Poisson: -0.09229367971420288
Epoch 0:   2%| | 15/769 [00:07&lt;06:41,  1.88it/s, v_num=z19b, train_loss_step=19.Multinomial: 21.644378662109375, Poisson: -0.10343197733163834
Epoch 0:   2%| | 16/769 [00:08&lt;06:30,  1.93it/s, v_num=z19b, train_loss_step=21.Multinomial: 20.055627822875977, Poisson: -0.0951433777809143
Epoch 0:   2%| | 17/769 [00:08&lt;06:20,  1.97it/s, v_num=z19b, train_loss_step=20.Multinomial: 20.637739181518555, Poisson: -0.09809457510709763
Epoch 0:   2%| | 18/769 [00:08&lt;06:12,  2.02it/s, v_num=z19b, train_loss_step=20.Multinomial: 20.57514190673828, Poisson: -0.09784431010484695
Epoch 0:   2%| | 19/769 [00:09&lt;06:04,  2.06it/s, v_num=z19b, train_loss_step=20.Multinomial: 22.369211196899414, Poisson: -0.10676915943622589
Epoch 0:   3%| | 20/769 [00:09&lt;05:58,  2.09it/s, v_num=z19b, train_loss_step=22.Multinomial: 20.61941146850586, Poisson: -0.09810647368431091
Epoch 0:   3%| | 21/769 [00:09&lt;05:52,  2.12it/s, v_num=z19b, train_loss_step=20.Multinomial: 21.163612365722656, Poisson: -0.10076244920492172
Epoch 0:   3%| | 22/769 [00:10&lt;05:46,  2.16it/s, v_num=z19b, train_loss_step=21.Multinomial: 20.58562469482422, Poisson: -0.0981590673327446
Epoch 0:   3%| | 23/769 [00:10&lt;05:41,  2.19it/s, v_num=z19b, train_loss_step=20.Multinomial: 24.593950271606445, Poisson: -0.11803364008665085
Epoch 0:   3%| | 24/769 [00:10&lt;05:36,  2.22it/s, v_num=z19b, train_loss_step=24.Multinomial: 21.25119400024414, Poisson: -0.10075905174016953
Epoch 0:   3%| | 25/769 [00:11&lt;05:32,  2.24it/s, v_num=z19b, train_loss_step=21.Multinomial: 19.489925384521484, Poisson: -0.09241088479757309
Epoch 0:   3%| | 26/769 [00:11&lt;05:27,  2.27it/s, v_num=z19b, train_loss_step=19.Multinomial: 22.931798934936523, Poisson: -0.10959816724061966
Epoch 0:   4%| | 27/769 [00:11&lt;05:24,  2.29it/s, v_num=z19b, train_loss_step=22.Multinomial: 18.307865142822266, Poisson: -0.0865030586719513
Epoch 0:   4%| | 28/769 [00:12&lt;05:20,  2.31it/s, v_num=z19b, train_loss_step=18.Multinomial: 20.54052734375, Poisson: -0.0977647602558136
Epoch 0:   4%| | 29/769 [00:12&lt;05:16,  2.34it/s, v_num=z19b, train_loss_step=20.Multinomial: 19.98228645324707, Poisson: -0.09532017260789871
Epoch 0:   4%| | 30/769 [00:12&lt;05:14,  2.35it/s, v_num=z19b, train_loss_step=19.Multinomial: 18.30303955078125, Poisson: -0.08659765124320984
Epoch 0:   4%| | 31/769 [00:13&lt;05:11,  2.37it/s, v_num=z19b, train_loss_step=18.Multinomial: 18.941688537597656, Poisson: -0.08937288075685501
Epoch 0:   4%| | 32/769 [00:13&lt;05:08,  2.39it/s, v_num=z19b, train_loss_step=18.Multinomial: 19.476531982421875, Poisson: -0.09202294796705246
Epoch 0:   4%| | 33/769 [00:13&lt;05:05,  2.41it/s, v_num=z19b, train_loss_step=19.Multinomial: 21.697608947753906, Poisson: -0.10378693789243698
Epoch 0:   4%| | 34/769 [00:14&lt;05:02,  2.43it/s, v_num=z19b, train_loss_step=21.Multinomial: 19.558349609375, Poisson: -0.09233655035495758
Epoch 0:   5%| | 35/769 [00:14&lt;05:00,  2.44it/s, v_num=z19b, train_loss_step=19.Multinomial: 22.86825942993164, Poisson: -0.10962492227554321
Epoch 0:   5%| | 36/769 [00:14&lt;04:58,  2.46it/s, v_num=z19b, train_loss_step=22.Multinomial: 19.52899169921875, Poisson: -0.0922299399971962
Epoch 0:   5%| | 37/769 [00:14&lt;04:56,  2.47it/s, v_num=z19b, train_loss_step=19.Multinomial: 19.370391845703125, Poisson: -0.09252504259347916
Epoch 0:   5%| | 38/769 [00:15&lt;04:54,  2.49it/s, v_num=z19b, train_loss_step=19.Multinomial: 14.864683151245117, Poisson: -0.06939058005809784
Epoch 0:   5%| | 39/769 [00:15&lt;04:51,  2.50it/s, v_num=z19b, train_loss_step=14.Multinomial: 21.796743392944336, Poisson: -0.10370439291000366
Epoch 0:   5%| | 40/769 [00:15&lt;04:50,  2.51it/s, v_num=z19b, train_loss_step=21.Multinomial: 21.212942123413086, Poisson: -0.1007462739944458
Epoch 0:   5%| | 41/769 [00:16&lt;04:48,  2.52it/s, v_num=z19b, train_loss_step=21.Multinomial: 22.270030975341797, Poisson: -0.10666177421808243
Epoch 0:   5%| | 42/769 [00:16&lt;04:46,  2.54it/s, v_num=z19b, train_loss_step=22.Multinomial: 23.94695472717285, Poisson: -0.11492592841386795
Epoch 0:   6%| | 43/769 [00:16&lt;04:44,  2.55it/s, v_num=z19b, train_loss_step=23.Multinomial: 19.441083908081055, Poisson: -0.0922362208366394
Epoch 0:   6%| | 44/769 [00:17&lt;04:43,  2.56it/s, v_num=z19b, train_loss_step=19.Multinomial: 19.416019439697266, Poisson: -0.09209079295396805
Epoch 0:   6%| | 45/769 [00:17&lt;04:41,  2.57it/s, v_num=z19b, train_loss_step=19.Multinomial: 18.93990135192871, Poisson: -0.08944497257471085
Epoch 0:   6%| | 46/769 [00:17&lt;04:40,  2.58it/s, v_num=z19b, train_loss_step=18.Multinomial: 21.785419464111328, Poisson: -0.10382629185914993
Epoch 0:   6%| | 47/769 [00:18&lt;04:39,  2.59it/s, v_num=z19b, train_loss_step=21.Multinomial: 21.11366081237793, Poisson: -0.10074056684970856
Epoch 0:   6%| | 48/769 [00:18&lt;04:37,  2.60it/s, v_num=z19b, train_loss_step=21.Multinomial: 18.245397567749023, Poisson: -0.08633602410554886
Epoch 0:   6%| | 49/769 [00:18&lt;04:36,  2.61it/s, v_num=z19b, train_loss_step=18.Multinomial: 22.355743408203125, Poisson: -0.10654257237911224
Epoch 0:   7%| | 50/769 [00:19&lt;04:35,  2.61it/s, v_num=z19b, train_loss_step=22.Multinomial: 18.851909637451172, Poisson: -0.0894286036491394
Epoch 0:   7%| | 51/769 [00:19&lt;04:33,  2.62it/s, v_num=z19b, train_loss_step=18.Multinomial: 22.29789924621582, Poisson: -0.10644979029893875
Epoch 0:   7%| | 52/769 [00:19&lt;04:32,  2.63it/s, v_num=z19b, train_loss_step=22.Multinomial: 18.950695037841797, Poisson: -0.08930623531341553
Epoch 0:   7%| | 53/769 [00:20&lt;04:31,  2.64it/s, v_num=z19b, train_loss_step=18.Multinomial: 18.824020385742188, Poisson: -0.08929803967475891
Epoch 0:   7%| | 54/769 [00:20&lt;04:29,  2.65it/s, v_num=z19b, train_loss_step=18.Multinomial: 20.6265811920166, Poisson: -0.09793362766504288
Epoch 0:   7%| | 55/769 [00:20&lt;04:29,  2.65it/s, v_num=z19b, train_loss_step=20.Multinomial: 21.062782287597656, Poisson: -0.10094263404607773
Epoch 0:   7%| | 56/769 [00:21&lt;04:27,  2.66it/s, v_num=z19b, train_loss_step=21.Multinomial: 21.651784896850586, Poisson: -0.10365276783704758
Epoch 0:   7%| | 57/769 [00:21&lt;04:26,  2.67it/s, v_num=z19b, train_loss_step=21.Multinomial: 21.140995025634766, Poisson: -0.10062523186206818
Epoch 0:   8%| | 58/769 [00:21&lt;04:25,  2.68it/s, v_num=z19b, train_loss_step=21.Multinomial: 21.7513370513916, Poisson: -0.1039934754371643
Epoch 0:   8%| | 59/769 [00:21&lt;04:24,  2.68it/s, v_num=z19b, train_loss_step=21.Multinomial: 21.823253631591797, Poisson: -0.10349936038255692
Epoch 0:   8%| | 60/769 [00:22&lt;04:23,  2.69it/s, v_num=z19b, train_loss_step=21.Multinomial: 22.29897117614746, Poisson: -0.10634535551071167
Epoch 0:   8%| | 61/769 [00:22&lt;04:22,  2.70it/s, v_num=z19b, train_loss_step=22.Multinomial: 21.699413299560547, Poisson: -0.10380487889051437
Epoch 0:   8%| | 62/769 [00:22&lt;04:21,  2.70it/s, v_num=z19b, train_loss_step=21.Multinomial: 19.415225982666016, Poisson: -0.09207886457443237
Epoch 0:   8%| | 63/769 [00:23&lt;04:20,  2.71it/s, v_num=z19b, train_loss_step=19.Multinomial: 22.906166076660156, Poisson: -0.10913008451461792
Epoch 0:   8%| | 64/769 [00:23&lt;04:19,  2.71it/s, v_num=z19b, train_loss_step=22.Multinomial: 21.710702896118164, Poisson: -0.1037421002984047
Epoch 0:   8%| | 65/769 [00:23&lt;04:19,  2.72it/s, v_num=z19b, train_loss_step=21.Multinomial: 22.30254364013672, Poisson: -0.1066879853606224
Epoch 0:   9%| | 66/769 [00:24&lt;04:18,  2.72it/s, v_num=z19b, train_loss_step=22.Multinomial: 20.563695907592773, Poisson: -0.09805519878864288
Epoch 0:   9%| | 67/769 [00:24&lt;04:17,  2.73it/s, v_num=z19b, train_loss_step=20.Multinomial: 23.41864776611328, Poisson: -0.11210466921329498
Epoch 0:   9%| | 68/769 [00:24&lt;04:16,  2.74it/s, v_num=z19b, train_loss_step=23.Multinomial: 21.700883865356445, Poisson: -0.10394324362277985
Epoch 0:   9%| | 69/769 [00:25&lt;04:15,  2.74it/s, v_num=z19b, train_loss_step=21.Multinomial: 18.978796005249023, Poisson: -0.08934426307678223
Epoch 0:   9%| | 70/769 [00:25&lt;04:14,  2.74it/s, v_num=z19b, train_loss_step=18.Multinomial: 20.658260345458984, Poisson: -0.09782557934522629
Epoch 0:   9%| | 71/769 [00:25&lt;04:13,  2.75it/s, v_num=z19b, train_loss_step=20.Multinomial: 21.74700164794922, Poisson: -0.10380426049232483
Epoch 0:   9%| | 72/769 [00:26&lt;04:12,  2.76it/s, v_num=z19b, train_loss_step=21.Multinomial: 23.46367645263672, Poisson: -0.11251290887594223
Epoch 0:   9%| | 73/769 [00:26&lt;04:12,  2.76it/s, v_num=z19b, train_loss_step=23.Multinomial: 19.03603744506836, Poisson: -0.08965646475553513
Epoch 0:  10%| | 74/769 [00:26&lt;04:11,  2.77it/s, v_num=z19b, train_loss_step=18.Multinomial: 21.16023826599121, Poisson: -0.10071754455566406
Epoch 0:  10%| | 75/769 [00:27&lt;04:10,  2.77it/s, v_num=z19b, train_loss_step=21.Multinomial: 19.998470306396484, Poisson: -0.09513579308986664
Epoch 0:  10%| | 76/769 [00:27&lt;04:09,  2.77it/s, v_num=z19b, train_loss_step=19.Multinomial: 21.1744384765625, Poisson: -0.10075344145298004
Epoch 0:  10%| | 77/769 [00:27&lt;04:09,  2.78it/s, v_num=z19b, train_loss_step=21.Multinomial: 21.101274490356445, Poisson: -0.1007973700761795
Epoch 0:  10%| | 78/769 [00:28&lt;04:08,  2.78it/s, v_num=z19b, train_loss_step=21.Multinomial: 20.5324649810791, Poisson: -0.0977492555975914
Epoch 0:  10%| | 79/769 [00:28&lt;04:07,  2.79it/s, v_num=z19b, train_loss_step=20.Multinomial: 20.03276252746582, Poisson: -0.09501877427101135
Epoch 0:  10%| | 80/769 [00:28&lt;04:07,  2.79it/s, v_num=z19b, train_loss_step=19.Multinomial: 18.93439483642578, Poisson: -0.0893227681517601
Epoch 0:  11%| | 81/769 [00:29&lt;04:06,  2.79it/s, v_num=z19b, train_loss_step=18.Multinomial: 19.965940475463867, Poisson: -0.09505126625299454
Epoch 0:  11%| | 82/769 [00:29&lt;04:05,  2.80it/s, v_num=z19b, train_loss_step=19.Multinomial: 22.884660720825195, Poisson: -0.10956492274999619
Epoch 0:  11%| | 83/769 [00:29&lt;04:04,  2.80it/s, v_num=z19b, train_loss_step=22.Multinomial: 17.721534729003906, Poisson: -0.0837162584066391
Epoch 0:  11%| | 84/769 [00:29&lt;04:04,  2.81it/s, v_num=z19b, train_loss_step=17.Multinomial: 19.545934677124023, Poisson: -0.09213781356811523
Epoch 0:  11%| | 85/769 [00:30&lt;04:03,  2.81it/s, v_num=z19b, train_loss_step=19.Multinomial: 25.16115379333496, Poisson: -0.1209883913397789
Epoch 0:  11%| | 86/769 [00:30&lt;04:02,  2.81it/s, v_num=z19b, train_loss_step=25.Multinomial: 21.211029052734375, Poisson: -0.1008252203464508
Epoch 0:  11%| | 87/769 [00:30&lt;04:02,  2.81it/s, v_num=z19b, train_loss_step=21.Multinomial: 17.71975326538086, Poisson: -0.08362014591693878
Epoch 0:  11%| | 88/769 [00:31&lt;04:01,  2.82it/s, v_num=z19b, train_loss_step=17.Multinomial: 22.86670684814453, Poisson: -0.10966545343399048
Epoch 0:  12%| | 89/769 [00:31&lt;04:00,  2.82it/s, v_num=z19b, train_loss_step=22.Multinomial: 19.387451171875, Poisson: -0.09241125732660294
Epoch 0:  12%| | 90/769 [00:31&lt;04:00,  2.82it/s, v_num=z19b, train_loss_step=19.Multinomial: 19.41223907470703, Poisson: -0.09226572513580322
Epoch 0:  12%| | 91/769 [00:32&lt;03:59,  2.83it/s, v_num=z19b, train_loss_step=19.Multinomial: 20.593629837036133, Poisson: -0.09804944694042206
Epoch 0:  12%| | 92/769 [00:32&lt;03:59,  2.83it/s, v_num=z19b, train_loss_step=20.Multinomial: 20.657365798950195, Poisson: -0.09804589301347733
Epoch 0:  12%| | 93/769 [00:32&lt;03:58,  2.83it/s, v_num=z19b, train_loss_step=20.Multinomial: 22.317907333374023, Poisson: -0.10631230473518372
Epoch 0:  12%| | 94/769 [00:33&lt;03:57,  2.84it/s, v_num=z19b, train_loss_step=22.Multinomial: 20.581689834594727, Poisson: -0.09788800776004791
Epoch 0:  12%| | 95/769 [00:33&lt;03:57,  2.84it/s, v_num=z19b, train_loss_step=20.Multinomial: 21.81819725036621, Poisson: -0.10351291298866272
Epoch 0:  12%| | 96/769 [00:33&lt;03:56,  2.84it/s, v_num=z19b, train_loss_step=21.Multinomial: 20.043054580688477, Poisson: -0.09506473690271378
Epoch 0:  13%|▏| 97/769 [00:34&lt;03:56,  2.84it/s, v_num=z19b, train_loss_step=19.Multinomial: 20.654403686523438, Poisson: -0.09780506044626236
Epoch 0:  13%|▏| 98/769 [00:34&lt;03:55,  2.85it/s, v_num=z19b, train_loss_step=20.Multinomial: 19.37279510498047, Poisson: -0.09213508665561676
Epoch 0:  13%|▏| 99/769 [00:34&lt;03:55,  2.85it/s, v_num=z19b, train_loss_step=19.Multinomial: 21.13717269897461, Poisson: -0.10080061107873917
Epoch 0:  13%|▏| 100/769 [00:35&lt;03:54,  2.85it/s, v_num=z19b, train_loss_step=21Multinomial: 20.55705451965332, Poisson: -0.09786467999219894
Epoch 0:  13%|▏| 101/769 [00:35&lt;03:54,  2.85it/s, v_num=z19b, train_loss_step=20Multinomial: 21.12802505493164, Poisson: -0.10086581856012344
Epoch 0:  13%|▏| 102/769 [00:35&lt;03:53,  2.86it/s, v_num=z19b, train_loss_step=21Multinomial: 17.74542236328125, Poisson: -0.08369649946689606
Epoch 0:  13%|▏| 103/769 [00:36&lt;03:52,  2.86it/s, v_num=z19b, train_loss_step=17Multinomial: 20.573101043701172, Poisson: -0.09807602316141129
Epoch 0:  14%|▏| 104/769 [00:36&lt;03:52,  2.86it/s, v_num=z19b, train_loss_step=20Multinomial: 19.918365478515625, Poisson: -0.09518372267484665
Epoch 0:  14%|▏| 105/769 [00:36&lt;03:51,  2.86it/s, v_num=z19b, train_loss_step=19Multinomial: 20.587080001831055, Poisson: -0.09779582917690277
Epoch 0:  14%|▏| 106/769 [00:36&lt;03:51,  2.87it/s, v_num=z19b, train_loss_step=20Multinomial: 21.768999099731445, Poisson: -0.10378393530845642
Epoch 0:  14%|▏| 107/769 [00:37&lt;03:50,  2.87it/s, v_num=z19b, train_loss_step=21Multinomial: 22.871967315673828, Poisson: -0.10936389863491058
Epoch 0:  14%|▏| 108/769 [00:37&lt;03:50,  2.87it/s, v_num=z19b, train_loss_step=22Multinomial: 19.447433471679688, Poisson: -0.09208845347166061
Epoch 0:  14%|▏| 109/769 [00:37&lt;03:49,  2.87it/s, v_num=z19b, train_loss_step=19Multinomial: 21.20417022705078, Poisson: -0.10096575319766998
Epoch 0:  14%|▏| 110/769 [00:38&lt;03:49,  2.87it/s, v_num=z19b, train_loss_step=21Multinomial: 21.722169876098633, Poisson: -0.10359921306371689
Epoch 0:  14%|▏| 111/769 [00:38&lt;03:48,  2.88it/s, v_num=z19b, train_loss_step=21Multinomial: 22.870092391967773, Poisson: -0.1093088835477829
Epoch 0:  15%|▏| 112/769 [00:38&lt;03:48,  2.88it/s, v_num=z19b, train_loss_step=22Multinomial: 19.997846603393555, Poisson: -0.09515158087015152
Epoch 0:  15%|▏| 113/769 [00:39&lt;03:47,  2.88it/s, v_num=z19b, train_loss_step=19Multinomial: 19.96185302734375, Poisson: -0.0951148271560669
Epoch 0:  15%|▏| 114/769 [00:39&lt;03:47,  2.88it/s, v_num=z19b, train_loss_step=19Multinomial: 21.17186737060547, Poisson: -0.10083810240030289
Epoch 0:  15%|▏| 115/769 [00:39&lt;03:46,  2.89it/s, v_num=z19b, train_loss_step=21Multinomial: 19.443424224853516, Poisson: -0.092204250395298
Epoch 0:  15%|▏| 116/769 [00:40&lt;03:46,  2.89it/s, v_num=z19b, train_loss_step=19Multinomial: 20.009994506835938, Poisson: -0.09539444744586945
Epoch 0:  15%|▏| 117/769 [00:40&lt;03:45,  2.89it/s, v_num=z19b, train_loss_step=19Multinomial: 21.77955436706543, Poisson: -0.10364022850990295
Epoch 0:  15%|▏| 118/769 [00:40&lt;03:45,  2.89it/s, v_num=z19b, train_loss_step=21Multinomial: 23.43273162841797, Poisson: -0.11232803761959076
Epoch 0:  15%|▏| 119/769 [00:41&lt;03:44,  2.89it/s, v_num=z19b, train_loss_step=23Multinomial: 19.455297470092773, Poisson: -0.09228754043579102
Epoch 0:  16%|▏| 120/769 [00:41&lt;03:44,  2.89it/s, v_num=z19b, train_loss_step=19Multinomial: 21.672269821166992, Poisson: -0.10353434830904007
Epoch 0:  16%|▏| 121/769 [00:41&lt;03:43,  2.90it/s, v_num=z19b, train_loss_step=21Multinomial: 16.587182998657227, Poisson: -0.07797733694314957
Epoch 0:  16%|▏| 122/769 [00:42&lt;03:43,  2.90it/s, v_num=z19b, train_loss_step=16Multinomial: 20.596317291259766, Poisson: -0.09824874997138977
Epoch 0:  16%|▏| 123/769 [00:42&lt;03:42,  2.90it/s, v_num=z19b, train_loss_step=20Multinomial: 22.80565643310547, Poisson: -0.10925903171300888
Epoch 0:  16%|▏| 124/769 [00:42&lt;03:42,  2.90it/s, v_num=z19b, train_loss_step=22Multinomial: 20.60991859436035, Poisson: -0.09792804718017578
Epoch 0:  16%|▏| 125/769 [00:43&lt;03:41,  2.90it/s, v_num=z19b, train_loss_step=20Multinomial: 23.442840576171875, Poisson: -0.11226436495780945
Epoch 0:  16%|▏| 126/769 [00:43&lt;03:41,  2.91it/s, v_num=z19b, train_loss_step=23Multinomial: 17.67164421081543, Poisson: -0.08381012082099915
Epoch 0:  17%|▏| 127/769 [00:43&lt;03:40,  2.91it/s, v_num=z19b, train_loss_step=17Multinomial: 18.235916137695312, Poisson: -0.08647213876247406
Epoch 0:  17%|▏| 128/769 [00:43&lt;03:40,  2.91it/s, v_num=z19b, train_loss_step=18Multinomial: 21.159053802490234, Poisson: -0.10089968889951706
Epoch 0:  17%|▏| 129/769 [00:44&lt;03:39,  2.91it/s, v_num=z19b, train_loss_step=21Multinomial: 20.536245346069336, Poisson: -0.09781194478273392
Epoch 0:  17%|▏| 130/769 [00:44&lt;03:39,  2.91it/s, v_num=z19b, train_loss_step=20Multinomial: 22.235578536987305, Poisson: -0.10652390867471695
Epoch 0:  17%|▏| 131/769 [00:44&lt;03:38,  2.91it/s, v_num=z19b, train_loss_step=22Multinomial: 22.83940887451172, Poisson: -0.1092725470662117
Epoch 0:  17%|▏| 132/769 [00:45&lt;03:38,  2.92it/s, v_num=z19b, train_loss_step=22Multinomial: 21.144533157348633, Poisson: -0.10083332657814026
Epoch 0:  17%|▏| 133/769 [00:45&lt;03:38,  2.92it/s, v_num=z19b, train_loss_step=21Multinomial: 18.274572372436523, Poisson: -0.0865967720746994
Epoch 0:  17%|▏| 134/769 [00:45&lt;03:37,  2.92it/s, v_num=z19b, train_loss_step=18Multinomial: 19.933935165405273, Poisson: -0.0951562374830246
Epoch 0:  18%|▏| 135/769 [00:46&lt;03:37,  2.92it/s, v_num=z19b, train_loss_step=19Multinomial: 22.34383201599121, Poisson: -0.10663321614265442
Epoch 0:  18%|▏| 136/769 [00:46&lt;03:36,  2.92it/s, v_num=z19b, train_loss_step=22Multinomial: 25.801382064819336, Poisson: -0.12392732501029968
Epoch 0:  18%|▏| 137/769 [00:46&lt;03:36,  2.92it/s, v_num=z19b, train_loss_step=25Multinomial: 18.304229736328125, Poisson: -0.08663090318441391
Epoch 0:  18%|▏| 138/769 [00:47&lt;03:35,  2.92it/s, v_num=z19b, train_loss_step=18Multinomial: 21.15840721130371, Poisson: -0.1007421538233757
Epoch 0:  18%|▏| 139/769 [00:47&lt;03:35,  2.93it/s, v_num=z19b, train_loss_step=21Multinomial: 18.894817352294922, Poisson: -0.08940707892179489
Epoch 0:  18%|▏| 140/769 [00:47&lt;03:34,  2.93it/s, v_num=z19b, train_loss_step=18Multinomial: 19.988170623779297, Poisson: -0.09506972879171371
Epoch 0:  18%|▏| 141/769 [00:48&lt;03:34,  2.93it/s, v_num=z19b, train_loss_step=19Multinomial: 21.22718620300293, Poisson: -0.10090277343988419
Epoch 0:  18%|▏| 142/769 [00:48&lt;03:34,  2.93it/s, v_num=z19b, train_loss_step=21Multinomial: 21.159576416015625, Poisson: -0.10074622929096222
Epoch 0:  19%|▏| 143/769 [00:48&lt;03:33,  2.93it/s, v_num=z19b, train_loss_step=21Multinomial: 21.770959854125977, Poisson: -0.10373947769403458
Epoch 0:  19%|▏| 144/769 [00:49&lt;03:33,  2.93it/s, v_num=z19b, train_loss_step=21Multinomial: 22.864864349365234, Poisson: -0.10940390080213547
Epoch 0:  19%|▏| 145/769 [00:49&lt;03:32,  2.93it/s, v_num=z19b, train_loss_step=22Multinomial: 22.936262130737305, Poisson: -0.10930701345205307
Epoch 0:  19%|▏| 146/769 [00:49&lt;03:32,  2.93it/s, v_num=z19b, train_loss_step=22Multinomial: 20.119462966918945, Poisson: -0.09520867466926575
Epoch 0:  19%|▏| 147/769 [00:50&lt;03:31,  2.94it/s, v_num=z19b, train_loss_step=20Multinomial: 20.059282302856445, Poisson: -0.09506797045469284
Epoch 0:  19%|▏| 148/769 [00:50&lt;03:31,  2.94it/s, v_num=z19b, train_loss_step=20Multinomial: 20.581336975097656, Poisson: -0.09794934093952179
Epoch 0:  19%|▏| 149/769 [00:50&lt;03:30,  2.94it/s, v_num=z19b, train_loss_step=20Multinomial: 20.57723045349121, Poisson: -0.0982198566198349
Epoch 0:  20%|▏| 150/769 [00:51&lt;03:30,  2.94it/s, v_num=z19b, train_loss_step=20Multinomial: 17.697647094726562, Poisson: -0.08374040573835373
Epoch 0:  20%|▏| 151/769 [00:51&lt;03:30,  2.94it/s, v_num=z19b, train_loss_step=17Multinomial: 21.124174118041992, Poisson: -0.10082727670669556
Epoch 0:  20%|▏| 152/769 [00:51&lt;03:29,  2.94it/s, v_num=z19b, train_loss_step=21Multinomial: 20.59746742248535, Poisson: -0.09796664118766785
Epoch 0:  20%|▏| 153/769 [00:51&lt;03:29,  2.94it/s, v_num=z19b, train_loss_step=20Multinomial: 25.167884826660156, Poisson: -0.1208660751581192
Epoch 0:  20%|▏| 154/769 [00:52&lt;03:28,  2.94it/s, v_num=z19b, train_loss_step=25Multinomial: 18.865087509155273, Poisson: -0.08951261639595032
Epoch 0:  20%|▏| 155/769 [00:52&lt;03:28,  2.94it/s, v_num=z19b, train_loss_step=18Multinomial: 19.99467658996582, Poisson: -0.0951363742351532
Epoch 0:  20%|▏| 156/769 [00:52&lt;03:28,  2.95it/s, v_num=z19b, train_loss_step=19Multinomial: 21.154157638549805, Poisson: -0.1009921208024025
Epoch 0:  20%|▏| 157/769 [00:53&lt;03:27,  2.95it/s, v_num=z19b, train_loss_step=21Multinomial: 21.717689514160156, Poisson: -0.10375764220952988
Epoch 0:  21%|▏| 158/769 [00:53&lt;03:27,  2.95it/s, v_num=z19b, train_loss_step=21Multinomial: 19.42806053161621, Poisson: -0.09238336235284805
Epoch 0:  21%|▏| 159/769 [00:53&lt;03:26,  2.95it/s, v_num=z19b, train_loss_step=19Multinomial: 19.407514572143555, Poisson: -0.09226585924625397
Epoch 0:  21%|▏| 160/769 [00:54&lt;03:26,  2.95it/s, v_num=z19b, train_loss_step=19Multinomial: 18.87627601623535, Poisson: -0.08939513564109802
Epoch 0:  21%|▏| 161/769 [00:54&lt;03:25,  2.95it/s, v_num=z19b, train_loss_step=18Multinomial: 21.15544319152832, Poisson: -0.1008416935801506
Epoch 0:  21%|▏| 162/769 [00:54&lt;03:25,  2.95it/s, v_num=z19b, train_loss_step=21Multinomial: 23.47602081298828, Poisson: -0.11219099909067154
Epoch 0:  21%|▏| 163/769 [00:55&lt;03:25,  2.95it/s, v_num=z19b, train_loss_step=23Multinomial: 19.382436752319336, Poisson: -0.09238410741090775
Epoch 0:  21%|▏| 164/769 [00:55&lt;03:24,  2.96it/s, v_num=z19b, train_loss_step=19Multinomial: 15.986960411071777, Poisson: -0.07506460696458817
Epoch 0:  21%|▏| 165/769 [00:55&lt;03:24,  2.96it/s, v_num=z19b, train_loss_step=15Multinomial: 21.696063995361328, Poisson: -0.1036059632897377
Epoch 0:  22%|▏| 166/769 [00:56&lt;03:23,  2.96it/s, v_num=z19b, train_loss_step=21Multinomial: 20.008460998535156, Poisson: -0.0952756479382515
Epoch 0:  22%|▏| 167/769 [00:56&lt;03:23,  2.96it/s, v_num=z19b, train_loss_step=19Multinomial: 22.886266708374023, Poisson: -0.10963958501815796
Epoch 0:  22%|▏| 168/769 [00:56&lt;03:23,  2.96it/s, v_num=z19b, train_loss_step=22Multinomial: 21.667827606201172, Poisson: -0.10367520153522491
Epoch 0:  22%|▏| 169/769 [00:57&lt;03:22,  2.96it/s, v_num=z19b, train_loss_step=21Multinomial: 21.778608322143555, Poisson: -0.10376212745904922
Epoch 0:  22%|▏| 170/769 [00:57&lt;03:22,  2.96it/s, v_num=z19b, train_loss_step=21Multinomial: 20.08230972290039, Poisson: -0.095086969435215
Epoch 0:  22%|▏| 171/769 [00:57&lt;03:21,  2.96it/s, v_num=z19b, train_loss_step=20Multinomial: 20.04420280456543, Poisson: -0.0950738936662674
Epoch 0:  22%|▏| 172/769 [00:58&lt;03:21,  2.96it/s, v_num=z19b, train_loss_step=19Multinomial: 20.570995330810547, Poisson: -0.09792804718017578
Epoch 0:  22%|▏| 173/769 [00:58&lt;03:21,  2.96it/s, v_num=z19b, train_loss_step=20Multinomial: 18.292282104492188, Poisson: -0.08677434176206589
Epoch 0:  23%|▏| 174/769 [00:58&lt;03:20,  2.97it/s, v_num=z19b, train_loss_step=18Multinomial: 18.86918830871582, Poisson: -0.08950230479240417
Epoch 0:  23%|▏| 175/769 [00:59&lt;03:20,  2.97it/s, v_num=z19b, train_loss_step=18Multinomial: 21.678119659423828, Poisson: -0.10364721715450287
Epoch 0:  23%|▏| 176/769 [00:59&lt;03:19,  2.97it/s, v_num=z19b, train_loss_step=21Multinomial: 20.054834365844727, Poisson: -0.09513673186302185
Epoch 0:  23%|▏| 177/769 [00:59&lt;03:19,  2.97it/s, v_num=z19b, train_loss_step=20Multinomial: 18.321088790893555, Poisson: -0.08673226833343506
Epoch 0:  23%|▏| 178/769 [00:59&lt;03:19,  2.97it/s, v_num=z19b, train_loss_step=18Multinomial: 20.546857833862305, Poisson: -0.09789935499429703
Epoch 0:  23%|▏| 179/769 [01:00&lt;03:18,  2.97it/s, v_num=z19b, train_loss_step=20Multinomial: 17.169328689575195, Poisson: -0.08091595768928528
Epoch 0:  23%|▏| 180/769 [01:00&lt;03:18,  2.97it/s, v_num=z19b, train_loss_step=17Multinomial: 18.887348175048828, Poisson: -0.08949630707502365
Epoch 0:  24%|▏| 181/769 [01:00&lt;03:17,  2.97it/s, v_num=z19b, train_loss_step=18Multinomial: 18.88418960571289, Poisson: -0.08939265459775925
Epoch 0:  24%|▏| 182/769 [01:01&lt;03:17,  2.97it/s, v_num=z19b, train_loss_step=18Multinomial: 18.890504837036133, Poisson: -0.08955063670873642
Epoch 0:  24%|▏| 183/769 [01:01&lt;03:17,  2.97it/s, v_num=z19b, train_loss_step=18Multinomial: 17.742528915405273, Poisson: -0.08372574299573898
Epoch 0:  24%|▏| 184/769 [01:01&lt;03:16,  2.97it/s, v_num=z19b, train_loss_step=17Multinomial: 18.907672882080078, Poisson: -0.08941255509853363
Epoch 0:  24%|▏| 185/769 [01:02&lt;03:16,  2.97it/s, v_num=z19b, train_loss_step=18Multinomial: 21.678251266479492, Poisson: -0.10381659865379333
Epoch 0:  24%|▏| 186/769 [01:02&lt;03:15,  2.97it/s, v_num=z19b, train_loss_step=21Multinomial: 21.751039505004883, Poisson: -0.1036723330616951
Epoch 0:  24%|▏| 187/769 [01:02&lt;03:15,  2.98it/s, v_num=z19b, train_loss_step=21Multinomial: 20.538509368896484, Poisson: -0.09807600826025009
Epoch 0:  24%|▏| 188/769 [01:03&lt;03:15,  2.98it/s, v_num=z19b, train_loss_step=20Multinomial: 22.819454193115234, Poisson: -0.10951250791549683
Epoch 0:  25%|▏| 189/769 [01:03&lt;03:14,  2.98it/s, v_num=z19b, train_loss_step=22Multinomial: 20.003860473632812, Poisson: -0.09522920846939087
Epoch 0:  25%|▏| 190/769 [01:03&lt;03:14,  2.98it/s, v_num=z19b, train_loss_step=19Multinomial: 18.247711181640625, Poisson: -0.0866011530160904
Epoch 0:  25%|▏| 191/769 [01:04&lt;03:14,  2.98it/s, v_num=z19b, train_loss_step=18Multinomial: 17.722126007080078, Poisson: -0.08381692320108414
Epoch 0:  25%|▏| 192/769 [01:04&lt;03:13,  2.98it/s, v_num=z19b, train_loss_step=17Multinomial: 22.301172256469727, Poisson: -0.10674368590116501
Epoch 0:  25%|▎| 193/769 [01:04&lt;03:13,  2.98it/s, v_num=z19b, train_loss_step=22Multinomial: 17.6475830078125, Poisson: -0.08380503952503204
Epoch 0:  25%|▎| 194/769 [01:05&lt;03:12,  2.98it/s, v_num=z19b, train_loss_step=17Multinomial: 18.275238037109375, Poisson: -0.08653154224157333
Epoch 0:  25%|▎| 195/769 [01:05&lt;03:12,  2.98it/s, v_num=z19b, train_loss_step=18Multinomial: 24.00282096862793, Poisson: -0.11536471545696259
Epoch 0:  25%|▎| 196/769 [01:05&lt;03:12,  2.98it/s, v_num=z19b, train_loss_step=23Multinomial: 24.048437118530273, Poisson: -0.11516141146421432
Epoch 0:  26%|▎| 197/769 [01:06&lt;03:11,  2.98it/s, v_num=z19b, train_loss_step=23Multinomial: 22.871540069580078, Poisson: -0.10947670787572861
Epoch 0:  26%|▎| 198/769 [01:06&lt;03:11,  2.98it/s, v_num=z19b, train_loss_step=22Multinomial: 23.468507766723633, Poisson: -0.11247166246175766
Epoch 0:  26%|▎| 199/769 [01:06&lt;03:10,  2.98it/s, v_num=z19b, train_loss_step=23Multinomial: 19.45919418334961, Poisson: -0.09237854182720184
Epoch 0:  26%|▎| 200/769 [01:07&lt;03:10,  2.98it/s, v_num=z19b, train_loss_step=19Multinomial: 19.438844680786133, Poisson: -0.09225814044475555
Epoch 0:  26%|▎| 201/769 [01:07&lt;03:10,  2.99it/s, v_num=z19b, train_loss_step=19Multinomial: 20.5904541015625, Poisson: -0.09796056896448135
Epoch 0:  26%|▎| 202/769 [01:07&lt;03:09,  2.99it/s, v_num=z19b, train_loss_step=20Multinomial: 19.453508377075195, Poisson: -0.09236070513725281
Epoch 0:  26%|▎| 203/769 [01:07&lt;03:09,  2.99it/s, v_num=z19b, train_loss_step=19Multinomial: 18.86981964111328, Poisson: -0.0895095095038414
Epoch 0:  27%|▎| 204/769 [01:08&lt;03:09,  2.99it/s, v_num=z19b, train_loss_step=18Multinomial: 21.739513397216797, Poisson: -0.10385163128376007
Epoch 0:  27%|▎| 205/769 [01:08&lt;03:08,  2.99it/s, v_num=z19b, train_loss_step=21Multinomial: 21.18167495727539, Poisson: -0.10100856423377991
Epoch 0:  27%|▎| 206/769 [01:08&lt;03:08,  2.99it/s, v_num=z19b, train_loss_step=21Multinomial: 21.16883087158203, Poisson: -0.1010962724685669
Epoch 0:  27%|▎| 207/769 [01:09&lt;03:07,  2.99it/s, v_num=z19b, train_loss_step=21Multinomial: 21.13551139831543, Poisson: -0.10091222077608109
Epoch 0:  27%|▎| 208/769 [01:09&lt;03:07,  2.99it/s, v_num=z19b, train_loss_step=21Multinomial: 19.435155868530273, Poisson: -0.09225838631391525
Epoch 0:  27%|▎| 209/769 [01:09&lt;03:07,  2.99it/s, v_num=z19b, train_loss_step=19Multinomial: 23.469972610473633, Poisson: -0.11233360320329666
Epoch 0:  27%|▎| 210/769 [01:10&lt;03:06,  2.99it/s, v_num=z19b, train_loss_step=23Multinomial: 20.063282012939453, Poisson: -0.09517529606819153
Epoch 0:  27%|▎| 211/769 [01:10&lt;03:06,  2.99it/s, v_num=z19b, train_loss_step=20Multinomial: 21.172475814819336, Poisson: -0.10088318586349487
Epoch 0:  28%|▎| 212/769 [01:10&lt;03:06,  2.99it/s, v_num=z19b, train_loss_step=21Multinomial: 21.122753143310547, Poisson: -0.10086072981357574
Epoch 0:  28%|▎| 213/769 [01:11&lt;03:05,  2.99it/s, v_num=z19b, train_loss_step=21Multinomial: 19.961341857910156, Poisson: -0.09522179514169693
Epoch 0:  28%|▎| 214/769 [01:11&lt;03:05,  2.99it/s, v_num=z19b, train_loss_step=19Multinomial: 18.280027389526367, Poisson: -0.08664504438638687
Epoch 0:  28%|▎| 215/769 [01:11&lt;03:05,  2.99it/s, v_num=z19b, train_loss_step=18Multinomial: 23.977933883666992, Poisson: -0.1152290478348732
Epoch 0:  28%|▎| 216/769 [01:12&lt;03:04,  3.00it/s, v_num=z19b, train_loss_step=23Multinomial: 20.589845657348633, Poisson: -0.09821237623691559
Epoch 0:  28%|▎| 217/769 [01:12&lt;03:04,  3.00it/s, v_num=z19b, train_loss_step=20Multinomial: 21.150970458984375, Poisson: -0.10083521157503128
Epoch 0:  28%|▎| 218/769 [01:12&lt;03:03,  3.00it/s, v_num=z19b, train_loss_step=21Multinomial: 18.859487533569336, Poisson: -0.08944699913263321
Epoch 0:  28%|▎| 219/769 [01:13&lt;03:03,  3.00it/s, v_num=z19b, train_loss_step=18Multinomial: 19.999040603637695, Poisson: -0.09520262479782104
Epoch 0:  29%|▎| 220/769 [01:13&lt;03:03,  3.00it/s, v_num=z19b, train_loss_step=19Multinomial: 20.004871368408203, Poisson: -0.09544271230697632
Epoch 0:  29%|▎| 221/769 [01:13&lt;03:02,  3.00it/s, v_num=z19b, train_loss_step=19Multinomial: 21.704294204711914, Poisson: -0.10376615822315216
Epoch 0:  29%|▎| 222/769 [01:14&lt;03:02,  3.00it/s, v_num=z19b, train_loss_step=21Multinomial: 16.641042709350586, Poisson: -0.07796334475278854
Epoch 0:  29%|▎| 223/769 [01:14&lt;03:02,  3.00it/s, v_num=z19b, train_loss_step=16Multinomial: 24.57883644104004, Poisson: -0.11817968636751175
Epoch 0:  29%|▎| 224/769 [01:14&lt;03:01,  3.00it/s, v_num=z19b, train_loss_step=24Multinomial: 20.568267822265625, Poisson: -0.09806062281131744
Epoch 0:  29%|▎| 225/769 [01:14&lt;03:01,  3.00it/s, v_num=z19b, train_loss_step=20Multinomial: 22.372350692749023, Poisson: -0.10669659078121185
Epoch 0:  29%|▎| 226/769 [01:15&lt;03:00,  3.00it/s, v_num=z19b, train_loss_step=22Multinomial: 21.12812614440918, Poisson: -0.10103004425764084
Epoch 0:  30%|▎| 227/769 [01:15&lt;03:00,  3.00it/s, v_num=z19b, train_loss_step=21Multinomial: 20.030908584594727, Poisson: -0.09513174742460251
Epoch 0:  30%|▎| 228/769 [01:15&lt;03:00,  3.00it/s, v_num=z19b, train_loss_step=19Multinomial: 21.173376083374023, Poisson: -0.10088112950325012
Epoch 0:  30%|▎| 229/769 [01:16&lt;02:59,  3.00it/s, v_num=z19b, train_loss_step=21Multinomial: 21.766576766967773, Poisson: -0.1038496196269989
Epoch 0:  30%|▎| 230/769 [01:16&lt;02:59,  3.00it/s, v_num=z19b, train_loss_step=21Multinomial: 18.25928497314453, Poisson: -0.08651966601610184
Epoch 0:  30%|▎| 231/769 [01:16&lt;02:59,  3.00it/s, v_num=z19b, train_loss_step=18Multinomial: 17.701711654663086, Poisson: -0.08369256556034088
Epoch 0:  30%|▎| 232/769 [01:17&lt;02:58,  3.00it/s, v_num=z19b, train_loss_step=17Multinomial: 18.344587326049805, Poisson: -0.08668956160545349
Epoch 0:  30%|▎| 233/769 [01:17&lt;02:58,  3.01it/s, v_num=z19b, train_loss_step=18Multinomial: 20.573871612548828, Poisson: -0.09818234294652939
Epoch 0:  30%|▎| 234/769 [01:17&lt;02:57,  3.01it/s, v_num=z19b, train_loss_step=20Multinomial: 19.977432250976562, Poisson: -0.09516039490699768
Epoch 0:  31%|▎| 235/769 [01:18&lt;02:57,  3.01it/s, v_num=z19b, train_loss_step=19Multinomial: 22.897958755493164, Poisson: -0.10966895520687103
Epoch 0:  31%|▎| 236/769 [01:18&lt;02:57,  3.01it/s, v_num=z19b, train_loss_step=22Multinomial: 22.338491439819336, Poisson: -0.1068485900759697
Epoch 0:  31%|▎| 237/769 [01:18&lt;02:56,  3.01it/s, v_num=z19b, train_loss_step=22Multinomial: 20.586618423461914, Poisson: -0.09821614623069763
Epoch 0:  31%|▎| 238/769 [01:19&lt;02:56,  3.01it/s, v_num=z19b, train_loss_step=20Multinomial: 22.318710327148438, Poisson: -0.10661838203668594
Epoch 0:  31%|▎| 239/769 [01:19&lt;02:56,  3.01it/s, v_num=z19b, train_loss_step=22Multinomial: 22.31263542175293, Poisson: -0.10684742033481598
Epoch 0:  31%|▎| 240/769 [01:19&lt;02:55,  3.01it/s, v_num=z19b, train_loss_step=22Multinomial: 22.33840560913086, Poisson: -0.10674253851175308
Epoch 0:  31%|▎| 241/769 [01:20&lt;02:55,  3.01it/s, v_num=z19b, train_loss_step=22Multinomial: 20.58753204345703, Poisson: -0.09811171889305115
Epoch 0:  31%|▎| 242/769 [01:20&lt;02:55,  3.01it/s, v_num=z19b, train_loss_step=20Multinomial: 20.57198715209961, Poisson: -0.09816879779100418
Epoch 0:  32%|▎| 243/769 [01:20&lt;02:54,  3.01it/s, v_num=z19b, train_loss_step=20Multinomial: 19.41629409790039, Poisson: -0.09251920878887177
Epoch 0:  32%|▎| 244/769 [01:21&lt;02:54,  3.01it/s, v_num=z19b, train_loss_step=19Multinomial: 21.688396453857422, Poisson: -0.10389994829893112
Epoch 0:  32%|▎| 245/769 [01:21&lt;02:54,  3.01it/s, v_num=z19b, train_loss_step=21Multinomial: 21.717241287231445, Poisson: -0.10379195213317871
Epoch 0:  32%|▎| 246/769 [01:21&lt;02:53,  3.01it/s, v_num=z19b, train_loss_step=21Multinomial: 19.416290283203125, Poisson: -0.09241010248661041
Epoch 0:  32%|▎| 247/769 [01:22&lt;02:53,  3.01it/s, v_num=z19b, train_loss_step=19Multinomial: 24.04590606689453, Poisson: -0.11534339189529419
Epoch 0:  32%|▎| 248/769 [01:22&lt;02:52,  3.01it/s, v_num=z19b, train_loss_step=23Multinomial: 23.44274139404297, Poisson: -0.11234107613563538
Epoch 0:  32%|▎| 249/769 [01:22&lt;02:52,  3.01it/s, v_num=z19b, train_loss_step=23Multinomial: 21.148046493530273, Poisson: -0.10100981593132019
Epoch 0:  33%|▎| 250/769 [01:22&lt;02:52,  3.01it/s, v_num=z19b, train_loss_step=21Multinomial: 22.30620574951172, Poisson: -0.10666144639253616
Epoch 0:  33%|▎| 251/769 [01:23&lt;02:51,  3.01it/s, v_num=z19b, train_loss_step=22Multinomial: 20.01934051513672, Poisson: -0.0952771008014679
Epoch 0:  33%|▎| 252/769 [01:23&lt;02:51,  3.01it/s, v_num=z19b, train_loss_step=19Multinomial: 21.13246726989746, Poisson: -0.1009606197476387
Epoch 0:  33%|▎| 253/769 [01:23&lt;02:51,  3.01it/s, v_num=z19b, train_loss_step=21Multinomial: 19.42268180847168, Poisson: -0.0924278125166893
Epoch 0:  33%|▎| 254/769 [01:24&lt;02:50,  3.02it/s, v_num=z19b, train_loss_step=19Multinomial: 22.307098388671875, Poisson: -0.10667595267295837
Epoch 0:  33%|▎| 255/769 [01:24&lt;02:50,  3.02it/s, v_num=z19b, train_loss_step=22Multinomial: 20.58059310913086, Poisson: -0.09820793569087982
Epoch 0:  33%|▎| 256/769 [01:24&lt;02:50,  3.02it/s, v_num=z19b, train_loss_step=20Multinomial: 19.99846076965332, Poisson: -0.09517494589090347
Epoch 0:  33%|▎| 257/769 [01:25&lt;02:49,  3.02it/s, v_num=z19b, train_loss_step=19Multinomial: 23.44794464111328, Poisson: -0.11254822462797165
Epoch 0:  34%|▎| 258/769 [01:25&lt;02:49,  3.02it/s, v_num=z19b, train_loss_step=23Multinomial: 21.158527374267578, Poisson: -0.10111452639102936
Epoch 0:  34%|▎| 259/769 [01:25&lt;02:49,  3.02it/s, v_num=z19b, train_loss_step=21Multinomial: 19.4149227142334, Poisson: -0.0924537181854248
Epoch 0:  34%|▎| 260/769 [01:26&lt;02:48,  3.02it/s, v_num=z19b, train_loss_step=19Multinomial: 20.573619842529297, Poisson: -0.09832920879125595
Epoch 0:  34%|▎| 261/769 [01:26&lt;02:48,  3.02it/s, v_num=z19b, train_loss_step=20Multinomial: 18.29786491394043, Poisson: -0.08677012473344803
Epoch 0:  34%|▎| 262/769 [01:26&lt;02:47,  3.02it/s, v_num=z19b, train_loss_step=18Multinomial: 21.14704132080078, Poisson: -0.10105320811271667
Epoch 0:  34%|▎| 263/769 [01:27&lt;02:47,  3.02it/s, v_num=z19b, train_loss_step=21Multinomial: 19.464962005615234, Poisson: -0.0923408642411232
Epoch 0:  34%|▎| 264/769 [01:27&lt;02:47,  3.02it/s, v_num=z19b, train_loss_step=19Multinomial: 19.405670166015625, Poisson: -0.09236906468868256
Epoch 0:  34%|▎| 265/769 [01:27&lt;02:46,  3.02it/s, v_num=z19b, train_loss_step=19Multinomial: 22.871261596679688, Poisson: -0.10979276150465012
Epoch 0:  35%|▎| 266/769 [01:28&lt;02:46,  3.02it/s, v_num=z19b, train_loss_step=22Multinomial: 21.740169525146484, Poisson: -0.10402519255876541
Epoch 0:  35%|▎| 267/769 [01:28&lt;02:46,  3.02it/s, v_num=z19b, train_loss_step=21Multinomial: 21.73726463317871, Poisson: -0.10388942807912827
Epoch 0:  35%|▎| 268/769 [01:28&lt;02:45,  3.02it/s, v_num=z19b, train_loss_step=21Multinomial: 21.71241569519043, Poisson: -0.10388461500406265
Epoch 0:  35%|▎| 269/769 [01:29&lt;02:45,  3.02it/s, v_num=z19b, train_loss_step=21Multinomial: 21.12247085571289, Poisson: -0.10113820433616638
Epoch 0:  35%|▎| 270/769 [01:29&lt;02:45,  3.02it/s, v_num=z19b, train_loss_step=21Multinomial: 21.13119125366211, Poisson: -0.10111363977193832
Epoch 0:  35%|▎| 271/769 [01:29&lt;02:44,  3.02it/s, v_num=z19b, train_loss_step=21Multinomial: 21.125829696655273, Poisson: -0.10108309984207153
Epoch 0:  35%|▎| 272/769 [01:30&lt;02:44,  3.02it/s, v_num=z19b, train_loss_step=21Multinomial: 20.023279190063477, Poisson: -0.09541279077529907
Epoch 0:  36%|▎| 273/769 [01:30&lt;02:44,  3.02it/s, v_num=z19b, train_loss_step=19Multinomial: 21.773283004760742, Poisson: -0.10400217026472092
Epoch 0:  36%|▎| 274/769 [01:30&lt;02:43,  3.02it/s, v_num=z19b, train_loss_step=21Multinomial: 22.877216339111328, Poisson: -0.10969763994216919
Epoch 0:  36%|▎| 275/769 [01:31&lt;02:43,  3.02it/s, v_num=z19b, train_loss_step=22Multinomial: 21.7279052734375, Poisson: -0.10394367575645447
Epoch 0:  36%|▎| 276/769 [01:31&lt;02:43,  3.02it/s, v_num=z19b, train_loss_step=21Multinomial: 21.134145736694336, Poisson: -0.10121294111013412
Epoch 0:  36%|▎| 277/769 [01:31&lt;02:42,  3.02it/s, v_num=z19b, train_loss_step=21Multinomial: 23.430471420288086, Poisson: -0.11268692463636398
Epoch 0:  36%|▎| 278/769 [01:31&lt;02:42,  3.02it/s, v_num=z19b, train_loss_step=23Multinomial: 18.859760284423828, Poisson: -0.08965077996253967
Epoch 0:  36%|▎| 279/769 [01:32&lt;02:42,  3.02it/s, v_num=z19b, train_loss_step=18Multinomial: 18.250112533569336, Poisson: -0.08666280657052994
Epoch 0:  36%|▎| 280/769 [01:32&lt;02:41,  3.02it/s, v_num=z19b, train_loss_step=18Multinomial: 21.15003204345703, Poisson: -0.10113584995269775
Epoch 0:  37%|▎| 281/769 [01:32&lt;02:41,  3.02it/s, v_num=z19b, train_loss_step=21Multinomial: 18.803932189941406, Poisson: -0.0895908921957016
Epoch 0:  37%|▎| 282/769 [01:33&lt;02:41,  3.02it/s, v_num=z19b, train_loss_step=18Multinomial: 24.01972770690918, Poisson: -0.11536786705255508
Epoch 0:  37%|▎| 283/769 [01:33&lt;02:40,  3.02it/s, v_num=z19b, train_loss_step=23Multinomial: 21.156497955322266, Poisson: -0.1010529026389122
Epoch 0:  37%|▎| 284/769 [01:33&lt;02:40,  3.02it/s, v_num=z19b, train_loss_step=21Multinomial: 17.155223846435547, Poisson: -0.08104707300662994
Epoch 0:  37%|▎| 285/769 [01:34&lt;02:40,  3.02it/s, v_num=z19b, train_loss_step=17Multinomial: 22.88865852355957, Poisson: -0.10965236276388168
Epoch 0:  37%|▎| 286/769 [01:34&lt;02:39,  3.03it/s, v_num=z19b, train_loss_step=22Multinomial: 21.709701538085938, Poisson: -0.10399796068668365
Epoch 0:  37%|▎| 287/769 [01:34&lt;02:39,  3.03it/s, v_num=z19b, train_loss_step=21Multinomial: 24.010549545288086, Poisson: -0.11557913571596146
Epoch 0:  37%|▎| 288/769 [01:35&lt;02:38,  3.03it/s, v_num=z19b, train_loss_step=23Multinomial: 18.261777877807617, Poisson: -0.08665899187326431
Epoch 0:  38%|▍| 289/769 [01:35&lt;02:38,  3.03it/s, v_num=z19b, train_loss_step=18Multinomial: 21.741567611694336, Poisson: -0.10384369641542435
Epoch 0:  38%|▍| 290/769 [01:35&lt;02:38,  3.03it/s, v_num=z19b, train_loss_step=21Multinomial: 22.27792739868164, Poisson: -0.10691516846418381
Epoch 0:  38%|▍| 291/769 [01:36&lt;02:37,  3.03it/s, v_num=z19b, train_loss_step=22Multinomial: 20.572200775146484, Poisson: -0.09818527847528458
Epoch 0:  38%|▍| 292/769 [01:36&lt;02:37,  3.03it/s, v_num=z19b, train_loss_step=20Multinomial: 21.748329162597656, Poisson: -0.10399570316076279
Epoch 0:  38%|▍| 293/769 [01:36&lt;02:37,  3.03it/s, v_num=z19b, train_loss_step=21Multinomial: 18.30255126953125, Poisson: -0.08677564561367035
Epoch 0:  38%|▍| 294/769 [01:37&lt;02:36,  3.03it/s, v_num=z19b, train_loss_step=18Multinomial: 19.980314254760742, Poisson: -0.0953734889626503
Epoch 0:  38%|▍| 295/769 [01:37&lt;02:36,  3.03it/s, v_num=z19b, train_loss_step=19Multinomial: 18.33155632019043, Poisson: -0.08671782165765762
Epoch 0:  38%|▍| 296/769 [01:37&lt;02:36,  3.03it/s, v_num=z19b, train_loss_step=18Multinomial: 20.537460327148438, Poisson: -0.09822335094213486
Epoch 0:  39%|▍| 297/769 [01:38&lt;02:35,  3.03it/s, v_num=z19b, train_loss_step=20Multinomial: 18.284353256225586, Poisson: -0.08664276450872421
Epoch 0:  39%|▍| 298/769 [01:38&lt;02:35,  3.03it/s, v_num=z19b, train_loss_step=18Multinomial: 20.004594802856445, Poisson: -0.09527886658906937
Epoch 0:  39%|▍| 299/769 [01:38&lt;02:35,  3.03it/s, v_num=z19b, train_loss_step=19Multinomial: 23.45073699951172, Poisson: -0.11265591531991959
Epoch 0:  39%|▍| 300/769 [01:39&lt;02:34,  3.03it/s, v_num=z19b, train_loss_step=23Multinomial: 21.131072998046875, Poisson: -0.10103961080312729
Epoch 0:  39%|▍| 301/769 [01:39&lt;02:34,  3.03it/s, v_num=z19b, train_loss_step=21Multinomial: 20.015920639038086, Poisson: -0.09541171789169312
Epoch 0:  39%|▍| 302/769 [01:39&lt;02:34,  3.03it/s, v_num=z19b, train_loss_step=19Multinomial: 21.690082550048828, Poisson: -0.10382000356912613
Epoch 0:  39%|▍| 303/769 [01:39&lt;02:33,  3.03it/s, v_num=z19b, train_loss_step=21Multinomial: 21.707128524780273, Poisson: -0.10397828370332718
Epoch 0:  40%|▍| 304/769 [01:40&lt;02:33,  3.03it/s, v_num=z19b, train_loss_step=21Multinomial: 21.11876106262207, Poisson: -0.10118232667446136
Epoch 0:  40%|▍| 305/769 [01:40&lt;02:33,  3.03it/s, v_num=z19b, train_loss_step=21Multinomial: 21.734880447387695, Poisson: -0.10410966724157333
Epoch 0:  40%|▍| 306/769 [01:40&lt;02:32,  3.03it/s, v_num=z19b, train_loss_step=21Multinomial: 21.13784408569336, Poisson: -0.10110345482826233
Epoch 0:  40%|▍| 307/769 [01:41&lt;02:32,  3.03it/s, v_num=z19b, train_loss_step=21Multinomial: 22.320663452148438, Poisson: -0.10685568302869797
Epoch 0:  40%|▍| 308/769 [01:41&lt;02:32,  3.03it/s, v_num=z19b, train_loss_step=22Multinomial: 18.84537124633789, Poisson: -0.08963166177272797
Epoch 0:  40%|▍| 309/769 [01:41&lt;02:31,  3.03it/s, v_num=z19b, train_loss_step=18Multinomial: 17.690256118774414, Poisson: -0.08389174938201904
Epoch 0:  40%|▍| 310/769 [01:42&lt;02:31,  3.03it/s, v_num=z19b, train_loss_step=17Multinomial: 19.411476135253906, Poisson: -0.09259004890918732
Epoch 0:  40%|▍| 311/769 [01:42&lt;02:30,  3.03it/s, v_num=z19b, train_loss_step=19Multinomial: 20.57769203186035, Poisson: -0.0982694998383522
Epoch 0:  41%|▍| 312/769 [01:42&lt;02:30,  3.03it/s, v_num=z19b, train_loss_step=20Multinomial: 22.86087417602539, Poisson: -0.10981260985136032
Epoch 0:  41%|▍| 313/769 [01:43&lt;02:30,  3.03it/s, v_num=z19b, train_loss_step=22Multinomial: 22.83802604675293, Poisson: -0.1096767783164978
Epoch 0:  41%|▍| 314/769 [01:43&lt;02:29,  3.03it/s, v_num=z19b, train_loss_step=22Multinomial: 20.56076431274414, Poisson: -0.09830053150653839
Epoch 0:  41%|▍| 315/769 [01:43&lt;02:29,  3.03it/s, v_num=z19b, train_loss_step=20Multinomial: 21.09801483154297, Poisson: -0.10110015422105789
Epoch 0:  41%|▍| 316/769 [01:44&lt;02:29,  3.03it/s, v_num=z19b, train_loss_step=21Multinomial: 19.983379364013672, Poisson: -0.09538564085960388
Epoch 0:  41%|▍| 317/769 [01:44&lt;02:28,  3.04it/s, v_num=z19b, train_loss_step=19Multinomial: 20.59761619567871, Poisson: -0.09822723269462585
Epoch 0:  41%|▍| 318/769 [01:44&lt;02:28,  3.04it/s, v_num=z19b, train_loss_step=20Multinomial: 22.945751190185547, Poisson: -0.1097647100687027
Epoch 0:  41%|▍| 319/769 [01:45&lt;02:28,  3.04it/s, v_num=z19b, train_loss_step=22Multinomial: 21.671005249023438, Poisson: -0.1040261834859848
Epoch 0:  42%|▍| 320/769 [01:45&lt;02:27,  3.04it/s, v_num=z19b, train_loss_step=21Multinomial: 22.296722412109375, Poisson: -0.10700652748346329
Epoch 0:  42%|▍| 321/769 [01:45&lt;02:27,  3.04it/s, v_num=z19b, train_loss_step=22Multinomial: 19.48693084716797, Poisson: -0.09271194785833359
Epoch 0:  42%|▍| 322/769 [01:46&lt;02:27,  3.04it/s, v_num=z19b, train_loss_step=19Multinomial: 22.854684829711914, Poisson: -0.10975489020347595
Epoch 0:  42%|▍| 323/769 [01:46&lt;02:26,  3.04it/s, v_num=z19b, train_loss_step=22Multinomial: 20.55263328552246, Poisson: -0.09838294237852097
Epoch 0:  42%|▍| 324/769 [01:46&lt;02:26,  3.04it/s, v_num=z19b, train_loss_step=20Multinomial: 23.471649169921875, Poisson: -0.11266103386878967
Epoch 0:  42%|▍| 325/769 [01:47&lt;02:26,  3.04it/s, v_num=z19b, train_loss_step=23Multinomial: 20.06353187561035, Poisson: -0.09537838399410248
Epoch 0:  42%|▍| 326/769 [01:47&lt;02:25,  3.04it/s, v_num=z19b, train_loss_step=20Multinomial: 21.148193359375, Poisson: -0.10134546458721161
Epoch 0:  43%|▍| 327/769 [01:47&lt;02:25,  3.04it/s, v_num=z19b, train_loss_step=21Multinomial: 21.74810218811035, Poisson: -0.1038864329457283
Epoch 0:  43%|▍| 328/769 [01:47&lt;02:25,  3.04it/s, v_num=z19b, train_loss_step=21Multinomial: 23.991666793823242, Poisson: -0.11549802124500275
Epoch 0:  43%|▍| 329/769 [01:48&lt;02:24,  3.04it/s, v_num=z19b, train_loss_step=23Multinomial: 20.10981559753418, Poisson: -0.09553676098585129
Epoch 0:  43%|▍| 330/769 [01:48&lt;02:24,  3.04it/s, v_num=z19b, train_loss_step=20Multinomial: 21.146512985229492, Poisson: -0.1010831966996193
Epoch 0:  43%|▍| 331/769 [01:48&lt;02:24,  3.04it/s, v_num=z19b, train_loss_step=21Multinomial: 21.193084716796875, Poisson: -0.1012096107006073
Epoch 0:  43%|▍| 332/769 [01:49&lt;02:23,  3.04it/s, v_num=z19b, train_loss_step=21Multinomial: 19.45332145690918, Poisson: -0.09247935563325882
Epoch 0:  43%|▍| 333/769 [01:49&lt;02:23,  3.04it/s, v_num=z19b, train_loss_step=19Multinomial: 20.042068481445312, Poisson: -0.09544237703084946
Epoch 0:  43%|▍| 334/769 [01:49&lt;02:23,  3.04it/s, v_num=z19b, train_loss_step=19Multinomial: 20.046321868896484, Poisson: -0.09535981714725494
Epoch 0:  44%|▍| 335/769 [01:50&lt;02:22,  3.04it/s, v_num=z19b, train_loss_step=20Multinomial: 20.59325408935547, Poisson: -0.09823198616504669
Epoch 0:  44%|▍| 336/769 [01:50&lt;02:22,  3.04it/s, v_num=z19b, train_loss_step=20Multinomial: 18.848363876342773, Poisson: -0.0895983874797821
Epoch 0:  44%|▍| 337/769 [01:50&lt;02:22,  3.04it/s, v_num=z19b, train_loss_step=18Multinomial: 19.98308753967285, Poisson: -0.09539753198623657
Epoch 0:  44%|▍| 338/769 [01:51&lt;02:21,  3.04it/s, v_num=z19b, train_loss_step=19Multinomial: 21.74696159362793, Poisson: -0.10389258712530136
Epoch 0:  44%|▍| 339/769 [01:51&lt;02:21,  3.04it/s, v_num=z19b, train_loss_step=21Multinomial: 22.954750061035156, Poisson: -0.10985051095485687
Epoch 0:  44%|▍| 340/769 [01:51&lt;02:21,  3.04it/s, v_num=z19b, train_loss_step=22Multinomial: 18.349952697753906, Poisson: -0.08684397488832474
Epoch 0:  44%|▍| 341/769 [01:52&lt;02:20,  3.04it/s, v_num=z19b, train_loss_step=18Multinomial: 19.469390869140625, Poisson: -0.09249632805585861
Epoch 0:  44%|▍| 342/769 [01:52&lt;02:20,  3.04it/s, v_num=z19b, train_loss_step=19Multinomial: 25.15866470336914, Poisson: -0.1211770698428154
Epoch 0:  45%|▍| 343/769 [01:52&lt;02:20,  3.04it/s, v_num=z19b, train_loss_step=25Multinomial: 16.519075393676758, Poisson: -0.07815786451101303
Epoch 0:  45%|▍| 344/769 [01:53&lt;02:19,  3.04it/s, v_num=z19b, train_loss_step=16Multinomial: 19.48614501953125, Poisson: -0.09253718703985214
Epoch 0:  45%|▍| 345/769 [01:53&lt;02:19,  3.04it/s, v_num=z19b, train_loss_step=19Multinomial: 21.197250366210938, Poisson: -0.1011340394616127
Epoch 0:  45%|▍| 346/769 [01:53&lt;02:19,  3.04it/s, v_num=z19b, train_loss_step=21Multinomial: 20.574214935302734, Poisson: -0.09830237925052643
Epoch 0:  45%|▍| 347/769 [01:54&lt;02:18,  3.04it/s, v_num=z19b, train_loss_step=20Multinomial: 22.30056381225586, Poisson: -0.10682816803455353
Epoch 0:  45%|▍| 348/769 [01:54&lt;02:18,  3.04it/s, v_num=z19b, train_loss_step=22Multinomial: 21.767629623413086, Poisson: -0.10412999987602234
Epoch 0:  45%|▍| 349/769 [01:54&lt;02:18,  3.04it/s, v_num=z19b, train_loss_step=21Multinomial: 20.60762596130371, Poisson: -0.0983283743262291
Epoch 0:  46%|▍| 350/769 [01:55&lt;02:17,  3.04it/s, v_num=z19b, train_loss_step=20Multinomial: 22.27347755432129, Poisson: -0.10681917518377304
Epoch 0:  46%|▍| 351/769 [01:55&lt;02:17,  3.04it/s, v_num=z19b, train_loss_step=22Multinomial: 19.98440933227539, Poisson: -0.09546057879924774
Epoch 0:  46%|▍| 352/769 [01:55&lt;02:17,  3.04it/s, v_num=z19b, train_loss_step=19Multinomial: 21.67464828491211, Poisson: -0.10410857945680618
Epoch 0:  46%|▍| 353/769 [01:56&lt;02:16,  3.04it/s, v_num=z19b, train_loss_step=21Multinomial: 17.73754119873047, Poisson: -0.08391395211219788
Epoch 0:  46%|▍| 354/769 [01:56&lt;02:16,  3.04it/s, v_num=z19b, train_loss_step=17Multinomial: 19.44107437133789, Poisson: -0.09249334782361984
Epoch 0:  46%|▍| 355/769 [01:56&lt;02:16,  3.04it/s, v_num=z19b, train_loss_step=19Multinomial: 22.323495864868164, Poisson: -0.10681244730949402
Epoch 0:  46%|▍| 356/769 [01:57&lt;02:15,  3.04it/s, v_num=z19b, train_loss_step=22Multinomial: 21.173120498657227, Poisson: -0.10117222368717194
Epoch 0:  46%|▍| 357/769 [01:57&lt;02:15,  3.04it/s, v_num=z19b, train_loss_step=21Multinomial: 22.875463485717773, Poisson: -0.10986408591270447
Epoch 0:  47%|▍| 358/769 [01:57&lt;02:15,  3.04it/s, v_num=z19b, train_loss_step=22Multinomial: 22.338598251342773, Poisson: -0.10688168555498123
Epoch 0:  47%|▍| 359/769 [01:58&lt;02:14,  3.04it/s, v_num=z19b, train_loss_step=22Multinomial: 20.579410552978516, Poisson: -0.09834117442369461
Epoch 0:  47%|▍| 360/769 [01:58&lt;02:14,  3.04it/s, v_num=z19b, train_loss_step=20Multinomial: 20.052146911621094, Poisson: -0.09549356251955032
Epoch 0:  47%|▍| 361/769 [01:58&lt;02:14,  3.04it/s, v_num=z19b, train_loss_step=20Multinomial: 17.144468307495117, Poisson: -0.08101094514131546
Epoch 0:  47%|▍| 362/769 [01:59&lt;02:13,  3.04it/s, v_num=z19b, train_loss_step=17Multinomial: 19.971012115478516, Poisson: -0.09547483921051025
Epoch 0:  47%|▍| 363/769 [01:59&lt;02:13,  3.04it/s, v_num=z19b, train_loss_step=19Multinomial: 20.597259521484375, Poisson: -0.09828195720911026
Epoch 0:  47%|▍| 364/769 [01:59&lt;02:13,  3.04it/s, v_num=z19b, train_loss_step=20Multinomial: 19.419294357299805, Poisson: -0.09245826303958893
Epoch 0:  47%|▍| 365/769 [01:59&lt;02:12,  3.04it/s, v_num=z19b, train_loss_step=19Multinomial: 22.25637435913086, Poisson: -0.10693082213401794
Epoch 0:  48%|▍| 366/769 [02:00&lt;02:12,  3.04it/s, v_num=z19b, train_loss_step=22Multinomial: 21.150802612304688, Poisson: -0.10109613835811615
Epoch 0:  48%|▍| 367/769 [02:00&lt;02:12,  3.04it/s, v_num=z19b, train_loss_step=21Multinomial: 19.42877197265625, Poisson: -0.09247226268053055
Epoch 0:  48%|▍| 368/769 [02:00&lt;02:11,  3.04it/s, v_num=z19b, train_loss_step=19Multinomial: 22.327816009521484, Poisson: -0.10697400569915771
Epoch 0:  48%|▍| 369/769 [02:01&lt;02:11,  3.04it/s, v_num=z19b, train_loss_step=22Multinomial: 20.053407669067383, Poisson: -0.09536901861429214
Epoch 0:  48%|▍| 370/769 [02:01&lt;02:11,  3.04it/s, v_num=z19b, train_loss_step=20Multinomial: 21.206581115722656, Poisson: -0.10114554315805435
Epoch 0:  48%|▍| 371/769 [02:01&lt;02:10,  3.04it/s, v_num=z19b, train_loss_step=21Multinomial: 18.307071685791016, Poisson: -0.08682633936405182
Epoch 0:  48%|▍| 372/769 [02:02&lt;02:10,  3.04it/s, v_num=z19b, train_loss_step=18Multinomial: 19.972198486328125, Poisson: -0.09542129933834076
Epoch 0:  49%|▍| 373/769 [02:02&lt;02:10,  3.04it/s, v_num=z19b, train_loss_step=19Multinomial: 20.61025047302246, Poisson: -0.09822966158390045
Epoch 0:  49%|▍| 374/769 [02:02&lt;02:09,  3.04it/s, v_num=z19b, train_loss_step=20Multinomial: 17.202051162719727, Poisson: -0.08097058534622192
Epoch 0:  49%|▍| 375/769 [02:03&lt;02:09,  3.04it/s, v_num=z19b, train_loss_step=17Multinomial: 24.03274154663086, Poisson: -0.11548560857772827
Epoch 0:  49%|▍| 376/769 [02:03&lt;02:09,  3.04it/s, v_num=z19b, train_loss_step=23Multinomial: 18.266056060791016, Poisson: -0.08680309355258942
Epoch 0:  49%|▍| 377/769 [02:03&lt;02:08,  3.04it/s, v_num=z19b, train_loss_step=18Multinomial: 25.16213035583496, Poisson: -0.12117968499660492
Epoch 0:  49%|▍| 378/769 [02:04&lt;02:08,  3.04it/s, v_num=z19b, train_loss_step=25Multinomial: 21.121871948242188, Poisson: -0.10119801014661789
Epoch 0:  49%|▍| 379/769 [02:04&lt;02:08,  3.04it/s, v_num=z19b, train_loss_step=21Multinomial: 18.868982315063477, Poisson: -0.08967303484678268
Epoch 0:  49%|▍| 380/769 [02:04&lt;02:07,  3.04it/s, v_num=z19b, train_loss_step=18Multinomial: 21.72386932373047, Poisson: -0.10405871272087097
Epoch 0:  50%|▍| 381/769 [02:05&lt;02:07,  3.04it/s, v_num=z19b, train_loss_step=21Multinomial: 22.30774688720703, Poisson: -0.10705208778381348
Epoch 0:  50%|▍| 382/769 [02:05&lt;02:07,  3.04it/s, v_num=z19b, train_loss_step=22Multinomial: 20.042383193969727, Poisson: -0.09549868851900101
Epoch 0:  50%|▍| 383/769 [02:05&lt;02:06,  3.05it/s, v_num=z19b, train_loss_step=19Multinomial: 21.162233352661133, Poisson: -0.10121472924947739
Epoch 0:  50%|▍| 384/769 [02:06&lt;02:06,  3.05it/s, v_num=z19b, train_loss_step=21Multinomial: 22.29056739807129, Poisson: -0.10680481046438217
Epoch 0:  50%|▌| 385/769 [02:06&lt;02:06,  3.05it/s, v_num=z19b, train_loss_step=22Multinomial: 18.900314331054688, Poisson: -0.08970145136117935
Epoch 0:  50%|▌| 386/769 [02:06&lt;02:05,  3.05it/s, v_num=z19b, train_loss_step=18Multinomial: 20.563663482666016, Poisson: -0.09824714809656143
Epoch 0:  50%|▌| 387/769 [02:07&lt;02:05,  3.05it/s, v_num=z19b, train_loss_step=20Multinomial: 21.132850646972656, Poisson: -0.10112874954938889
Epoch 0:  50%|▌| 388/769 [02:07&lt;02:05,  3.05it/s, v_num=z19b, train_loss_step=21Multinomial: 21.144922256469727, Poisson: -0.10119117051362991
Epoch 0:  51%|▌| 389/769 [02:07&lt;02:04,  3.05it/s, v_num=z19b, train_loss_step=21Multinomial: 21.151832580566406, Poisson: -0.10129769146442413
Epoch 0:  51%|▌| 390/769 [02:08&lt;02:04,  3.05it/s, v_num=z19b, train_loss_step=21Multinomial: 22.872568130493164, Poisson: -0.10988931357860565
Epoch 0:  51%|▌| 391/769 [02:08&lt;02:04,  3.05it/s, v_num=z19b, train_loss_step=22Multinomial: 21.129695892333984, Poisson: -0.10116168856620789
Epoch 0:  51%|▌| 392/769 [02:08&lt;02:03,  3.05it/s, v_num=z19b, train_loss_step=21Multinomial: 18.857769012451172, Poisson: -0.08968871831893921
Epoch 0:  51%|▌| 393/769 [02:08&lt;02:03,  3.05it/s, v_num=z19b, train_loss_step=18Multinomial: 17.15715217590332, Poisson: -0.08107663691043854
Epoch 0:  51%|▌| 394/769 [02:09&lt;02:03,  3.05it/s, v_num=z19b, train_loss_step=17Multinomial: 20.02786636352539, Poisson: -0.09557494521141052
Epoch 0:  51%|▌| 395/769 [02:09&lt;02:02,  3.05it/s, v_num=z19b, train_loss_step=19Multinomial: 22.35116958618164, Poisson: -0.1069263145327568
Epoch 0:  51%|▌| 396/769 [02:09&lt;02:02,  3.05it/s, v_num=z19b, train_loss_step=22Multinomial: 20.550174713134766, Poisson: -0.09826073050498962
Epoch 0:  52%|▌| 397/769 [02:10&lt;02:02,  3.05it/s, v_num=z19b, train_loss_step=20Multinomial: 21.74297332763672, Poisson: -0.10406376421451569
Epoch 0:  52%|▌| 398/769 [02:10&lt;02:01,  3.05it/s, v_num=z19b, train_loss_step=21Multinomial: 21.18010711669922, Poisson: -0.10119213908910751
Epoch 0:  52%|▌| 399/769 [02:10&lt;02:01,  3.05it/s, v_num=z19b, train_loss_step=21Multinomial: 19.992353439331055, Poisson: -0.09547951072454453
Epoch 0:  52%|▌| 400/769 [02:11&lt;02:01,  3.05it/s, v_num=z19b, train_loss_step=19Multinomial: 22.28050994873047, Poisson: -0.10701890289783478
Epoch 0:  52%|▌| 401/769 [02:11&lt;02:00,  3.05it/s, v_num=z19b, train_loss_step=22Multinomial: 22.306230545043945, Poisson: -0.10692887753248215
Epoch 0:  52%|▌| 402/769 [02:11&lt;02:00,  3.05it/s, v_num=z19b, train_loss_step=22Multinomial: 19.405029296875, Poisson: -0.09261028468608856
Epoch 0:  52%|▌| 403/769 [02:12&lt;02:00,  3.05it/s, v_num=z19b, train_loss_step=19Multinomial: 22.298885345458984, Poisson: -0.10688753426074982
Epoch 0:  53%|▌| 404/769 [02:12&lt;01:59,  3.05it/s, v_num=z19b, train_loss_step=22Multinomial: 21.738388061523438, Poisson: -0.10397956520318985
Epoch 0:  53%|▌| 405/769 [02:12&lt;01:59,  3.05it/s, v_num=z19b, train_loss_step=21Multinomial: 21.1234073638916, Poisson: -0.10107678920030594
Epoch 0:  53%|▌| 406/769 [02:13&lt;01:59,  3.05it/s, v_num=z19b, train_loss_step=21Multinomial: 23.44831085205078, Poisson: -0.1126079335808754
Epoch 0:  53%|▌| 407/769 [02:13&lt;01:58,  3.05it/s, v_num=z19b, train_loss_step=23Multinomial: 20.54623031616211, Poisson: -0.09838448464870453
Epoch 0:  53%|▌| 408/769 [02:13&lt;01:58,  3.05it/s, v_num=z19b, train_loss_step=20Multinomial: 17.72144317626953, Poisson: -0.08405870199203491
Epoch 0:  53%|▌| 409/769 [02:14&lt;01:58,  3.05it/s, v_num=z19b, train_loss_step=17Multinomial: 22.90953254699707, Poisson: -0.1097845584154129
Epoch 0:  53%|▌| 410/769 [02:14&lt;01:57,  3.05it/s, v_num=z19b, train_loss_step=22Multinomial: 21.141109466552734, Poisson: -0.10122164338827133
Epoch 0:  53%|▌| 411/769 [02:14&lt;01:57,  3.05it/s, v_num=z19b, train_loss_step=21Multinomial: 22.85947608947754, Poisson: -0.10981594026088715
Epoch 0:  54%|▌| 412/769 [02:15&lt;01:57,  3.05it/s, v_num=z19b, train_loss_step=22Multinomial: 19.4167423248291, Poisson: -0.09257546067237854
Epoch 0:  54%|▌| 413/769 [02:15&lt;01:56,  3.05it/s, v_num=z19b, train_loss_step=19Multinomial: 18.85237693786621, Poisson: -0.08975554257631302
Epoch 0:  54%|▌| 414/769 [02:15&lt;01:56,  3.05it/s, v_num=z19b, train_loss_step=18Multinomial: 22.290939331054688, Poisson: -0.10693459212779999
Epoch 0:  54%|▌| 415/769 [02:16&lt;01:56,  3.05it/s, v_num=z19b, train_loss_step=22Multinomial: 21.69593620300293, Poisson: -0.10401815176010132
Epoch 0:  54%|▌| 416/769 [02:16&lt;01:55,  3.05it/s, v_num=z19b, train_loss_step=21Multinomial: 20.5230655670166, Poisson: -0.09826165437698364
Epoch 0:  54%|▌| 417/769 [02:16&lt;01:55,  3.05it/s, v_num=z19b, train_loss_step=20Multinomial: 19.994953155517578, Poisson: -0.0954437255859375
Epoch 0:  54%|▌| 418/769 [02:16&lt;01:55,  3.05it/s, v_num=z19b, train_loss_step=19Multinomial: 18.281551361083984, Poisson: -0.08682246506214142
Epoch 0:  54%|▌| 419/769 [02:17&lt;01:54,  3.05it/s, v_num=z19b, train_loss_step=18Multinomial: 20.606672286987305, Poisson: -0.0983877032995224
Epoch 0:  55%|▌| 420/769 [02:17&lt;01:54,  3.05it/s, v_num=z19b, train_loss_step=20Multinomial: 21.74757957458496, Poisson: -0.10409627109766006
Epoch 0:  55%|▌| 421/769 [02:17&lt;01:54,  3.05it/s, v_num=z19b, train_loss_step=21Multinomial: 21.134349822998047, Poisson: -0.10127986967563629
Epoch 0:  55%|▌| 422/769 [02:18&lt;01:53,  3.05it/s, v_num=z19b, train_loss_step=21Multinomial: 23.427547454833984, Poisson: -0.11260510236024857
Epoch 0:  55%|▌| 423/769 [02:18&lt;01:53,  3.05it/s, v_num=z19b, train_loss_step=23Multinomial: 19.447601318359375, Poisson: -0.09243147820234299
Epoch 0:  55%|▌| 424/769 [02:18&lt;01:53,  3.05it/s, v_num=z19b, train_loss_step=19Multinomial: 22.294862747192383, Poisson: -0.10696534067392349
Epoch 0:  55%|▌| 425/769 [02:19&lt;01:52,  3.05it/s, v_num=z19b, train_loss_step=22Multinomial: 19.45545196533203, Poisson: -0.09260383993387222
Epoch 0:  55%|▌| 426/769 [02:19&lt;01:52,  3.05it/s, v_num=z19b, train_loss_step=19Multinomial: 19.992687225341797, Poisson: -0.09549260139465332
Epoch 0:  56%|▌| 427/769 [02:19&lt;01:52,  3.05it/s, v_num=z19b, train_loss_step=19Multinomial: 20.039113998413086, Poisson: -0.09544585645198822
Epoch 0:  56%|▌| 428/769 [02:20&lt;01:51,  3.05it/s, v_num=z19b, train_loss_step=19Multinomial: 22.3060302734375, Poisson: -0.1069411113858223
Epoch 0:  56%|▌| 429/769 [02:20&lt;01:51,  3.05it/s, v_num=z19b, train_loss_step=22Multinomial: 20.577733993530273, Poisson: -0.09826037287712097
Epoch 0:  56%|▌| 430/769 [02:20&lt;01:51,  3.05it/s, v_num=z19b, train_loss_step=20Multinomial: 20.03609848022461, Poisson: -0.0956130251288414
Epoch 0:  56%|▌| 431/769 [02:21&lt;01:50,  3.05it/s, v_num=z19b, train_loss_step=19Multinomial: 18.812009811401367, Poisson: -0.08974509686231613
Epoch 0:  56%|▌| 432/769 [02:21&lt;01:50,  3.05it/s, v_num=z19b, train_loss_step=18Multinomial: 19.989381790161133, Poisson: -0.09554054588079453
Epoch 0:  56%|▌| 433/769 [02:21&lt;01:50,  3.05it/s, v_num=z19b, train_loss_step=19Multinomial: 20.024858474731445, Poisson: -0.09546065330505371
Epoch 0:  56%|▌| 434/769 [02:22&lt;01:49,  3.05it/s, v_num=z19b, train_loss_step=19Multinomial: 22.850378036499023, Poisson: -0.10991330444812775
Epoch 0:  57%|▌| 435/769 [02:22&lt;01:49,  3.05it/s, v_num=z19b, train_loss_step=22Multinomial: 19.449222564697266, Poisson: -0.09257426857948303
Epoch 0:  57%|▌| 436/769 [02:22&lt;01:49,  3.05it/s, v_num=z19b, train_loss_step=19Multinomial: 21.141508102416992, Poisson: -0.10112118721008301
Epoch 0:  57%|▌| 437/769 [02:23&lt;01:48,  3.05it/s, v_num=z19b, train_loss_step=21Multinomial: 19.472986221313477, Poisson: -0.09257309883832932
Epoch 0:  57%|▌| 438/769 [02:23&lt;01:48,  3.06it/s, v_num=z19b, train_loss_step=19Multinomial: 20.593774795532227, Poisson: -0.09841854870319366
Epoch 0:  57%|▌| 439/769 [02:23&lt;01:48,  3.06it/s, v_num=z19b, train_loss_step=20Multinomial: 22.281505584716797, Poisson: -0.10708444565534592
Epoch 0:  57%|▌| 440/769 [02:24&lt;01:47,  3.06it/s, v_num=z19b, train_loss_step=22Multinomial: 17.72144889831543, Poisson: -0.08395814895629883
Epoch 0:  57%|▌| 441/769 [02:24&lt;01:47,  3.06it/s, v_num=z19b, train_loss_step=17Multinomial: 20.584930419921875, Poisson: -0.09826047718524933
Epoch 0:  57%|▌| 442/769 [02:24&lt;01:47,  3.06it/s, v_num=z19b, train_loss_step=20Multinomial: 22.847789764404297, Poisson: -0.10968780517578125
Epoch 0:  58%|▌| 443/769 [02:24&lt;01:46,  3.06it/s, v_num=z19b, train_loss_step=22Multinomial: 21.183073043823242, Poisson: -0.10133807361125946
Epoch 0:  58%|▌| 444/769 [02:25&lt;01:46,  3.06it/s, v_num=z19b, train_loss_step=21Multinomial: 19.39304542541504, Poisson: -0.09274572879076004
Epoch 0:  58%|▌| 445/769 [02:25&lt;01:46,  3.06it/s, v_num=z19b, train_loss_step=19Multinomial: 21.7062931060791, Poisson: -0.10411351919174194
Epoch 0:  58%|▌| 446/769 [02:25&lt;01:45,  3.06it/s, v_num=z19b, train_loss_step=21Multinomial: 21.16707992553711, Poisson: -0.10122532397508621
Epoch 0:  58%|▌| 447/769 [02:26&lt;01:45,  3.06it/s, v_num=z19b, train_loss_step=21Multinomial: 19.984882354736328, Poisson: -0.09533136337995529
Epoch 0:  58%|▌| 448/769 [02:26&lt;01:45,  3.06it/s, v_num=z19b, train_loss_step=19Multinomial: 19.45552635192871, Poisson: -0.09266727417707443
Epoch 0:  58%|▌| 449/769 [02:26&lt;01:44,  3.06it/s, v_num=z19b, train_loss_step=19Multinomial: 21.167476654052734, Poisson: -0.1012100875377655
Epoch 0:  59%|▌| 450/769 [02:27&lt;01:44,  3.06it/s, v_num=z19b, train_loss_step=21Multinomial: 21.76722526550293, Poisson: -0.10404802858829498
Epoch 0:  59%|▌| 451/769 [02:27&lt;01:44,  3.06it/s, v_num=z19b, train_loss_step=21Multinomial: 21.748626708984375, Poisson: -0.10400190204381943
Epoch 0:  59%|▌| 452/769 [02:27&lt;01:43,  3.06it/s, v_num=z19b, train_loss_step=21Multinomial: 20.028263092041016, Poisson: -0.0955420434474945
Epoch 0:  59%|▌| 453/769 [02:28&lt;01:43,  3.06it/s, v_num=z19b, train_loss_step=19Multinomial: 19.981447219848633, Poisson: -0.09552603214979172
Epoch 0:  59%|▌| 454/769 [02:28&lt;01:43,  3.06it/s, v_num=z19b, train_loss_step=19Multinomial: 22.26629638671875, Poisson: -0.10693562030792236
Epoch 0:  59%|▌| 455/769 [02:28&lt;01:42,  3.06it/s, v_num=z19b, train_loss_step=22Multinomial: 21.177001953125, Poisson: -0.1012217104434967
Epoch 0:  59%|▌| 456/769 [02:29&lt;01:42,  3.06it/s, v_num=z19b, train_loss_step=21Multinomial: 18.275976181030273, Poisson: -0.08697574585676193
Epoch 0:  59%|▌| 457/769 [02:29&lt;01:42,  3.06it/s, v_num=z19b, train_loss_step=18Multinomial: 20.620586395263672, Poisson: -0.09833398461341858
Epoch 0:  60%|▌| 458/769 [02:29&lt;01:41,  3.06it/s, v_num=z19b, train_loss_step=20Multinomial: 19.466489791870117, Poisson: -0.09255097061395645
Epoch 0:  60%|▌| 459/769 [02:30&lt;01:41,  3.06it/s, v_num=z19b, train_loss_step=19Multinomial: 19.449247360229492, Poisson: -0.09258131682872772
Epoch 0:  60%|▌| 460/769 [02:30&lt;01:41,  3.06it/s, v_num=z19b, train_loss_step=19Multinomial: 20.586759567260742, Poisson: -0.09834271669387817
Epoch 0:  60%|▌| 461/769 [02:30&lt;01:40,  3.06it/s, v_num=z19b, train_loss_step=20Multinomial: 23.993785858154297, Poisson: -0.11555009335279465
Epoch 0:  60%|▌| 462/769 [02:31&lt;01:40,  3.06it/s, v_num=z19b, train_loss_step=23Multinomial: 24.01521110534668, Poisson: -0.11550003290176392
Epoch 0:  60%|▌| 463/769 [02:31&lt;01:40,  3.06it/s, v_num=z19b, train_loss_step=23Multinomial: 20.53887176513672, Poisson: -0.0983649268746376
Epoch 0:  60%|▌| 464/769 [02:31&lt;01:39,  3.06it/s, v_num=z19b, train_loss_step=20Multinomial: 18.291555404663086, Poisson: -0.08690781891345978
Epoch 0:  60%|▌| 465/769 [02:32&lt;01:39,  3.06it/s, v_num=z19b, train_loss_step=18Multinomial: 22.282379150390625, Poisson: -0.10695898532867432
Epoch 0:  61%|▌| 466/769 [02:32&lt;01:39,  3.06it/s, v_num=z19b, train_loss_step=22Multinomial: 20.581172943115234, Poisson: -0.09831105917692184
Epoch 0:  61%|▌| 467/769 [02:32&lt;01:38,  3.06it/s, v_num=z19b, train_loss_step=20Multinomial: 18.351953506469727, Poisson: -0.08691845834255219
Epoch 0:  61%|▌| 468/769 [02:32&lt;01:38,  3.06it/s, v_num=z19b, train_loss_step=18Multinomial: 18.853750228881836, Poisson: -0.08968193829059601
Epoch 0:  61%|▌| 469/769 [02:33&lt;01:38,  3.06it/s, v_num=z19b, train_loss_step=18Multinomial: 22.872222900390625, Poisson: -0.10981976240873337
Epoch 0:  61%|▌| 470/769 [02:33&lt;01:37,  3.06it/s, v_num=z19b, train_loss_step=22Multinomial: 23.394882202148438, Poisson: -0.11270279437303543
Epoch 0:  61%|▌| 471/769 [02:33&lt;01:37,  3.06it/s, v_num=z19b, train_loss_step=23Multinomial: 21.158660888671875, Poisson: -0.10115791857242584
Epoch 0:  61%|▌| 472/769 [02:34&lt;01:37,  3.06it/s, v_num=z19b, train_loss_step=21Multinomial: 17.745555877685547, Poisson: -0.08394715189933777
Epoch 0:  62%|▌| 473/769 [02:34&lt;01:36,  3.06it/s, v_num=z19b, train_loss_step=17Multinomial: 20.566381454467773, Poisson: -0.09833645075559616
Epoch 0:  62%|▌| 474/769 [02:34&lt;01:36,  3.06it/s, v_num=z19b, train_loss_step=20Multinomial: 19.425514221191406, Poisson: -0.09253065288066864
Epoch 0:  62%|▌| 475/769 [02:35&lt;01:36,  3.06it/s, v_num=z19b, train_loss_step=19Multinomial: 20.59552001953125, Poisson: -0.09839901328086853
Epoch 0:  62%|▌| 476/769 [02:35&lt;01:35,  3.06it/s, v_num=z19b, train_loss_step=20Multinomial: 19.96660041809082, Poisson: -0.09541700035333633
Epoch 0:  62%|▌| 477/769 [02:35&lt;01:35,  3.06it/s, v_num=z19b, train_loss_step=19Multinomial: 19.43105125427246, Poisson: -0.0924975797533989
Epoch 0:  62%|▌| 478/769 [02:36&lt;01:35,  3.06it/s, v_num=z19b, train_loss_step=19Multinomial: 20.59663200378418, Poisson: -0.09840960800647736
Epoch 0:  62%|▌| 479/769 [02:36&lt;01:34,  3.06it/s, v_num=z19b, train_loss_step=20Multinomial: 23.43426513671875, Poisson: -0.11256527900695801
Epoch 0:  62%|▌| 480/769 [02:36&lt;01:34,  3.06it/s, v_num=z19b, train_loss_step=23Multinomial: 21.14272689819336, Poisson: -0.10122092813253403
Epoch 0:  63%|▋| 481/769 [02:37&lt;01:34,  3.06it/s, v_num=z19b, train_loss_step=21Multinomial: 23.459579467773438, Poisson: -0.11273562908172607
Epoch 0:  63%|▋| 482/769 [02:37&lt;01:33,  3.06it/s, v_num=z19b, train_loss_step=23Multinomial: 21.736858367919922, Poisson: -0.10418049991130829
Epoch 0:  63%|▋| 483/769 [02:37&lt;01:33,  3.06it/s, v_num=z19b, train_loss_step=21Multinomial: 22.876211166381836, Poisson: -0.10971406102180481
Epoch 0:  63%|▋| 484/769 [02:38&lt;01:33,  3.06it/s, v_num=z19b, train_loss_step=22Multinomial: 20.02716636657715, Poisson: -0.09536830335855484
Epoch 0:  63%|▋| 485/769 [02:38&lt;01:32,  3.06it/s, v_num=z19b, train_loss_step=19Multinomial: 22.284330368041992, Poisson: -0.1069544181227684
Epoch 0:  63%|▋| 486/769 [02:38&lt;01:32,  3.06it/s, v_num=z19b, train_loss_step=22Multinomial: 22.313539505004883, Poisson: -0.10698555409908295
Epoch 0:  63%|▋| 487/769 [02:39&lt;01:32,  3.06it/s, v_num=z19b, train_loss_step=22Multinomial: 25.141313552856445, Poisson: -0.12139897048473358
Epoch 0:  63%|▋| 488/769 [02:39&lt;01:31,  3.06it/s, v_num=z19b, train_loss_step=25Multinomial: 19.967023849487305, Poisson: -0.09556806087493896
Epoch 0:  64%|▋| 489/769 [02:39&lt;01:31,  3.06it/s, v_num=z19b, train_loss_step=19Multinomial: 22.80702018737793, Poisson: -0.1098238006234169
Epoch 0:  64%|▋| 490/769 [02:40&lt;01:31,  3.06it/s, v_num=z19b, train_loss_step=22Multinomial: 22.245092391967773, Poisson: -0.10708247125148773
Epoch 0:  64%|▋| 491/769 [02:40&lt;01:30,  3.06it/s, v_num=z19b, train_loss_step=22Multinomial: 23.44270896911621, Poisson: -0.11285785585641861
Epoch 0:  64%|▋| 492/769 [02:40&lt;01:30,  3.06it/s, v_num=z19b, train_loss_step=23Multinomial: 24.004236221313477, Poisson: -0.11554396897554398
Epoch 0:  64%|▋| 493/769 [02:40&lt;01:30,  3.06it/s, v_num=z19b, train_loss_step=23Multinomial: 18.835250854492188, Poisson: -0.08968442678451538
Epoch 0:  64%|▋| 494/769 [02:41&lt;01:29,  3.06it/s, v_num=z19b, train_loss_step=18Multinomial: 20.06297492980957, Poisson: -0.095563605427742
Epoch 0:  64%|▋| 495/769 [02:41&lt;01:29,  3.06it/s, v_num=z19b, train_loss_step=20Multinomial: 21.17820930480957, Poisson: -0.10130878537893295
Epoch 0:  64%|▋| 496/769 [02:41&lt;01:29,  3.06it/s, v_num=z19b, train_loss_step=21Multinomial: 19.44117546081543, Poisson: -0.09261509776115417
Epoch 0:  65%|▋| 497/769 [02:42&lt;01:28,  3.06it/s, v_num=z19b, train_loss_step=19Multinomial: 21.694774627685547, Poisson: -0.10406653583049774
Epoch 0:  65%|▋| 498/769 [02:42&lt;01:28,  3.06it/s, v_num=z19b, train_loss_step=21Multinomial: 20.58062744140625, Poisson: -0.09833752363920212
Epoch 0:  65%|▋| 499/769 [02:42&lt;01:28,  3.06it/s, v_num=z19b, train_loss_step=20Multinomial: 19.441221237182617, Poisson: -0.0926542729139328
Epoch 0:  65%|▋| 500/769 [02:43&lt;01:27,  3.06it/s, v_num=z19b, train_loss_step=19Multinomial: 20.606691360473633, Poisson: -0.09840457886457443
Epoch 0:  65%|▋| 501/769 [02:43&lt;01:27,  3.06it/s, v_num=z19b, train_loss_step=20Multinomial: 22.300853729248047, Poisson: -0.10699529945850372
Epoch 0:  65%|▋| 502/769 [02:43&lt;01:27,  3.06it/s, v_num=z19b, train_loss_step=22Multinomial: 18.28227424621582, Poisson: -0.0869288221001625
Epoch 0:  65%|▋| 503/769 [02:44&lt;01:26,  3.06it/s, v_num=z19b, train_loss_step=18Multinomial: 21.702186584472656, Poisson: -0.10413043200969696
Epoch 0:  66%|▋| 504/769 [02:44&lt;01:26,  3.06it/s, v_num=z19b, train_loss_step=21Multinomial: 21.74034881591797, Poisson: -0.10404910892248154
Epoch 0:  66%|▋| 505/769 [02:44&lt;01:26,  3.06it/s, v_num=z19b, train_loss_step=21Multinomial: 20.035165786743164, Poisson: -0.09552566707134247
Epoch 0:  66%|▋| 506/769 [02:45&lt;01:25,  3.06it/s, v_num=z19b, train_loss_step=19Multinomial: 21.696123123168945, Poisson: -0.10408509522676468
Epoch 0:  66%|▋| 507/769 [02:45&lt;01:25,  3.06it/s, v_num=z19b, train_loss_step=21Multinomial: 17.70534324645996, Poisson: -0.08407223969697952
Epoch 0:  66%|▋| 508/769 [02:45&lt;01:25,  3.06it/s, v_num=z19b, train_loss_step=17Multinomial: 19.453535079956055, Poisson: -0.0927366316318512
Epoch 0:  66%|▋| 509/769 [02:46&lt;01:24,  3.06it/s, v_num=z19b, train_loss_step=19Multinomial: 16.5689640045166, Poisson: -0.07821458578109741
Epoch 0:  66%|▋| 510/769 [02:46&lt;01:24,  3.06it/s, v_num=z19b, train_loss_step=16Multinomial: 18.86258316040039, Poisson: -0.08975151926279068
Epoch 0:  66%|▋| 511/769 [02:46&lt;01:24,  3.06it/s, v_num=z19b, train_loss_step=18Multinomial: 19.99462127685547, Poisson: -0.09555225074291229
Epoch 0:  67%|▋| 512/769 [02:47&lt;01:23,  3.07it/s, v_num=z19b, train_loss_step=19Multinomial: 21.720829010009766, Poisson: -0.1041238009929657
Epoch 0:  67%|▋| 513/769 [02:47&lt;01:23,  3.07it/s, v_num=z19b, train_loss_step=21Multinomial: 22.301584243774414, Poisson: -0.10712530463933945
Epoch 0:  67%|▋| 514/769 [02:47&lt;01:23,  3.07it/s, v_num=z19b, train_loss_step=22Multinomial: 21.745264053344727, Poisson: -0.1041649878025055
Epoch 0:  67%|▋| 515/769 [02:48&lt;01:22,  3.07it/s, v_num=z19b, train_loss_step=21Multinomial: 18.23343276977539, Poisson: -0.0867789015173912
Epoch 0:  67%|▋| 516/769 [02:48&lt;01:22,  3.07it/s, v_num=z19b, train_loss_step=18Multinomial: 21.160463333129883, Poisson: -0.10131219774484634
Epoch 0:  67%|▋| 517/769 [02:48&lt;01:22,  3.07it/s, v_num=z19b, train_loss_step=21Multinomial: 21.71718978881836, Poisson: -0.1041242927312851
Epoch 0:  67%|▋| 518/769 [02:48&lt;01:21,  3.07it/s, v_num=z19b, train_loss_step=21Multinomial: 22.282245635986328, Poisson: -0.10712146013975143
Epoch 0:  67%|▋| 519/769 [02:49&lt;01:21,  3.07it/s, v_num=z19b, train_loss_step=22Multinomial: 22.277494430541992, Poisson: -0.10695304721593857
Epoch 0:  68%|▋| 520/769 [02:49&lt;01:21,  3.07it/s, v_num=z19b, train_loss_step=22Multinomial: 19.438446044921875, Poisson: -0.09265900403261185
Epoch 0:  68%|▋| 521/769 [02:49&lt;01:20,  3.07it/s, v_num=z19b, train_loss_step=19Multinomial: 20.571475982666016, Poisson: -0.09844159334897995
Epoch 0:  68%|▋| 522/769 [02:50&lt;01:20,  3.07it/s, v_num=z19b, train_loss_step=20Multinomial: 19.405685424804688, Poisson: -0.0926026999950409
Epoch 0:  68%|▋| 523/769 [02:50&lt;01:20,  3.07it/s, v_num=z19b, train_loss_step=19Multinomial: 20.593942642211914, Poisson: -0.09854814410209656
Epoch 0:  68%|▋| 524/769 [02:50&lt;01:19,  3.07it/s, v_num=z19b, train_loss_step=20Multinomial: 19.970191955566406, Poisson: -0.09550374001264572
Epoch 0:  68%|▋| 525/769 [02:51&lt;01:19,  3.07it/s, v_num=z19b, train_loss_step=19Multinomial: 22.83405303955078, Poisson: -0.10981062054634094
Epoch 0:  68%|▋| 526/769 [02:51&lt;01:19,  3.07it/s, v_num=z19b, train_loss_step=22Multinomial: 22.3018741607666, Poisson: -0.10714289546012878
Epoch 0:  69%|▋| 527/769 [02:51&lt;01:18,  3.07it/s, v_num=z19b, train_loss_step=22Multinomial: 22.317535400390625, Poisson: -0.1071731299161911
Epoch 0:  69%|▋| 528/769 [02:52&lt;01:18,  3.07it/s, v_num=z19b, train_loss_step=22Multinomial: 19.44703483581543, Poisson: -0.09255566447973251
Epoch 0:  69%|▋| 529/769 [02:52&lt;01:18,  3.07it/s, v_num=z19b, train_loss_step=19Multinomial: 22.87607192993164, Poisson: -0.1098003163933754
Epoch 0:  69%|▋| 530/769 [02:52&lt;01:17,  3.07it/s, v_num=z19b, train_loss_step=22Multinomial: 21.6959171295166, Poisson: -0.10424990952014923
Epoch 0:  69%|▋| 531/769 [02:53&lt;01:17,  3.07it/s, v_num=z19b, train_loss_step=21Multinomial: 19.991872787475586, Poisson: -0.09553024172782898
Epoch 0:  69%|▋| 532/769 [02:53&lt;01:17,  3.07it/s, v_num=z19b, train_loss_step=19Multinomial: 21.155818939208984, Poisson: -0.10132080316543579
Epoch 0:  69%|▋| 533/769 [02:53&lt;01:16,  3.07it/s, v_num=z19b, train_loss_step=21Multinomial: 20.60390281677246, Poisson: -0.09838457405567169
Epoch 0:  69%|▋| 534/769 [02:54&lt;01:16,  3.07it/s, v_num=z19b, train_loss_step=20Multinomial: 17.15631103515625, Poisson: -0.08107607066631317
Epoch 0:  70%|▋| 535/769 [02:54&lt;01:16,  3.07it/s, v_num=z19b, train_loss_step=17Multinomial: 23.993087768554688, Poisson: -0.1156451478600502
Epoch 0:  70%|▋| 536/769 [02:54&lt;01:15,  3.07it/s, v_num=z19b, train_loss_step=23Multinomial: 19.44887351989746, Poisson: -0.09265285730361938
Epoch 0:  70%|▋| 537/769 [02:55&lt;01:15,  3.07it/s, v_num=z19b, train_loss_step=19Multinomial: 23.462255477905273, Poisson: -0.11292140930891037
Epoch 0:  70%|▋| 538/769 [02:55&lt;01:15,  3.07it/s, v_num=z19b, train_loss_step=23Multinomial: 22.287948608398438, Poisson: -0.10705216974020004
Epoch 0:  70%|▋| 539/769 [02:55&lt;01:14,  3.07it/s, v_num=z19b, train_loss_step=22Multinomial: 20.014545440673828, Poisson: -0.09541700035333633
Epoch 0:  70%|▋| 540/769 [02:56&lt;01:14,  3.07it/s, v_num=z19b, train_loss_step=19Multinomial: 21.71851921081543, Poisson: -0.10418517887592316
Epoch 0:  70%|▋| 541/769 [02:56&lt;01:14,  3.07it/s, v_num=z19b, train_loss_step=21Multinomial: 22.281532287597656, Poisson: -0.10701782256364822
Epoch 0:  70%|▋| 542/769 [02:56&lt;01:13,  3.07it/s, v_num=z19b, train_loss_step=22Multinomial: 20.580219268798828, Poisson: -0.09845548868179321
Epoch 0:  71%|▋| 543/769 [02:56&lt;01:13,  3.07it/s, v_num=z19b, train_loss_step=20Multinomial: 19.501911163330078, Poisson: -0.09280682355165482
Epoch 0:  71%|▋| 544/769 [02:57&lt;01:13,  3.07it/s, v_num=z19b, train_loss_step=19Multinomial: 19.409358978271484, Poisson: -0.0926060825586319
Epoch 0:  71%|▋| 545/769 [02:57&lt;01:13,  3.07it/s, v_num=z19b, train_loss_step=19Multinomial: 22.292776107788086, Poisson: -0.10721638798713684
Epoch 0:  71%|▋| 546/769 [02:57&lt;01:12,  3.07it/s, v_num=z19b, train_loss_step=22Multinomial: 18.899192810058594, Poisson: -0.08987358957529068
Epoch 0:  71%|▋| 547/769 [02:58&lt;01:12,  3.07it/s, v_num=z19b, train_loss_step=18Multinomial: 23.456850051879883, Poisson: -0.11287020146846771
Epoch 0:  71%|▋| 548/769 [02:58&lt;01:12,  3.07it/s, v_num=z19b, train_loss_step=23Multinomial: 20.561748504638672, Poisson: -0.09836052358150482
Epoch 0:  71%|▋| 549/769 [02:58&lt;01:11,  3.07it/s, v_num=z19b, train_loss_step=20Multinomial: 22.82124900817871, Poisson: -0.10990892350673676
Epoch 0:  72%|▋| 550/769 [02:59&lt;01:11,  3.07it/s, v_num=z19b, train_loss_step=22Multinomial: 23.407617568969727, Poisson: -0.11288544535636902
Epoch 0:  72%|▋| 551/769 [02:59&lt;01:11,  3.07it/s, v_num=z19b, train_loss_step=23Multinomial: 24.031747817993164, Poisson: -0.11567199230194092
Epoch 0:  72%|▋| 552/769 [02:59&lt;01:10,  3.07it/s, v_num=z19b, train_loss_step=23Multinomial: 23.447145462036133, Poisson: -0.11285616457462311
Epoch 0:  72%|▋| 553/769 [03:00&lt;01:10,  3.07it/s, v_num=z19b, train_loss_step=23Multinomial: 25.169246673583984, Poisson: -0.12141065299510956
Epoch 0:  72%|▋| 554/769 [03:00&lt;01:10,  3.07it/s, v_num=z19b, train_loss_step=25Multinomial: 22.35482406616211, Poisson: -0.10716186463832855
Epoch 0:  72%|▋| 555/769 [03:00&lt;01:09,  3.07it/s, v_num=z19b, train_loss_step=22Multinomial: 24.58588409423828, Poisson: -0.1186496689915657
Epoch 0:  72%|▋| 556/769 [03:01&lt;01:09,  3.07it/s, v_num=z19b, train_loss_step=24Multinomial: 20.01604652404785, Poisson: -0.09556514769792557
Epoch 0:  72%|▋| 557/769 [03:01&lt;01:09,  3.07it/s, v_num=z19b, train_loss_step=19Multinomial: 20.556522369384766, Poisson: -0.0983574166893959
Epoch 0:  73%|▋| 558/769 [03:01&lt;01:08,  3.07it/s, v_num=z19b, train_loss_step=20Multinomial: 17.646484375, Poisson: -0.08410317450761795
Epoch 0:  73%|▋| 559/769 [03:02&lt;01:08,  3.07it/s, v_num=z19b, train_loss_step=17Multinomial: 22.25897979736328, Poisson: -0.10707166790962219
Epoch 0:  73%|▋| 560/769 [03:02&lt;01:08,  3.07it/s, v_num=z19b, train_loss_step=22Multinomial: 17.18939208984375, Poisson: -0.08129438012838364
Epoch 0:  73%|▋| 561/769 [03:02&lt;01:07,  3.07it/s, v_num=z19b, train_loss_step=17Multinomial: 21.124881744384766, Poisson: -0.10124237090349197
Epoch 0:  73%|▋| 562/769 [03:03&lt;01:07,  3.07it/s, v_num=z19b, train_loss_step=21Multinomial: 19.399078369140625, Poisson: -0.09268681704998016
Epoch 0:  73%|▋| 563/769 [03:03&lt;01:07,  3.07it/s, v_num=z19b, train_loss_step=19Multinomial: 21.693737030029297, Poisson: -0.1041342169046402
Epoch 0:  73%|▋| 564/769 [03:03&lt;01:06,  3.07it/s, v_num=z19b, train_loss_step=21Multinomial: 17.120168685913086, Poisson: -0.08110415935516357
Epoch 0:  73%|▋| 565/769 [03:04&lt;01:06,  3.07it/s, v_num=z19b, train_loss_step=17Multinomial: 21.748239517211914, Poisson: -0.10417310893535614
Epoch 0:  74%|▋| 566/769 [03:04&lt;01:06,  3.07it/s, v_num=z19b, train_loss_step=21Multinomial: 18.28362274169922, Poisson: -0.08687271177768707
Epoch 0:  74%|▋| 567/769 [03:04&lt;01:05,  3.07it/s, v_num=z19b, train_loss_step=18Multinomial: 21.750804901123047, Poisson: -0.10411364585161209
Epoch 0:  74%|▋| 568/769 [03:05&lt;01:05,  3.07it/s, v_num=z19b, train_loss_step=21Multinomial: 22.33074378967285, Poisson: -0.10716699808835983
Epoch 0:  74%|▋| 569/769 [03:05&lt;01:05,  3.07it/s, v_num=z19b, train_loss_step=22Multinomial: 18.870704650878906, Poisson: -0.08979831635951996
Epoch 0:  74%|▋| 570/769 [03:05&lt;01:04,  3.07it/s, v_num=z19b, train_loss_step=18Multinomial: 21.149822235107422, Poisson: -0.10131312906742096
Epoch 0:  74%|▋| 571/769 [03:06&lt;01:04,  3.07it/s, v_num=z19b, train_loss_step=21Multinomial: 22.801998138427734, Poisson: -0.11017092317342758
Epoch 0:  74%|▋| 572/769 [03:06&lt;01:04,  3.07it/s, v_num=z19b, train_loss_step=22Multinomial: 19.39589500427246, Poisson: -0.09280373156070709
Epoch 0:  75%|▋| 573/769 [03:06&lt;01:03,  3.07it/s, v_num=z19b, train_loss_step=19Multinomial: 20.657445907592773, Poisson: -0.09855939447879791
Epoch 0:  75%|▋| 574/769 [03:06&lt;01:03,  3.07it/s, v_num=z19b, train_loss_step=20Multinomial: 20.012121200561523, Poisson: -0.09561740607023239
Epoch 0:  75%|▋| 575/769 [03:07&lt;01:03,  3.07it/s, v_num=z19b, train_loss_step=19Multinomial: 22.896121978759766, Poisson: -0.10994120687246323
Epoch 0:  75%|▋| 576/769 [03:07&lt;01:02,  3.07it/s, v_num=z19b, train_loss_step=22Multinomial: 17.727685928344727, Poisson: -0.084184929728508
Epoch 0:  75%|▊| 577/769 [03:07&lt;01:02,  3.07it/s, v_num=z19b, train_loss_step=17Multinomial: 23.979598999023438, Poisson: -0.11566992104053497
Epoch 0:  75%|▊| 578/769 [03:08&lt;01:02,  3.07it/s, v_num=z19b, train_loss_step=23Multinomial: 21.132762908935547, Poisson: -0.10119503736495972
Epoch 0:  75%|▊| 579/769 [03:08&lt;01:01,  3.07it/s, v_num=z19b, train_loss_step=21Multinomial: 17.134675979614258, Poisson: -0.08113493025302887
Epoch 0:  75%|▊| 580/769 [03:08&lt;01:01,  3.07it/s, v_num=z19b, train_loss_step=17Multinomial: 20.055280685424805, Poisson: -0.09552625566720963
Epoch 0:  76%|▊| 581/769 [03:09&lt;01:01,  3.07it/s, v_num=z19b, train_loss_step=20Multinomial: 21.142547607421875, Poisson: -0.10130945593118668
Epoch 0:  76%|▊| 582/769 [03:09&lt;01:00,  3.07it/s, v_num=z19b, train_loss_step=21Multinomial: 16.573896408081055, Poisson: -0.07830072194337845
Epoch 0:  76%|▊| 583/769 [03:09&lt;01:00,  3.07it/s, v_num=z19b, train_loss_step=16Multinomial: 17.07198143005371, Poisson: -0.08129972964525223
Epoch 0:  76%|▊| 584/769 [03:10&lt;01:00,  3.07it/s, v_num=z19b, train_loss_step=17Multinomial: 21.178251266479492, Poisson: -0.10136278718709946
Epoch 0:  76%|▊| 585/769 [03:10&lt;00:59,  3.07it/s, v_num=z19b, train_loss_step=21Multinomial: 21.099037170410156, Poisson: -0.10127761214971542
Epoch 0:  76%|▊| 586/769 [03:10&lt;00:59,  3.07it/s, v_num=z19b, train_loss_step=21Multinomial: 21.136049270629883, Poisson: -0.10129142552614212
Epoch 0:  76%|▊| 587/769 [03:11&lt;00:59,  3.07it/s, v_num=z19b, train_loss_step=21Multinomial: 20.033672332763672, Poisson: -0.0956379622220993
Epoch 0:  76%|▊| 588/769 [03:11&lt;00:58,  3.07it/s, v_num=z19b, train_loss_step=19Multinomial: 17.155176162719727, Poisson: -0.0813455730676651
Epoch 0:  77%|▊| 589/769 [03:11&lt;00:58,  3.07it/s, v_num=z19b, train_loss_step=17Multinomial: 22.28957176208496, Poisson: -0.10728272795677185
Epoch 0:  77%|▊| 590/769 [03:12&lt;00:58,  3.07it/s, v_num=z19b, train_loss_step=22Multinomial: 21.193096160888672, Poisson: -0.10134200006723404
Epoch 0:  77%|▊| 591/769 [03:12&lt;00:57,  3.07it/s, v_num=z19b, train_loss_step=21Multinomial: 19.457393646240234, Poisson: -0.09269353747367859
Epoch 0:  77%|▊| 592/769 [03:12&lt;00:57,  3.07it/s, v_num=z19b, train_loss_step=19Multinomial: 22.877826690673828, Poisson: -0.11005447804927826
Epoch 0:  77%|▊| 593/769 [03:13&lt;00:57,  3.07it/s, v_num=z19b, train_loss_step=22Multinomial: 18.9215087890625, Poisson: -0.08985890448093414
Epoch 0:  77%|▊| 594/769 [03:13&lt;00:56,  3.07it/s, v_num=z19b, train_loss_step=18Multinomial: 20.573822021484375, Poisson: -0.09837344288825989
Epoch 0:  77%|▊| 595/769 [03:13&lt;00:56,  3.07it/s, v_num=z19b, train_loss_step=20Multinomial: 21.732667922973633, Poisson: -0.10429346561431885
Epoch 0:  78%|▊| 596/769 [03:14&lt;00:56,  3.07it/s, v_num=z19b, train_loss_step=21Multinomial: 21.18877410888672, Poisson: -0.10130768269300461
Epoch 0:  78%|▊| 597/769 [03:14&lt;00:56,  3.07it/s, v_num=z19b, train_loss_step=21Multinomial: 22.879512786865234, Poisson: -0.11006174981594086
Epoch 0:  78%|▊| 598/769 [03:14&lt;00:55,  3.07it/s, v_num=z19b, train_loss_step=22Multinomial: 20.04119300842285, Poisson: -0.09562227129936218
Epoch 0:  78%|▊| 599/769 [03:15&lt;00:55,  3.07it/s, v_num=z19b, train_loss_step=19Multinomial: 22.881103515625, Poisson: -0.10984674841165543
Epoch 0:  78%|▊| 600/769 [03:15&lt;00:55,  3.07it/s, v_num=z19b, train_loss_step=22Multinomial: 21.151630401611328, Poisson: -0.1015249639749527
Epoch 0:  78%|▊| 601/769 [03:15&lt;00:54,  3.07it/s, v_num=z19b, train_loss_step=21Multinomial: 24.029935836791992, Poisson: -0.11579369753599167
Epoch 0:  78%|▊| 602/769 [03:15&lt;00:54,  3.07it/s, v_num=z19b, train_loss_step=23Multinomial: 22.306337356567383, Poisson: -0.10711880773305893
Epoch 0:  78%|▊| 603/769 [03:16&lt;00:54,  3.07it/s, v_num=z19b, train_loss_step=22Multinomial: 19.467754364013672, Poisson: -0.09270559251308441
Epoch 0:  79%|▊| 604/769 [03:16&lt;00:53,  3.07it/s, v_num=z19b, train_loss_step=19Multinomial: 20.526901245117188, Poisson: -0.09845849126577377
Epoch 0:  79%|▊| 605/769 [03:16&lt;00:53,  3.07it/s, v_num=z19b, train_loss_step=20Multinomial: 22.326244354248047, Poisson: -0.10705878585577011
Epoch 0:  79%|▊| 606/769 [03:17&lt;00:53,  3.07it/s, v_num=z19b, train_loss_step=22Multinomial: 21.73848533630371, Poisson: -0.10427066683769226
Epoch 0:  79%|▊| 607/769 [03:17&lt;00:52,  3.07it/s, v_num=z19b, train_loss_step=21Multinomial: 25.167037963867188, Poisson: -0.12166716903448105
Epoch 0:  79%|▊| 608/769 [03:17&lt;00:52,  3.07it/s, v_num=z19b, train_loss_step=25Multinomial: 24.57440185546875, Poisson: -0.11880453675985336
Epoch 0:  79%|▊| 609/769 [03:18&lt;00:52,  3.07it/s, v_num=z19b, train_loss_step=24Multinomial: 22.29690933227539, Poisson: -0.10715951770544052
Epoch 0:  79%|▊| 610/769 [03:18&lt;00:51,  3.07it/s, v_num=z19b, train_loss_step=22Multinomial: 20.630191802978516, Poisson: -0.09839803725481033
Epoch 0:  79%|▊| 611/769 [03:18&lt;00:51,  3.07it/s, v_num=z19b, train_loss_step=20Multinomial: 20.055540084838867, Poisson: -0.0956123024225235
Epoch 0:  80%|▊| 612/769 [03:19&lt;00:51,  3.07it/s, v_num=z19b, train_loss_step=20Multinomial: 21.742748260498047, Poisson: -0.10434296727180481
Epoch 0:  80%|▊| 613/769 [03:19&lt;00:50,  3.07it/s, v_num=z19b, train_loss_step=21Multinomial: 19.44573211669922, Poisson: -0.09279239177703857
Epoch 0:  80%|▊| 614/769 [03:19&lt;00:50,  3.07it/s, v_num=z19b, train_loss_step=19Multinomial: 21.69890594482422, Poisson: -0.10426881909370422
Epoch 0:  80%|▊| 615/769 [03:20&lt;00:50,  3.07it/s, v_num=z19b, train_loss_step=21Multinomial: 20.589574813842773, Poisson: -0.09845529496669769
Epoch 0:  80%|▊| 616/769 [03:20&lt;00:49,  3.07it/s, v_num=z19b, train_loss_step=20Multinomial: 21.15414047241211, Poisson: -0.10137458145618439
Epoch 0:  80%|▊| 617/769 [03:20&lt;00:49,  3.07it/s, v_num=z19b, train_loss_step=21Multinomial: 18.898223876953125, Poisson: -0.08989422768354416
Epoch 0:  80%|▊| 618/769 [03:21&lt;00:49,  3.07it/s, v_num=z19b, train_loss_step=18Multinomial: 22.8887939453125, Poisson: -0.10998392105102539
Epoch 0:  80%|▊| 619/769 [03:21&lt;00:48,  3.07it/s, v_num=z19b, train_loss_step=22Multinomial: 18.90485382080078, Poisson: -0.08998798578977585
Epoch 0:  81%|▊| 620/769 [03:21&lt;00:48,  3.07it/s, v_num=z19b, train_loss_step=18Multinomial: 24.01581573486328, Poisson: -0.1157660111784935
Epoch 0:  81%|▊| 621/769 [03:22&lt;00:48,  3.07it/s, v_num=z19b, train_loss_step=23Multinomial: 18.849069595336914, Poisson: -0.08981824666261673
Epoch 0:  81%|▊| 622/769 [03:22&lt;00:47,  3.07it/s, v_num=z19b, train_loss_step=18Multinomial: 19.466964721679688, Poisson: -0.09279315918684006
Epoch 0:  81%|▊| 623/769 [03:22&lt;00:47,  3.07it/s, v_num=z19b, train_loss_step=19Multinomial: 22.276649475097656, Poisson: -0.10719521343708038
Epoch 0:  81%|▊| 624/769 [03:23&lt;00:47,  3.07it/s, v_num=z19b, train_loss_step=22Multinomial: 20.023122787475586, Poisson: -0.09553709626197815
Epoch 0:  81%|▊| 625/769 [03:23&lt;00:46,  3.07it/s, v_num=z19b, train_loss_step=19Multinomial: 22.83818817138672, Poisson: -0.11014588177204132
Epoch 0:  81%|▊| 626/769 [03:23&lt;00:46,  3.07it/s, v_num=z19b, train_loss_step=22Multinomial: 21.697412490844727, Poisson: -0.10430960357189178
Epoch 0:  82%|▊| 627/769 [03:23&lt;00:46,  3.07it/s, v_num=z19b, train_loss_step=21Multinomial: 18.33476448059082, Poisson: -0.08700516074895859
Epoch 0:  82%|▊| 628/769 [03:24&lt;00:45,  3.07it/s, v_num=z19b, train_loss_step=18Multinomial: 20.024553298950195, Poisson: -0.09558413177728653
Epoch 0:  82%|▊| 629/769 [03:24&lt;00:45,  3.07it/s, v_num=z19b, train_loss_step=19Multinomial: 23.40337371826172, Poisson: -0.11288289725780487
Epoch 0:  82%|▊| 630/769 [03:24&lt;00:45,  3.07it/s, v_num=z19b, train_loss_step=23Multinomial: 21.726459503173828, Poisson: -0.10433690249919891
Epoch 0:  82%|▊| 631/769 [03:25&lt;00:44,  3.07it/s, v_num=z19b, train_loss_step=21Multinomial: 16.554990768432617, Poisson: -0.07835713028907776
Epoch 0:  82%|▊| 632/769 [03:25&lt;00:44,  3.07it/s, v_num=z19b, train_loss_step=16Multinomial: 19.46163558959961, Poisson: -0.09273209422826767
Epoch 0:  82%|▊| 633/769 [03:25&lt;00:44,  3.07it/s, v_num=z19b, train_loss_step=19Multinomial: 19.987600326538086, Poisson: -0.09555350244045258
Epoch 0:  82%|▊| 634/769 [03:26&lt;00:43,  3.07it/s, v_num=z19b, train_loss_step=19Multinomial: 22.286272048950195, Poisson: -0.10719829052686691
Epoch 0:  83%|▊| 635/769 [03:26&lt;00:43,  3.07it/s, v_num=z19b, train_loss_step=22Multinomial: 19.437694549560547, Poisson: -0.09280513226985931
Epoch 0:  83%|▊| 636/769 [03:26&lt;00:43,  3.07it/s, v_num=z19b, train_loss_step=19Multinomial: 23.417890548706055, Poisson: -0.1128920391201973
Epoch 0:  83%|▊| 637/769 [03:27&lt;00:42,  3.07it/s, v_num=z19b, train_loss_step=23Multinomial: 19.44615364074707, Poisson: -0.09285621345043182
Epoch 0:  83%|▊| 638/769 [03:27&lt;00:42,  3.07it/s, v_num=z19b, train_loss_step=19Multinomial: 15.966632843017578, Poisson: -0.07551372051239014
Epoch 0:  83%|▊| 639/769 [03:27&lt;00:42,  3.07it/s, v_num=z19b, train_loss_step=15Multinomial: 18.87822151184082, Poisson: -0.09000957757234573
Epoch 0:  83%|▊| 640/769 [03:28&lt;00:41,  3.07it/s, v_num=z19b, train_loss_step=18Multinomial: 22.84714126586914, Poisson: -0.10998392105102539
Epoch 0:  83%|▊| 641/769 [03:28&lt;00:41,  3.07it/s, v_num=z19b, train_loss_step=22Multinomial: 22.281036376953125, Poisson: -0.10719318687915802
Epoch 0:  83%|▊| 642/769 [03:28&lt;00:41,  3.07it/s, v_num=z19b, train_loss_step=22Multinomial: 21.14943504333496, Poisson: -0.10145771503448486
Epoch 0:  84%|▊| 643/769 [03:29&lt;00:40,  3.07it/s, v_num=z19b, train_loss_step=21Multinomial: 18.871522903442383, Poisson: -0.08984455466270447
Epoch 0:  84%|▊| 644/769 [03:29&lt;00:40,  3.07it/s, v_num=z19b, train_loss_step=18Multinomial: 19.964296340942383, Poisson: -0.09561542421579361
Epoch 0:  84%|▊| 645/769 [03:29&lt;00:40,  3.07it/s, v_num=z19b, train_loss_step=19Multinomial: 22.883487701416016, Poisson: -0.1100151315331459
Epoch 0:  84%|▊| 646/769 [03:30&lt;00:40,  3.07it/s, v_num=z19b, train_loss_step=22Multinomial: 20.011852264404297, Poisson: -0.09556586295366287
Epoch 0:  84%|▊| 647/769 [03:30&lt;00:39,  3.08it/s, v_num=z19b, train_loss_step=19Multinomial: 22.84145164489746, Poisson: -0.11009329557418823
Epoch 0:  84%|▊| 648/769 [03:30&lt;00:39,  3.08it/s, v_num=z19b, train_loss_step=22Multinomial: 18.867341995239258, Poisson: -0.08986131101846695
Epoch 0:  84%|▊| 649/769 [03:31&lt;00:39,  3.08it/s, v_num=z19b, train_loss_step=18Multinomial: 21.76729393005371, Poisson: -0.10426922142505646
Epoch 0:  85%|▊| 650/769 [03:31&lt;00:38,  3.08it/s, v_num=z19b, train_loss_step=21Multinomial: 20.55791473388672, Poisson: -0.09848575294017792
Epoch 0:  85%|▊| 651/769 [03:31&lt;00:38,  3.08it/s, v_num=z19b, train_loss_step=20Multinomial: 22.304027557373047, Poisson: -0.10717406868934631
Epoch 0:  85%|▊| 652/769 [03:32&lt;00:38,  3.08it/s, v_num=z19b, train_loss_step=22Multinomial: 18.308515548706055, Poisson: -0.08711100369691849
Epoch 0:  85%|▊| 653/769 [03:32&lt;00:37,  3.08it/s, v_num=z19b, train_loss_step=18Multinomial: 18.863386154174805, Poisson: -0.08990974724292755
Epoch 0:  85%|▊| 654/769 [03:32&lt;00:37,  3.08it/s, v_num=z19b, train_loss_step=18Multinomial: 21.686914443969727, Poisson: -0.10436270385980606
Epoch 0:  85%|▊| 655/769 [03:32&lt;00:37,  3.08it/s, v_num=z19b, train_loss_step=21Multinomial: 19.383159637451172, Poisson: -0.09273471683263779
Epoch 0:  85%|▊| 656/769 [03:33&lt;00:36,  3.08it/s, v_num=z19b, train_loss_step=19Multinomial: 20.582088470458984, Poisson: -0.09853686392307281
Epoch 0:  85%|▊| 657/769 [03:33&lt;00:36,  3.08it/s, v_num=z19b, train_loss_step=20Multinomial: 17.692808151245117, Poisson: -0.08411633968353271
Epoch 0:  86%|▊| 658/769 [03:33&lt;00:36,  3.08it/s, v_num=z19b, train_loss_step=17Multinomial: 21.11493682861328, Poisson: -0.10136602818965912
Epoch 0:  86%|▊| 659/769 [03:34&lt;00:35,  3.08it/s, v_num=z19b, train_loss_step=21Multinomial: 22.864057540893555, Poisson: -0.11002244800329208
Epoch 0:  86%|▊| 660/769 [03:34&lt;00:35,  3.08it/s, v_num=z19b, train_loss_step=22Multinomial: 23.464242935180664, Poisson: -0.11291033774614334
Epoch 0:  86%|▊| 661/769 [03:34&lt;00:35,  3.08it/s, v_num=z19b, train_loss_step=23Multinomial: 21.14508819580078, Poisson: -0.10143182426691055
Epoch 0:  86%|▊| 662/769 [03:35&lt;00:34,  3.08it/s, v_num=z19b, train_loss_step=21Multinomial: 19.443513870239258, Poisson: -0.09281083941459656
Epoch 0:  86%|▊| 663/769 [03:35&lt;00:34,  3.08it/s, v_num=z19b, train_loss_step=19Multinomial: 20.558584213256836, Poisson: -0.09855873882770538
Epoch 0:  86%|▊| 664/769 [03:35&lt;00:34,  3.08it/s, v_num=z19b, train_loss_step=20Multinomial: 20.03877067565918, Poisson: -0.09563073515892029
Epoch 0:  86%|▊| 665/769 [03:36&lt;00:33,  3.08it/s, v_num=z19b, train_loss_step=19Multinomial: 21.726139068603516, Poisson: -0.10430379211902618
Epoch 0:  87%|▊| 666/769 [03:36&lt;00:33,  3.08it/s, v_num=z19b, train_loss_step=21Multinomial: 19.999242782592773, Poisson: -0.09571696817874908
Epoch 0:  87%|▊| 667/769 [03:36&lt;00:33,  3.08it/s, v_num=z19b, train_loss_step=19Multinomial: 19.408790588378906, Poisson: -0.09278055280447006
Epoch 0:  87%|▊| 668/769 [03:37&lt;00:32,  3.08it/s, v_num=z19b, train_loss_step=19Multinomial: 18.88188934326172, Poisson: -0.08987957239151001
Epoch 0:  87%|▊| 669/769 [03:37&lt;00:32,  3.08it/s, v_num=z19b, train_loss_step=18Multinomial: 19.41340446472168, Poisson: -0.09275177121162415
Epoch 0:  87%|▊| 670/769 [03:37&lt;00:32,  3.08it/s, v_num=z19b, train_loss_step=19Multinomial: 20.026708602905273, Poisson: -0.09573861211538315
Epoch 0:  87%|▊| 671/769 [03:38&lt;00:31,  3.08it/s, v_num=z19b, train_loss_step=19Multinomial: 18.875534057617188, Poisson: -0.08994260430335999
Epoch 0:  87%|▊| 672/769 [03:38&lt;00:31,  3.08it/s, v_num=z19b, train_loss_step=18Multinomial: 21.74219512939453, Poisson: -0.10441020131111145
Epoch 0:  88%|▉| 673/769 [03:38&lt;00:31,  3.08it/s, v_num=z19b, train_loss_step=21Multinomial: 19.44632339477539, Poisson: -0.09283525496721268
Epoch 0:  88%|▉| 674/769 [03:39&lt;00:30,  3.08it/s, v_num=z19b, train_loss_step=19Multinomial: 20.595623016357422, Poisson: -0.09864122420549393
Epoch 0:  88%|▉| 675/769 [03:39&lt;00:30,  3.08it/s, v_num=z19b, train_loss_step=20Multinomial: 21.700439453125, Poisson: -0.10430484265089035
Epoch 0:  88%|▉| 676/769 [03:39&lt;00:30,  3.08it/s, v_num=z19b, train_loss_step=21Multinomial: 21.16611099243164, Poisson: -0.10145748406648636
Epoch 0:  88%|▉| 677/769 [03:40&lt;00:29,  3.08it/s, v_num=z19b, train_loss_step=21Multinomial: 21.176849365234375, Poisson: -0.10152032971382141
Epoch 0:  88%|▉| 678/769 [03:40&lt;00:29,  3.08it/s, v_num=z19b, train_loss_step=21Multinomial: 19.940298080444336, Poisson: -0.09574522823095322
Epoch 0:  88%|▉| 679/769 [03:40&lt;00:29,  3.08it/s, v_num=z19b, train_loss_step=19Multinomial: 19.987138748168945, Poisson: -0.09580302238464355
Epoch 0:  88%|▉| 680/769 [03:40&lt;00:28,  3.08it/s, v_num=z19b, train_loss_step=19Multinomial: 21.723285675048828, Poisson: -0.10440830141305923
Epoch 0:  89%|▉| 681/769 [03:41&lt;00:28,  3.08it/s, v_num=z19b, train_loss_step=21Multinomial: 19.437225341796875, Poisson: -0.09280504286289215
Epoch 0:  89%|▉| 682/769 [03:41&lt;00:28,  3.08it/s, v_num=z19b, train_loss_step=19Multinomial: 19.43406867980957, Poisson: -0.0928666964173317
Epoch 0:  89%|▉| 683/769 [03:42&lt;00:27,  3.08it/s, v_num=z19b, train_loss_step=19Multinomial: 22.27805519104004, Poisson: -0.10732336342334747
Epoch 0:  89%|▉| 684/769 [03:42&lt;00:27,  3.08it/s, v_num=z19b, train_loss_step=22Multinomial: 21.140138626098633, Poisson: -0.10147257149219513
Epoch 0:  89%|▉| 685/769 [03:42&lt;00:27,  3.08it/s, v_num=z19b, train_loss_step=21Multinomial: 20.01200294494629, Poisson: -0.09573910385370255
Epoch 0:  89%|▉| 686/769 [03:43&lt;00:26,  3.08it/s, v_num=z19b, train_loss_step=19Multinomial: 21.149173736572266, Poisson: -0.10142923146486282
Epoch 0:  89%|▉| 687/769 [03:43&lt;00:26,  3.08it/s, v_num=z19b, train_loss_step=21Multinomial: 19.448062896728516, Poisson: -0.0928628072142601
Epoch 0:  89%|▉| 688/769 [03:43&lt;00:26,  3.08it/s, v_num=z19b, train_loss_step=19Multinomial: 19.997783660888672, Poisson: -0.09571991860866547
Epoch 0:  90%|▉| 689/769 [03:43&lt;00:26,  3.08it/s, v_num=z19b, train_loss_step=19Multinomial: 17.705421447753906, Poisson: -0.08407346904277802
Epoch 0:  90%|▉| 690/769 [03:44&lt;00:25,  3.08it/s, v_num=z19b, train_loss_step=17Multinomial: 24.02863883972168, Poisson: -0.11588338017463684
Epoch 0:  90%|▉| 691/769 [03:44&lt;00:25,  3.08it/s, v_num=z19b, train_loss_step=23Multinomial: 22.272811889648438, Poisson: -0.10719016194343567
Epoch 0:  90%|▉| 692/769 [03:44&lt;00:25,  3.08it/s, v_num=z19b, train_loss_step=22Multinomial: 17.159162521362305, Poisson: -0.08133658766746521
Epoch 0:  90%|▉| 693/769 [03:45&lt;00:24,  3.08it/s, v_num=z19b, train_loss_step=17Multinomial: 23.441617965698242, Poisson: -0.11292989552021027
Epoch 0:  90%|▉| 694/769 [03:45&lt;00:24,  3.08it/s, v_num=z19b, train_loss_step=23Multinomial: 21.682270050048828, Poisson: -0.10430086404085159
Epoch 0:  90%|▉| 695/769 [03:45&lt;00:24,  3.08it/s, v_num=z19b, train_loss_step=21Multinomial: 18.891855239868164, Poisson: -0.08994506299495697
Epoch 0:  91%|▉| 696/769 [03:46&lt;00:23,  3.08it/s, v_num=z19b, train_loss_step=18Multinomial: 21.70918083190918, Poisson: -0.10443385690450668
Epoch 0:  91%|▉| 697/769 [03:46&lt;00:23,  3.08it/s, v_num=z19b, train_loss_step=21Multinomial: 23.431753158569336, Poisson: -0.11299103498458862
Epoch 0:  91%|▉| 698/769 [03:46&lt;00:23,  3.08it/s, v_num=z19b, train_loss_step=23Multinomial: 17.713972091674805, Poisson: -0.0842127799987793
Epoch 0:  91%|▉| 699/769 [03:47&lt;00:22,  3.08it/s, v_num=z19b, train_loss_step=17Multinomial: 21.127714157104492, Poisson: -0.10148810595273972
Epoch 0:  91%|▉| 700/769 [03:47&lt;00:22,  3.08it/s, v_num=z19b, train_loss_step=21Multinomial: 21.72228240966797, Poisson: -0.10432709753513336
Epoch 0:  91%|▉| 701/769 [03:47&lt;00:22,  3.08it/s, v_num=z19b, train_loss_step=21Multinomial: 18.882402420043945, Poisson: -0.08996345847845078
Epoch 0:  91%|▉| 702/769 [03:48&lt;00:21,  3.08it/s, v_num=z19b, train_loss_step=18Multinomial: 20.55876350402832, Poisson: -0.09865964204072952
Epoch 0:  91%|▉| 703/769 [03:48&lt;00:21,  3.08it/s, v_num=z19b, train_loss_step=20Multinomial: 16.557537078857422, Poisson: -0.07843680679798126
Epoch 0:  92%|▉| 704/769 [03:48&lt;00:21,  3.08it/s, v_num=z19b, train_loss_step=16Multinomial: 21.718515396118164, Poisson: -0.1042751595377922
Epoch 0:  92%|▉| 705/769 [03:49&lt;00:20,  3.08it/s, v_num=z19b, train_loss_step=21Multinomial: 21.773019790649414, Poisson: -0.10444390773773193
Epoch 0:  92%|▉| 706/769 [03:49&lt;00:20,  3.08it/s, v_num=z19b, train_loss_step=21Multinomial: 18.87618064880371, Poisson: -0.090021513402462
Epoch 0:  92%|▉| 707/769 [03:49&lt;00:20,  3.08it/s, v_num=z19b, train_loss_step=18Multinomial: 22.88922119140625, Poisson: -0.11005312204360962
Epoch 0:  92%|▉| 708/769 [03:50&lt;00:19,  3.08it/s, v_num=z19b, train_loss_step=22Multinomial: 18.845916748046875, Poisson: -0.08993731439113617
Epoch 0:  92%|▉| 709/769 [03:50&lt;00:19,  3.08it/s, v_num=z19b, train_loss_step=18Multinomial: 20.624095916748047, Poisson: -0.09869363158941269
Epoch 0:  92%|▉| 710/769 [03:50&lt;00:19,  3.08it/s, v_num=z19b, train_loss_step=20Multinomial: 21.739727020263672, Poisson: -0.1044175773859024
Epoch 0:  92%|▉| 711/769 [03:51&lt;00:18,  3.08it/s, v_num=z19b, train_loss_step=21Multinomial: 20.558605194091797, Poisson: -0.09854687750339508
Epoch 0:  93%|▉| 712/769 [03:51&lt;00:18,  3.08it/s, v_num=z19b, train_loss_step=20Multinomial: 23.420400619506836, Poisson: -0.11305233091115952
Epoch 0:  93%|▉| 713/769 [03:51&lt;00:18,  3.08it/s, v_num=z19b, train_loss_step=23Multinomial: 20.010053634643555, Poisson: -0.09578403830528259
Epoch 0:  93%|▉| 714/769 [03:51&lt;00:17,  3.08it/s, v_num=z19b, train_loss_step=19Multinomial: 21.100210189819336, Poisson: -0.10143181681632996
Epoch 0:  93%|▉| 715/769 [03:52&lt;00:17,  3.08it/s, v_num=z19b, train_loss_step=21Multinomial: 21.152509689331055, Poisson: -0.10144979506731033
Epoch 0:  93%|▉| 716/769 [03:52&lt;00:17,  3.08it/s, v_num=z19b, train_loss_step=21Multinomial: 21.18043327331543, Poisson: -0.10148090869188309
Epoch 0:  93%|▉| 717/769 [03:52&lt;00:16,  3.08it/s, v_num=z19b, train_loss_step=21Multinomial: 18.30461883544922, Poisson: -0.08715315908193588
Epoch 0:  93%|▉| 718/769 [03:53&lt;00:16,  3.08it/s, v_num=z19b, train_loss_step=18Multinomial: 20.58533477783203, Poisson: -0.09853104501962662
Epoch 0:  93%|▉| 719/769 [03:53&lt;00:16,  3.08it/s, v_num=z19b, train_loss_step=20Multinomial: 18.2994327545166, Poisson: -0.08701936155557632
Epoch 0:  94%|▉| 720/769 [03:53&lt;00:15,  3.08it/s, v_num=z19b, train_loss_step=18Multinomial: 18.272613525390625, Poisson: -0.08693970739841461
Epoch 0:  94%|▉| 721/769 [03:54&lt;00:15,  3.08it/s, v_num=z19b, train_loss_step=18Multinomial: 22.253665924072266, Poisson: -0.10727787762880325
Epoch 0:  94%|▉| 722/769 [03:54&lt;00:15,  3.08it/s, v_num=z19b, train_loss_step=22Multinomial: 21.70849609375, Poisson: -0.10424362868070602
Epoch 0:  94%|▉| 723/769 [03:54&lt;00:14,  3.08it/s, v_num=z19b, train_loss_step=21Multinomial: 21.175783157348633, Poisson: -0.10158664733171463
Epoch 0:  94%|▉| 724/769 [03:55&lt;00:14,  3.08it/s, v_num=z19b, train_loss_step=21Multinomial: 22.84950065612793, Poisson: -0.11008002609014511
Epoch 0:  94%|▉| 725/769 [03:55&lt;00:14,  3.08it/s, v_num=z19b, train_loss_step=22Multinomial: 19.983989715576172, Poisson: -0.09570445865392685
Epoch 0:  94%|▉| 726/769 [03:55&lt;00:13,  3.08it/s, v_num=z19b, train_loss_step=19Multinomial: 21.743120193481445, Poisson: -0.10435201227664948
Epoch 0:  95%|▉| 727/769 [03:56&lt;00:13,  3.08it/s, v_num=z19b, train_loss_step=21Multinomial: 16.565397262573242, Poisson: -0.07844546437263489
Epoch 0:  95%|▉| 728/769 [03:56&lt;00:13,  3.08it/s, v_num=z19b, train_loss_step=16Multinomial: 19.458765029907227, Poisson: -0.09275633096694946
Epoch 0:  95%|▉| 729/769 [03:56&lt;00:12,  3.08it/s, v_num=z19b, train_loss_step=19Multinomial: 22.31951904296875, Poisson: -0.10732661932706833
Epoch 0:  95%|▉| 730/769 [03:57&lt;00:12,  3.08it/s, v_num=z19b, train_loss_step=22Multinomial: 19.981609344482422, Poisson: -0.09576409310102463
Epoch 0:  95%|▉| 731/769 [03:57&lt;00:12,  3.08it/s, v_num=z19b, train_loss_step=19Multinomial: 19.962175369262695, Poisson: -0.09566673636436462
Epoch 0:  95%|▉| 732/769 [03:57&lt;00:12,  3.08it/s, v_num=z19b, train_loss_step=19Multinomial: 21.115779876708984, Poisson: -0.1015494242310524
Epoch 0:  95%|▉| 733/769 [03:58&lt;00:11,  3.08it/s, v_num=z19b, train_loss_step=21Multinomial: 17.698392868041992, Poisson: -0.08425670117139816
Epoch 0:  95%|▉| 734/769 [03:58&lt;00:11,  3.08it/s, v_num=z19b, train_loss_step=17Multinomial: 17.118419647216797, Poisson: -0.08128058910369873
Epoch 0:  96%|▉| 735/769 [03:58&lt;00:11,  3.08it/s, v_num=z19b, train_loss_step=17Multinomial: 22.270145416259766, Poisson: -0.1072516217827797
Epoch 0:  96%|▉| 736/769 [03:59&lt;00:10,  3.08it/s, v_num=z19b, train_loss_step=22Multinomial: 22.855756759643555, Poisson: -0.1101374626159668
Epoch 0:  96%|▉| 737/769 [03:59&lt;00:10,  3.08it/s, v_num=z19b, train_loss_step=22Multinomial: 21.675521850585938, Poisson: -0.10433848947286606
Epoch 0:  96%|▉| 738/769 [03:59&lt;00:10,  3.08it/s, v_num=z19b, train_loss_step=21Multinomial: 20.029075622558594, Poisson: -0.09581775963306427
Epoch 0:  96%|▉| 739/769 [04:00&lt;00:09,  3.08it/s, v_num=z19b, train_loss_step=19Multinomial: 20.606746673583984, Poisson: -0.0986202284693718
Epoch 0:  96%|▉| 740/769 [04:00&lt;00:09,  3.08it/s, v_num=z19b, train_loss_step=20Multinomial: 24.58598518371582, Poisson: -0.11861968785524368
Epoch 0:  96%|▉| 741/769 [04:00&lt;00:09,  3.08it/s, v_num=z19b, train_loss_step=24Multinomial: 21.18328094482422, Poisson: -0.1015213206410408
Epoch 0:  96%|▉| 742/769 [04:01&lt;00:08,  3.08it/s, v_num=z19b, train_loss_step=21Multinomial: 22.91167449951172, Poisson: -0.11014758050441742
Epoch 0:  97%|▉| 743/769 [04:01&lt;00:08,  3.08it/s, v_num=z19b, train_loss_step=22Multinomial: 20.556596755981445, Poisson: -0.09857045114040375
Epoch 0:  97%|▉| 744/769 [04:01&lt;00:08,  3.08it/s, v_num=z19b, train_loss_step=20Multinomial: 24.585527420043945, Poisson: -0.11867980659008026
Epoch 0:  97%|▉| 745/769 [04:01&lt;00:07,  3.08it/s, v_num=z19b, train_loss_step=24Multinomial: 18.29959487915039, Poisson: -0.08714929968118668
Epoch 0:  97%|▉| 746/769 [04:02&lt;00:07,  3.08it/s, v_num=z19b, train_loss_step=18Multinomial: 19.996850967407227, Poisson: -0.09569291770458221
Epoch 0:  97%|▉| 747/769 [04:02&lt;00:07,  3.08it/s, v_num=z19b, train_loss_step=19Multinomial: 17.687084197998047, Poisson: -0.08424196392297745
Epoch 0:  97%|▉| 748/769 [04:02&lt;00:06,  3.08it/s, v_num=z19b, train_loss_step=17Multinomial: 19.47761344909668, Poisson: -0.09281577169895172
Epoch 0:  97%|▉| 749/769 [04:03&lt;00:06,  3.08it/s, v_num=z19b, train_loss_step=19Multinomial: 18.27571678161621, Poisson: -0.08710093051195145
Epoch 0:  98%|▉| 750/769 [04:03&lt;00:06,  3.08it/s, v_num=z19b, train_loss_step=18Multinomial: 20.00288963317871, Poisson: -0.0957367867231369
Epoch 0:  98%|▉| 751/769 [04:03&lt;00:05,  3.08it/s, v_num=z19b, train_loss_step=19Multinomial: 17.699932098388672, Poisson: -0.08418973535299301
Epoch 0:  98%|▉| 752/769 [04:04&lt;00:05,  3.08it/s, v_num=z19b, train_loss_step=17Multinomial: 20.031009674072266, Poisson: -0.09579721093177795
Epoch 0:  98%|▉| 753/769 [04:04&lt;00:05,  3.08it/s, v_num=z19b, train_loss_step=19Multinomial: 19.397037506103516, Poisson: -0.09293437004089355
Epoch 0:  98%|▉| 754/769 [04:04&lt;00:04,  3.08it/s, v_num=z19b, train_loss_step=19Multinomial: 19.437700271606445, Poisson: -0.09282519668340683
Epoch 0:  98%|▉| 755/769 [04:05&lt;00:04,  3.08it/s, v_num=z19b, train_loss_step=19Multinomial: 18.308332443237305, Poisson: -0.08703478425741196
Epoch 0:  98%|▉| 756/769 [04:05&lt;00:04,  3.08it/s, v_num=z19b, train_loss_step=18Multinomial: 19.94603729248047, Poisson: -0.09575864672660828
Epoch 0:  98%|▉| 757/769 [04:05&lt;00:03,  3.08it/s, v_num=z19b, train_loss_step=19Multinomial: 18.282461166381836, Poisson: -0.087057925760746
Epoch 0:  99%|▉| 758/769 [04:06&lt;00:03,  3.08it/s, v_num=z19b, train_loss_step=18Multinomial: 19.973783493041992, Poisson: -0.0956733226776123
Epoch 0:  99%|▉| 759/769 [04:06&lt;00:03,  3.08it/s, v_num=z19b, train_loss_step=19Multinomial: 22.262523651123047, Poisson: -0.10717542469501495
Epoch 0:  99%|▉| 760/769 [04:06&lt;00:02,  3.08it/s, v_num=z19b, train_loss_step=22Multinomial: 21.145244598388672, Poisson: -0.10147766768932343
Epoch 0:  99%|▉| 761/769 [04:07&lt;00:02,  3.08it/s, v_num=z19b, train_loss_step=21Multinomial: 19.974407196044922, Poisson: -0.09560398012399673
Epoch 0:  99%|▉| 762/769 [04:07&lt;00:02,  3.08it/s, v_num=z19b, train_loss_step=19Multinomial: 16.576799392700195, Poisson: -0.07834896445274353
Epoch 0:  99%|▉| 763/769 [04:07&lt;00:01,  3.08it/s, v_num=z19b, train_loss_step=16Multinomial: 20.010774612426758, Poisson: -0.09574145823717117
Epoch 0:  99%|▉| 764/769 [04:08&lt;00:01,  3.08it/s, v_num=z19b, train_loss_step=19Multinomial: 20.060941696166992, Poisson: -0.09567277133464813
Epoch 0:  99%|▉| 765/769 [04:08&lt;00:01,  3.08it/s, v_num=z19b, train_loss_step=20Multinomial: 20.035526275634766, Poisson: -0.09589924663305283
Epoch 0: 100%|▉| 766/769 [04:08&lt;00:00,  3.08it/s, v_num=z19b, train_loss_step=19Multinomial: 18.274394989013672, Poisson: -0.08702310919761658
Epoch 0: 100%|▉| 767/769 [04:09&lt;00:00,  3.08it/s, v_num=z19b, train_loss_step=18Multinomial: 23.451854705810547, Poisson: -0.11297088116407394
Epoch 0: 100%|▉| 768/769 [04:09&lt;00:00,  3.08it/s, v_num=z19b, train_loss_step=23Multinomial: 18.815200805664062, Poisson: -0.08984994888305664
Epoch 0: 100%|█| 769/769 [04:09&lt;00:00,  3.08it/s, v_num=z19b, train_loss_step=18
Validation: |                                             | 0/? [00:00&lt;?, ?it/s]
Validation: |                                             | 0/? [00:00&lt;?, ?it/s]
Validation DataLoader 0:   0%|                           | 0/71 [00:00&lt;?, ?it/s]Multinomial: 17.716901779174805, Poisson: -0.0842541754245758

Validation DataLoader 0:   1%|▎                  | 1/71 [00:00&lt;00:08,  8.21it/s]Multinomial: 17.111413955688477, Poisson: -0.08142644912004471

Validation DataLoader 0:   3%|▌                  | 2/71 [00:00&lt;00:08,  8.32it/s]Multinomial: 23.425609588623047, Poisson: -0.11304879933595657

Validation DataLoader 0:   4%|▊                  | 3/71 [00:00&lt;00:08,  8.34it/s]Multinomial: 18.310951232910156, Poisson: -0.08712843805551529

Validation DataLoader 0:   6%|█                  | 4/71 [00:00&lt;00:08,  8.35it/s]Multinomial: 21.69930648803711, Poisson: -0.10443383455276489

Validation DataLoader 0:   7%|█▎                 | 5/71 [00:00&lt;00:07,  8.37it/s]Multinomial: 17.71156120300293, Poisson: -0.0842083990573883

Validation DataLoader 0:   8%|█▌                 | 6/71 [00:00&lt;00:07,  8.35it/s]Multinomial: 17.716909408569336, Poisson: -0.08418463915586472

Validation DataLoader 0:  10%|█▊                 | 7/71 [00:00&lt;00:07,  8.36it/s]Multinomial: 22.30345916748047, Poisson: -0.10729078948497772

Validation DataLoader 0:  11%|██▏                | 8/71 [00:00&lt;00:07,  8.35it/s]Multinomial: 22.914581298828125, Poisson: -0.11025728285312653

Validation DataLoader 0:  13%|██▍                | 9/71 [00:01&lt;00:07,  8.36it/s]Multinomial: 20.575937271118164, Poisson: -0.09870337694883347

Validation DataLoader 0:  14%|██▌               | 10/71 [00:01&lt;00:07,  8.37it/s]Multinomial: 17.165935516357422, Poisson: -0.08137664198875427

Validation DataLoader 0:  15%|██▊               | 11/71 [00:01&lt;00:07,  8.37it/s]Multinomial: 20.027223587036133, Poisson: -0.0957554280757904

Validation DataLoader 0:  17%|███               | 12/71 [00:01&lt;00:07,  8.38it/s]Multinomial: 21.75094985961914, Poisson: -0.10433730483055115

Validation DataLoader 0:  18%|███▎              | 13/71 [00:01&lt;00:06,  8.39it/s]Multinomial: 23.988325119018555, Poisson: -0.11592997610569

Validation DataLoader 0:  20%|███▌              | 14/71 [00:01&lt;00:06,  8.39it/s]Multinomial: 20.581188201904297, Poisson: -0.0986180379986763

Validation DataLoader 0:  21%|███▊              | 15/71 [00:01&lt;00:06,  8.39it/s]Multinomial: 21.163742065429688, Poisson: -0.10148521512746811

Validation DataLoader 0:  23%|████              | 16/71 [00:01&lt;00:06,  8.39it/s]Multinomial: 16.589000701904297, Poisson: -0.07846640795469284

Validation DataLoader 0:  24%|████▎             | 17/71 [00:02&lt;00:06,  8.40it/s]Multinomial: 22.847074508666992, Poisson: -0.11020691692829132

Validation DataLoader 0:  25%|████▌             | 18/71 [00:02&lt;00:06,  8.40it/s]Multinomial: 20.01692771911621, Poisson: -0.09579959511756897

Validation DataLoader 0:  27%|████▊             | 19/71 [00:02&lt;00:06,  8.41it/s]Multinomial: 24.60647964477539, Poisson: -0.11890874803066254

Validation DataLoader 0:  28%|█████             | 20/71 [00:02&lt;00:06,  8.41it/s]Multinomial: 20.558605194091797, Poisson: -0.09858974814414978

Validation DataLoader 0:  30%|█████▎            | 21/71 [00:02&lt;00:05,  8.42it/s]Multinomial: 24.025171279907227, Poisson: -0.11593114584684372

Validation DataLoader 0:  31%|█████▌            | 22/71 [00:02&lt;00:05,  8.42it/s]Multinomial: 19.443302154541016, Poisson: -0.09287422150373459

Validation DataLoader 0:  32%|█████▊            | 23/71 [00:02&lt;00:05,  8.42it/s]Multinomial: 18.868642807006836, Poisson: -0.09000197798013687

Validation DataLoader 0:  34%|██████            | 24/71 [00:02&lt;00:05,  8.42it/s]Multinomial: 20.016002655029297, Poisson: -0.09571726620197296

Validation DataLoader 0:  35%|██████▎           | 25/71 [00:02&lt;00:05,  8.41it/s]Multinomial: 18.829559326171875, Poisson: -0.09004005789756775

Validation DataLoader 0:  37%|██████▌           | 26/71 [00:03&lt;00:05,  8.41it/s]Multinomial: 19.42708969116211, Poisson: -0.09287534654140472

Validation DataLoader 0:  38%|██████▊           | 27/71 [00:03&lt;00:05,  8.41it/s]Multinomial: 21.120561599731445, Poisson: -0.10152031481266022

Validation DataLoader 0:  39%|███████           | 28/71 [00:03&lt;00:05,  8.41it/s]Multinomial: 17.170427322387695, Poisson: -0.08139950037002563

Validation DataLoader 0:  41%|███████▎          | 29/71 [00:03&lt;00:04,  8.41it/s]Multinomial: 20.602895736694336, Poisson: -0.09869901835918427

Validation DataLoader 0:  42%|███████▌          | 30/71 [00:03&lt;00:04,  8.41it/s]Multinomial: 23.474809646606445, Poisson: -0.11297131329774857

Validation DataLoader 0:  44%|███████▊          | 31/71 [00:03&lt;00:04,  8.41it/s]Multinomial: 21.691268920898438, Poisson: -0.10439599305391312

Validation DataLoader 0:  45%|████████          | 32/71 [00:03&lt;00:04,  8.41it/s]Multinomial: 19.506582260131836, Poisson: -0.09291653335094452

Validation DataLoader 0:  46%|████████▎         | 33/71 [00:03&lt;00:04,  8.41it/s]Multinomial: 21.678659439086914, Poisson: -0.10445165634155273

Validation DataLoader 0:  48%|████████▌         | 34/71 [00:04&lt;00:04,  8.41it/s]Multinomial: 19.454126358032227, Poisson: -0.09299568086862564

Validation DataLoader 0:  49%|████████▊         | 35/71 [00:04&lt;00:04,  8.41it/s]Multinomial: 19.428022384643555, Poisson: -0.09296447038650513

Validation DataLoader 0:  51%|█████████▏        | 36/71 [00:04&lt;00:04,  8.42it/s]Multinomial: 24.035980224609375, Poisson: -0.11596573144197464

Validation DataLoader 0:  52%|█████████▍        | 37/71 [00:04&lt;00:04,  8.42it/s]Multinomial: 16.003135681152344, Poisson: -0.0756034255027771

Validation DataLoader 0:  54%|█████████▋        | 38/71 [00:04&lt;00:03,  8.42it/s]Multinomial: 22.86717987060547, Poisson: -0.11009746044874191

Validation DataLoader 0:  55%|█████████▉        | 39/71 [00:04&lt;00:03,  8.42it/s]Multinomial: 20.008590698242188, Poisson: -0.09584179520606995

Validation DataLoader 0:  56%|██████████▏       | 40/71 [00:04&lt;00:03,  8.42it/s]Multinomial: 24.013071060180664, Poisson: -0.11609537154436111

Validation DataLoader 0:  58%|██████████▍       | 41/71 [00:04&lt;00:03,  8.42it/s]Multinomial: 18.262495040893555, Poisson: -0.08710993826389313

Validation DataLoader 0:  59%|██████████▋       | 42/71 [00:04&lt;00:03,  8.42it/s]Multinomial: 15.400927543640137, Poisson: -0.07267866283655167

Validation DataLoader 0:  61%|██████████▉       | 43/71 [00:05&lt;00:03,  8.43it/s]Multinomial: 22.283693313598633, Poisson: -0.10728690028190613

Validation DataLoader 0:  62%|███████████▏      | 44/71 [00:05&lt;00:03,  8.43it/s]Multinomial: 23.98147201538086, Poisson: -0.11589444428682327

Validation DataLoader 0:  63%|███████████▍      | 45/71 [00:05&lt;00:03,  8.43it/s]Multinomial: 22.839250564575195, Poisson: -0.11021523177623749

Validation DataLoader 0:  65%|███████████▋      | 46/71 [00:05&lt;00:02,  8.43it/s]Multinomial: 21.702539443969727, Poisson: -0.10436630249023438

Validation DataLoader 0:  66%|███████████▉      | 47/71 [00:05&lt;00:02,  8.43it/s]Multinomial: 21.14405632019043, Poisson: -0.10157938301563263

Validation DataLoader 0:  68%|████████████▏     | 48/71 [00:05&lt;00:02,  8.43it/s]Multinomial: 23.973310470581055, Poisson: -0.11596804857254028

Validation DataLoader 0:  69%|████████████▍     | 49/71 [00:05&lt;00:02,  8.43it/s]Multinomial: 18.86297607421875, Poisson: -0.09003901481628418

Validation DataLoader 0:  70%|████████████▋     | 50/71 [00:05&lt;00:02,  8.44it/s]Multinomial: 18.819631576538086, Poisson: -0.08997668325901031

Validation DataLoader 0:  72%|████████████▉     | 51/71 [00:06&lt;00:02,  8.44it/s]Multinomial: 19.997264862060547, Poisson: -0.09578437358140945

Validation DataLoader 0:  73%|█████████████▏    | 52/71 [00:06&lt;00:02,  8.44it/s]Multinomial: 21.724157333374023, Poisson: -0.10460198670625687

Validation DataLoader 0:  75%|█████████████▍    | 53/71 [00:06&lt;00:02,  8.44it/s]Multinomial: 23.43874168395996, Poisson: -0.11302252113819122

Validation DataLoader 0:  76%|█████████████▋    | 54/71 [00:06&lt;00:02,  8.44it/s]Multinomial: 23.408498764038086, Poisson: -0.1130722165107727

Validation DataLoader 0:  77%|█████████████▉    | 55/71 [00:06&lt;00:01,  8.44it/s]Multinomial: 21.740259170532227, Poisson: -0.1043655276298523

Validation DataLoader 0:  79%|██████████████▏   | 56/71 [00:06&lt;00:01,  8.44it/s]Multinomial: 21.16032600402832, Poisson: -0.10145632177591324

Validation DataLoader 0:  80%|██████████████▍   | 57/71 [00:06&lt;00:01,  8.44it/s]Multinomial: 18.321645736694336, Poisson: -0.0869961678981781

Validation DataLoader 0:  82%|██████████████▋   | 58/71 [00:06&lt;00:01,  8.44it/s]Multinomial: 20.60637092590332, Poisson: -0.09867449849843979

Validation DataLoader 0:  83%|██████████████▉   | 59/71 [00:06&lt;00:01,  8.44it/s]Multinomial: 20.584291458129883, Poisson: -0.09861595183610916

Validation DataLoader 0:  85%|███████████████▏  | 60/71 [00:07&lt;00:01,  8.45it/s]Multinomial: 23.400897979736328, Poisson: -0.11304128170013428

Validation DataLoader 0:  86%|███████████████▍  | 61/71 [00:07&lt;00:01,  8.45it/s]Multinomial: 21.11324691772461, Poisson: -0.10135163366794586

Validation DataLoader 0:  87%|███████████████▋  | 62/71 [00:07&lt;00:01,  8.45it/s]Multinomial: 16.046730041503906, Poisson: -0.07560420781373978

Validation DataLoader 0:  89%|███████████████▉  | 63/71 [00:07&lt;00:00,  8.45it/s]Multinomial: 20.567626953125, Poisson: -0.09863480180501938

Validation DataLoader 0:  90%|████████████████▏ | 64/71 [00:07&lt;00:00,  8.45it/s]Multinomial: 20.566984176635742, Poisson: -0.09877726435661316

Validation DataLoader 0:  92%|████████████████▍ | 65/71 [00:07&lt;00:00,  8.45it/s]Multinomial: 21.132198333740234, Poisson: -0.10157855600118637

Validation DataLoader 0:  93%|████████████████▋ | 66/71 [00:07&lt;00:00,  8.45it/s]Multinomial: 22.27311897277832, Poisson: -0.10738851130008698

Validation DataLoader 0:  94%|████████████████▉ | 67/71 [00:07&lt;00:00,  8.45it/s]Multinomial: 19.986507415771484, Poisson: -0.09572213143110275

Validation DataLoader 0:  96%|█████████████████▏| 68/71 [00:08&lt;00:00,  8.45it/s]Multinomial: 17.739992141723633, Poisson: -0.0842907726764679

Validation DataLoader 0:  97%|█████████████████▍| 69/71 [00:08&lt;00:00,  8.45it/s]Multinomial: 20.572601318359375, Poisson: -0.09863804280757904

Validation DataLoader 0:  99%|█████████████████▋| 70/71 [00:08&lt;00:00,  8.45it/s]Multinomial: 24.05718231201172, Poisson: -0.1159498542547226

Validation DataLoader 0: 100%|██████████████████| 71/71 [00:08&lt;00:00,  8.45it/s]
Epoch 0: 100%|█| 769/769 [04:19&lt;00:00,  2.97it/s, v_num=z19b, train_loss_step=18`Trainer.fit` stopped: `max_epochs=1` reached.
Epoch 0: 100%|█| 769/769 [04:24&lt;00:00,  2.91it/s, v_num=z19b, train_loss_step=18
<span class=" -Color -Color-Bold -Color-Bold-Blue">wandb</span>: 
<span class=" -Color -Color-Bold -Color-Bold-Blue">wandb</span>: 🚀 View run <span class=" -Color -Color-Yellow">finetune_test_0</span> at: 

</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Uncomment if necessary</span>
<span class="c1"># import wandb</span>
<span class="c1"># wandb.login(host=&quot;https://genentech.wandb.io&quot;, anonymous=&quot;never&quot;, relogin=True)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="make-and-evaluate-predictions-using-trained-models">
<h2>8. Make and evaluate predictions using trained models<a class="headerlink" href="#make-and-evaluate-predictions-using-trained-models" title="Link to this heading">¶</a></h2>
<p>Using the training commands above, we trained two model replicates. Now, we can use these models to predict gene expression:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">checkpoint</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">outdir</span><span class="p">,</span> <span class="s2">&quot;lightning_logs/*/checkpoints/*.ckpt&quot;</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">checkpoint</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>./example/lightning_logs/bj42z19b/checkpoints/epoch=0-step=154.ckpt
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># comma-separated list of model checkpoints</span>
<span class="n">checkpoint_list</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">checkpoint</span><span class="p">,</span> <span class="n">checkpoint</span><span class="p">])</span>
<span class="n">checkpoint_list</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;./example/lightning_logs/bj42z19b/checkpoints/epoch=0-step=154.ckpt,./example/lightning_logs/bj42z19b/checkpoints/epoch=0-step=154.ckpt&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span><span class="w"> </span><span class="nv">CUDA_VISIBLE_DEVICES</span><span class="o">=</span><span class="m">0</span><span class="w"> </span>decima<span class="w"> </span>predict-genes<span class="w"> </span><span class="err">\</span>
<span class="o">--</span><span class="n">output</span> <span class="n">example</span><span class="o">/</span><span class="n">test_preds</span><span class="o">.</span><span class="n">h5ad</span> \
<span class="o">--</span><span class="n">model</span> <span class="p">{</span><span class="n">checkpoint_list</span><span class="p">}</span> \
<span class="o">--</span><span class="n">metadata</span> <span class="p">{</span><span class="n">ad_file_path</span><span class="p">}</span> \
<span class="o">--</span><span class="n">device</span> <span class="mi">0</span> \
<span class="o">--</span><span class="n">batch</span><span class="o">-</span><span class="n">size</span> <span class="mi">8</span> \
<span class="o">--</span><span class="n">num</span><span class="o">-</span><span class="n">workers</span> <span class="mi">32</span> \
<span class="o">--</span><span class="n">max_seq_shift</span> <span class="mi">0</span> \
<span class="o">--</span><span class="n">genome</span> <span class="n">hg38</span> \
<span class="o">--</span><span class="n">save</span><span class="o">-</span><span class="n">replicates</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/celikm5/miniforge3/envs/decima2/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The &#39;repr&#39; attribute with value False was provided to the `Field()` function, which has no effect in the context it was used. &#39;repr&#39; is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
  warnings.warn(
/home/celikm5/miniforge3/envs/decima2/lib/python3.11/site-packages/pydantic/_internal/_generate_schema.py:2249: UnsupportedFieldAttributeWarning: The &#39;frozen&#39; attribute with value True was provided to the `Field()` function, which has no effect in the context it was used. &#39;frozen&#39; is field-specific metadata, and can only be attached to a model field using `Annotated` metadata or by assignment. This may have happened because an `Annotated` type alias using the `type` statement was used, or if the `Field()` function was attached to a single member of a union type.
  warnings.warn(
decima - INFO - Using device: cuda:0 and genome: hg38 for prediction.
decima - INFO - Making predictions
decima - INFO - Initializing weights from Borzoi model using wandb for replicate: 0
<span class=" -Color -Color-Bold -Color-Bold-Blue">wandb</span>: Currently logged in as: <span class=" -Color -Color-Yellow">anony-mouse-591272909468377997</span> to <span class=" -Color -Color-Green">https://api.wandb.ai</span>. Use <span class=" -Color -Color-Bold">`wandb login --relogin`</span> to force relogin
<span class=" -Color -Color-Bold -Color-Bold-Blue">wandb</span>: Downloading large artifact &#39;human_state_dict_fold0:latest&#39;, 709.30MB. 1 files...
<span class=" -Color -Color-Bold -Color-Bold-Blue">wandb</span>:   1 of 1 files downloaded.  
Done. 00:00:00.5 (1298.4MB/s)
decima - INFO - Initializing weights from Borzoi model using wandb for replicate: 0
<span class=" -Color -Color-Bold -Color-Bold-Blue">wandb</span>: Downloading large artifact &#39;human_state_dict_fold0:latest&#39;, 709.30MB. 1 files...
<span class=" -Color -Color-Bold -Color-Bold-Blue">wandb</span>:   1 of 1 files downloaded.  
Done. 00:00:00.5 (1349.1MB/s)
decima - INFO - Initializing weights from Borzoi model using wandb for replicate: 0
<span class=" -Color -Color-Bold -Color-Bold-Blue">wandb</span>: Downloading large artifact &#39;human_state_dict_fold0:latest&#39;, 709.30MB. 1 files...
<span class=" -Color -Color-Bold -Color-Bold-Blue">wandb</span>:   1 of 1 files downloaded.  
Done. 00:00:00.6 (1258.9MB/s)
/home/celikm5/miniforge3/envs/decima2/lib/python3.11/site-packages/torch/__init__.py:1617: UserWarning: Please use the new API settings to control TF32 behavior, such as torch.backends.cudnn.conv.fp32_precision = &#39;tf32&#39; or torch.backends.cuda.matmul.fp32_precision = &#39;ieee&#39;. Old settings, e.g, torch.backends.cuda.matmul.allow_tf32 = True, torch.backends.cudnn.allow_tf32 = True, allowTF32CuDNN() and allowTF32CuBLAS() will be deprecated after Pytorch 2.9. Please see https://pytorch.org/docs/main/notes/cuda.html#tensorfloat-32-tf32-on-ampere-and-later-devices (Triggered internally at /pytorch/aten/src/ATen/Context.cpp:80.)
/home/celikm5/miniforge3/envs/decima2/lib/python3.11/site-packages/lightning_fabric/plugins/environments/slurm.py:204: PossibleUserWarning: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python3.11 /home/celikm5/miniforge3/envs/decima2/bin/decima ...
💡 Tip: For seamless cloud uploads and versioning, try installing [litmodels](https://pypi.org/project/litmodels/) to enable LitModelCheckpoint, which syncs automatically with the Lightning model registry.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
/home/celikm5/miniforge3/envs/decima2/lib/python3.11/site-packages/torch/utils/data/dataloader.py:627: UserWarning: This DataLoader will create 32 worker processes in total. Our suggested max number of worker in current system is 4, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Predicting DataLoader 0: 100%|████████████████| 116/116 [05:30&lt;00:00,  0.35it/s]
/home/celikm5/miniforge3/envs/decima2/lib/python3.11/site-packages/torchmetrics/utilities/prints.py:43: UserWarning: The ``compute`` method of metric WarningCounter was called before the ``update`` method which may lead to errors, as metric states have not yet been updated.
decima - INFO - Creating anndata
decima - INFO - Evaluating performance
Performance on genes in the train dataset.
Mean Pearson Correlation per gene: Mean: 0.01.
Mean Pearson Correlation per gene using size factor (baseline): 0.03.
Mean Pearson Correlation per pseudobulk:  0.00

Performance on genes in the val dataset.
Mean Pearson Correlation per gene: Mean: 0.00.
Mean Pearson Correlation per gene using size factor (baseline): 0.05.
Mean Pearson Correlation per pseudobulk: -0.03

Performance on genes in the test dataset.
Mean Pearson Correlation per gene: Mean: 0.00.
Mean Pearson Correlation per gene using size factor (baseline): 0.00.
Mean Pearson Correlation per pseudobulk:  0.02


</pre></div>
</div>
</div>
</div>
<p>We can open the output h5ad file to see the individual predictions and metrics.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ad_out</span> <span class="o">=</span> <span class="n">anndata</span><span class="o">.</span><span class="n">read_h5ad</span><span class="p">(</span><span class="s2">&quot;example/test_preds.h5ad&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ad_out</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>AnnData object with n_obs × n_vars = 50 × 926
    obs: &#39;cell_type&#39;, &#39;tissue&#39;, &#39;disease&#39;, &#39;study&#39;, &#39;size_factor&#39;, &#39;train_pearson&#39;, &#39;val_pearson&#39;, &#39;test_pearson&#39;
    var: &#39;chrom&#39;, &#39;start&#39;, &#39;end&#39;, &#39;strand&#39;, &#39;gene_start&#39;, &#39;gene_end&#39;, &#39;gene_length&#39;, &#39;gene_mask_start&#39;, &#39;gene_mask_end&#39;, &#39;dataset&#39;, &#39;pearson&#39;, &#39;size_factor_pearson&#39;
    layers: &#39;preds&#39;, &#39;preds_finetune_test_0&#39;
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">.layers['preds_0']</span></code> and <code class="docutils literal notranslate"><span class="pre">.layers['preds_1']</span></code> contain the predictions made by the individual models whereas <code class="docutils literal notranslate"><span class="pre">.layers['preds_0']</span></code> contains the average predictions. You will see that performance metrics have been added to both <code class="docutils literal notranslate"><span class="pre">.obs</span></code> and <code class="docutils literal notranslate"><span class="pre">.var</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ad_out</span><span class="o">.</span><span class="n">obs</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cell_type</th>
      <th>tissue</th>
      <th>disease</th>
      <th>study</th>
      <th>size_factor</th>
      <th>train_pearson</th>
      <th>val_pearson</th>
      <th>test_pearson</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>pseudobulk_0</th>
      <td>ct_0</td>
      <td>t_0</td>
      <td>d_0</td>
      <td>st_0</td>
      <td>4976.871582</td>
      <td>-0.016080</td>
      <td>0.038915</td>
      <td>0.077958</td>
    </tr>
    <tr>
      <th>pseudobulk_1</th>
      <td>ct_0</td>
      <td>t_0</td>
      <td>d_1</td>
      <td>st_0</td>
      <td>4887.680664</td>
      <td>-0.026668</td>
      <td>0.149208</td>
      <td>-0.025352</td>
    </tr>
    <tr>
      <th>pseudobulk_2</th>
      <td>ct_0</td>
      <td>t_0</td>
      <td>d_2</td>
      <td>st_1</td>
      <td>4950.704590</td>
      <td>-0.044364</td>
      <td>0.008472</td>
      <td>0.115734</td>
    </tr>
    <tr>
      <th>pseudobulk_3</th>
      <td>ct_0</td>
      <td>t_0</td>
      <td>d_0</td>
      <td>st_1</td>
      <td>4949.709961</td>
      <td>0.021054</td>
      <td>-0.091807</td>
      <td>0.048898</td>
    </tr>
    <tr>
      <th>pseudobulk_4</th>
      <td>ct_0</td>
      <td>t_0</td>
      <td>d_1</td>
      <td>st_2</td>
      <td>4792.810547</td>
      <td>-0.046708</td>
      <td>-0.071214</td>
      <td>-0.104898</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ad_out</span><span class="o">.</span><span class="n">var</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>chrom</th>
      <th>start</th>
      <th>end</th>
      <th>strand</th>
      <th>gene_start</th>
      <th>gene_end</th>
      <th>gene_length</th>
      <th>gene_mask_start</th>
      <th>gene_mask_end</th>
      <th>dataset</th>
      <th>pearson</th>
      <th>size_factor_pearson</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>gene_0</th>
      <td>chr1</td>
      <td>26682520</td>
      <td>27206808</td>
      <td>+</td>
      <td>26846360</td>
      <td>27370648</td>
      <td>524288</td>
      <td>163840</td>
      <td>524288</td>
      <td>train</td>
      <td>0.306280</td>
      <td>-0.059291</td>
    </tr>
    <tr>
      <th>gene_1</th>
      <td>chr19</td>
      <td>40783737</td>
      <td>41308025</td>
      <td>-</td>
      <td>40619897</td>
      <td>41144185</td>
      <td>524288</td>
      <td>163840</td>
      <td>524288</td>
      <td>train</td>
      <td>0.014492</td>
      <td>-0.035897</td>
    </tr>
    <tr>
      <th>gene_2</th>
      <td>chr1</td>
      <td>79446346</td>
      <td>79970634</td>
      <td>-</td>
      <td>79282506</td>
      <td>79806794</td>
      <td>524288</td>
      <td>163840</td>
      <td>524288</td>
      <td>train</td>
      <td>0.182172</td>
      <td>0.226918</td>
    </tr>
    <tr>
      <th>gene_4</th>
      <td>chr16</td>
      <td>3413688</td>
      <td>3937976</td>
      <td>-</td>
      <td>3249848</td>
      <td>3774136</td>
      <td>524288</td>
      <td>163840</td>
      <td>524288</td>
      <td>train</td>
      <td>0.098095</td>
      <td>-0.032441</td>
    </tr>
    <tr>
      <th>gene_5</th>
      <td>chr10</td>
      <td>22987161</td>
      <td>23511449</td>
      <td>+</td>
      <td>23151001</td>
      <td>23675289</td>
      <td>524288</td>
      <td>163840</td>
      <td>524288</td>
      <td>train</td>
      <td>0.016748</td>
      <td>-0.059998</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="4-modisco.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Detecting and Clustering Seqlets with Modisco</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="2-variant-effect-prediction.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Variant Effect Prediction with Decima</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, Gokcen Eraslan
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Fine-tuning Borzoi to create a Decima model</a><ul>
<li><a class="reference internal" href="#load-input-anndata-file">1. Load input anndata file</a></li>
<li><a class="reference internal" href="#normalize-and-log-transform-data">2. Normalize and log transform data</a></li>
<li><a class="reference internal" href="#create-intervals-surrounding-genes">3. Create intervals surrounding genes</a></li>
<li><a class="reference internal" href="#split-genes-into-training-validation-and-test-sets">3. Split genes into training, validation and test sets</a></li>
<li><a class="reference internal" href="#save-processed-anndata">4. Save processed anndata</a></li>
<li><a class="reference internal" href="#create-an-hdf5-file">5. Create an hdf5 file</a></li>
<li><a class="reference internal" href="#set-training-parameters">6. Set training parameters</a></li>
<li><a class="reference internal" href="#generate-training-commands">7. Generate training commands</a></li>
<li><a class="reference internal" href="#make-and-evaluate-predictions-using-trained-models">8. Make and evaluate predictions using trained models</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=3f1b9271"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=46bd48cc"></script>
    </body>
</html>